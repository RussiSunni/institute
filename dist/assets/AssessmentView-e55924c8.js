import{_ as x,o as n,c as o,b as e,w as p,s as v,y,l as N,E as R,u as E,r as g,h as A,i as I,a as l,C as w,F as k,t as m,x as C,p as F,e as z,f as V,K as U,v as $,d as T}from"./main-eb39a4a7.js";import{u as j}from"./SettingsStore-2d6f2c9d.js";import{u as B}from"./AssessmentsStore-095b7d7c.js";import{F as P}from"./FlagModals-a67459f9.js";const H={data(){return{skillId:this.$route.params.id,essayAnswer:""}},setup(){},methods:{getAnswer(){return this.essayAnswer},clearAnswer(){this.essayAnswer=""},setAnswer(i){this.essayAnswer=i}}},W={class:"container mt-3"},Y={class:"row"},J={class:"mb-3"};function K(i,t,a,r,s,c){return n(),o("div",W,[e("div",Y,[e("div",J,[p(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=d=>s.essayAnswer=d),class:"form-control",id:"exampleFormControlTextarea1",rows:"3"},null,512),[[v,s.essayAnswer]])])])])}const G=x(H,[["render",K]]),Z={data(){return{skillId:this.$route.params.id,imageAnswer:""}},setup(){},mounted(){},methods:{getAnswer(){return this.imageAnswer},clearAnswer(){this.imageAnswer=""},setAnswer(i){this.imageAnswer=i},onFileChange(i){var t=i.target.files||i.dataTransfer.files;if(t[0].size>15728640){alert("image is too big");return}t.length&&this.createImage(t[0])},createImage(i){var t=new Image,a=new FileReader,r=this;a.onload=s=>{r.image=s.target.result,this.imageAnswer=s.target.result,t.src=s.target.result},a.readAsDataURL(i)},removeImage:function(i){this.imageAnswer=""}}},O={class:"mb-3"},X={class:"main-content-container container-fluid"},ss={class:"row"},es={class:"col-lg-4"},ts={class:"mb-3 row"},is={key:0},ns=e("label",{class:"btn green-btn",for:"choose-avatar"},[y("Add   "),e("svg",{width:"14",height:"14",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M6.34811 20.0423L6.34811 13.6494L-0.0358702 13.6583C-0.320945 13.6579 -0.594203 13.5444 -0.795782 13.3428C-0.997361 13.1412 -1.11082 12.868 -1.11132 12.5829L-1.11729 7.41477C-1.1168 7.1297 -1.00334 6.85644 -0.801757 6.65486C-0.600179 6.45328 -0.326921 6.33982 -0.0418461 6.33933L6.3481 6.34231L6.3481 -0.0506238C6.34659 -0.193451 6.3736 -0.335145 6.42756 -0.467396C6.48152 -0.599646 6.56134 -0.719794 6.66234 -0.820794C6.76334 -0.921794 6.88349 -1.00161 7.01574 -1.05557C7.14799 -1.10953 7.28969 -1.13655 7.43251 -1.13503L12.5827 -1.12308C12.8678 -1.12259 13.141 -1.00913 13.3426 -0.807549C13.5442 -0.60597 13.6577 -0.332713 13.6582 -0.047637L13.6552 6.34231L20.0481 6.34231C20.3325 6.34248 20.6052 6.45552 20.8063 6.65661C21.0074 6.8577 21.1204 7.13039 21.1206 7.41477L21.1325 12.565C21.1324 12.8494 21.0193 13.122 20.8182 13.3231C20.6171 13.5242 20.3444 13.6373 20.0601 13.6374L13.6552 13.6494L13.6641 20.0334C13.6636 20.3184 13.5502 20.5917 13.3486 20.7933C13.147 20.9948 12.8738 21.1083 12.5887 21.1088L7.43252 21.1267C7.28969 21.1282 7.148 21.1012 7.01575 21.0473C6.88349 20.9933 6.76335 20.9135 6.66235 20.8125C6.56135 20.7115 6.48153 20.5913 6.42757 20.4591C6.37361 20.3268 6.34659 20.1851 6.34811 20.0423Z",fill:"white"})])],-1),os=e("p",{style:{"font-size":"14px"}},[e("em",null,"Maximum file size 15mb")],-1),rs={key:1},ls=["src"],as={class:"d-flex flex-row gap-2"},us=e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"white",width:"16",height:"16"},[e("path",{d:"M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"})],-1);function cs(i,t,a,r,s,c){return n(),o("div",O,[e("div",X,[e("div",ss,[e("div",es,[e("div",ts,[s.imageAnswer?(n(),o("div",rs,[e("p",null,[e("img",{src:s.imageAnswer,height:"300",width:"300",style:{"background-color":"lightgrey"}},null,8,ls)]),e("div",as,[e("button",{class:"btn red-btn",onClick:t[1]||(t[1]=(...d)=>c.removeImage&&c.removeImage(...d))},[y(" Remove   "),us])])])):(n(),o("div",is,[e("input",{id:"choose-avatar",type:"file",accept:"image/jpeg, image/png, image/jpg, image/webp",onChange:t[0]||(t[0]=(...d)=>c.onFileChange&&c.onFileChange(...d)),hidden:""},null,32),ns,os]))])])])])])}const ds=x(Z,[["render",cs]]);const hs={setup(){const i=N(),t=R(),a=E();return{userDetailsStore:i,userSkillsStore:t,skillTreeStore:a}},data(){return{skillId:this.$route.params.id,question:{question:"",correctAnswer:"",incorrectAnswer1:"",incorrectAnswer2:"",incorrectAnswer3:"",incorrectAnswer4:"",question:"",explanation:""},validate:{validated:!1,question:!1,correctAnswer:!1,incorrectAnswer1:!1,incorrectAnswer2:!1,incorrectAnswer3:!1,incorrectAnswer4:!1,explanation:!1},studentId:null,reshake:!1,questionAddedModal:!1,questionSubmitted:!1,submittedMess:!1}},async mounted(){},methods:{Submit(){if(this.studentId=this.userDetailsStore.userId,this.validate.validated=!1,(this.question.question===""||this.question.question===null)&&(this.validate.question=!0,this.validate.validated=!0),(this.question.correctAnswer===""||this.question.correctAnswer===null)&&(this.validate.correctAnswer=!0,this.validate.validated=!0),(this.question.incorrectAnswer1===""||this.question.incorrectAnswer1===null)&&(this.validate.incorrectAnswer1=!0,this.validate.validated=!0),(this.question.incorrectAnswer2===""||this.question.incorrectAnswer2===null)&&(this.validate.incorrectAnswer2=!0,this.validate.validated=!0),(this.question.incorrectAnswer3===""||this.question.incorrectAnswer3===null)&&(this.validate.incorrectAnswer3=!0,this.validate.validated=!0),(this.question.incorrectAnswer4===""||this.question.incorrectAnswer4===null)&&(this.validate.incorrectAnswer4=!0,this.validate.validated=!0),(this.question.explanation===""||this.question.explanation===null)&&(this.validate.explanation=!0,this.validate.validated=!0),this.validate.validated){this.reshake=!0;return}const i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:this.question.question,correct_answer:this.question.correctAnswer,incorrect_answer_1:this.question.incorrectAnswer1,incorrect_answer_2:this.question.incorrectAnswer2,incorrect_answer_3:this.question.incorrectAnswer3,incorrect_answer_4:this.question.incorrectAnswer4,explanation:this.question.explanation,skill_id:this.skillId,student_id:this.studentId})};var t="/questions/student-mc-questions/add";fetch(t,i).then(()=>{this.questionAddedModal=!0,this.questionSubmitted=!0,window.scrollTo(0,0)})},showSubmittedMess(){this.submittedMess=!0,setTimeout(()=>{this.submittedMess=!1},2e3)},skipAddingQuestion(){this.questionSubmitted=!0,window.scrollTo(0,0)}}},ms={class:"student-add-result pb-3 w-100"},_s={class:"main-content-container container-fluid"},fs={class:"row p-0"},ws={key:1,id:"form-container",class:"col p-4"},ps={key:0,class:"d-flex flex-column"},gs=e("div",{id:"congrats-tile"}," Well done, you have passed! ",-1),vs=e("p",null," Would you like to add your own question on this subject? ",-1),ys=[gs,vs],ks={key:1,class:"d-flex flex-column shake"},qs=e("div",{id:"congrats-tile"}," Thank you for submitting your question. ",-1),bs=[qs],As={class:"mb-3"},xs=e("label",{for:"last_name",class:"form-label"},"Question",-1),Ss={class:"mb-3"},Ms=e("label",{class:"form-label"},"Correct answer",-1),Ts={class:"mb-3"},Is=e("label",{class:"form-label"},"Wrong answer 1",-1),Cs={class:"mb-3"},Qs=e("label",{class:"form-label"},"Wrong answer 2",-1),Ls={class:"mb-3"},Ns=e("label",{class:"form-label"},"Wrong answer 3",-1),Fs={class:"mb-3"},zs=e("label",{class:"form-label"},"Wrong answer 4",-1),$s={class:"mb-3"},Rs=e("label",{class:"form-label"},"Explanation",-1),Es={class:"d-flex justify-content-end gap-4"},Vs={key:2,class:"form-validate shake"},Ps={key:0},Ds={id:"myModal",class:"modal"},Us={class:"modal-content"},js=e("div",{class:"d-flex align-content-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"50",height:"50",fill:"green"},[e("path",{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z"})]),e("div",{class:"my-auto ms-2"}," Your question have been submitted ")],-1),Bs={class:"d-flex flex-row-reverse"};function Hs(i,t,a,r,s,c){const d=g("RouterLink");return n(),o(k,null,[e("div",ms,[e("div",_s,[e("div",fs,[s.questionSubmitted?(n(),A(d,{key:0,class:"btn btn-light purple-btn",style:{width:"136px"},to:"/skills"},{default:I(()=>[y(" Back to skills ")]),_:1})):l("",!0),s.questionSubmitted?l("",!0):(n(),o("div",ws,[s.questionSubmitted?l("",!0):(n(),o("div",ps,ys)),s.questionSubmitted?(n(),o("div",ks,bs)):l("",!0),e("div",As,[xs,p(e("textarea",{"onUpdate:modelValue":t[0]||(t[0]=u=>s.question.question=u),rows:"1",class:"form-control"},`\r
                        `,512),[[v,s.question.question]]),s.validate.question&&(s.question.question===""||s.question.question===null)?(n(),o("div",{key:0,class:w(["form-validate",{shake:s.reshake}]),onAnimationend:t[1]||(t[1]=u=>s.reshake=!1)}," please enter a question content ! ",34)):l("",!0)]),e("div",Ss,[Ms,p(e("input",{"onUpdate:modelValue":t[2]||(t[2]=u=>s.question.correctAnswer=u),type:"text",class:"form-control"},null,512),[[v,s.question.correctAnswer]]),s.validate.correctAnswer&&(s.question.correctAnswer===""||s.question.correctAnswer===null)?(n(),o("div",{key:0,class:w(["form-validate",{shake:s.reshake}]),onAnimationend:t[3]||(t[3]=u=>s.reshake=!1)}," please enter a correct answer ! ",34)):l("",!0)]),e("div",Ts,[Is,p(e("input",{"onUpdate:modelValue":t[4]||(t[4]=u=>s.question.incorrectAnswer1=u),type:"text",class:"form-control"},null,512),[[v,s.question.incorrectAnswer1]]),s.validate.incorrectAnswer1&&(s.question.incorrectAnswer1===""||s.question.incorrectAnswer1===null)?(n(),o("div",{key:0,class:w(["form-validate",{shake:s.reshake}]),onAnimationend:t[5]||(t[5]=u=>s.reshake=!1)}," please enter incorrect answer 1 ! ",34)):l("",!0)]),e("div",Cs,[Qs,p(e("input",{"onUpdate:modelValue":t[6]||(t[6]=u=>s.question.incorrectAnswer2=u),type:"text",class:"form-control"},null,512),[[v,s.question.incorrectAnswer2]]),s.validate.incorrectAnswer2&&(s.question.incorrectAnswer2===""||s.question.incorrectAnswer2===null)?(n(),o("div",{key:0,class:w(["form-validate",{shake:s.reshake}]),onAnimationend:t[7]||(t[7]=u=>s.reshake=!1)}," please enter incorrect answer 2 ! ",34)):l("",!0)]),e("div",Ls,[Ns,p(e("input",{"onUpdate:modelValue":t[8]||(t[8]=u=>s.question.incorrectAnswer3=u),type:"text",class:"form-control"},null,512),[[v,s.question.incorrectAnswer3]]),s.validate.incorrectAnswer3&&(s.question.incorrectAnswer3===""||s.question.incorrectAnswer3===null)?(n(),o("div",{key:0,class:w(["form-validate",{shake:s.reshake}]),onAnimationend:t[9]||(t[9]=u=>s.reshake=!1)}," please enter incorrect answer 3 ! ",34)):l("",!0)]),e("div",Fs,[zs,p(e("input",{"onUpdate:modelValue":t[10]||(t[10]=u=>s.question.incorrectAnswer4=u),type:"text",class:"form-control"},null,512),[[v,s.question.incorrectAnswer4]]),s.validate.incorrectAnswer4&&(s.question.incorrectAnswer4===""||s.question.incorrectAnswer4===null)?(n(),o("div",{key:0,class:w(["form-validate  ",{shake:s.reshake}]),onAnimationend:t[11]||(t[11]=u=>s.reshake=!1)}," please enter incorrect answer 4 ! ",34)):l("",!0)]),e("div",$s,[Rs,p(e("textarea",{"onUpdate:modelValue":t[12]||(t[12]=u=>s.question.explanation=u),class:"form-control",rows:"3"},null,512),[[v,s.question.explanation]]),s.validate.explanation&&(s.question.explanation===""||s.question.explanation===null)?(n(),o("div",{key:0,class:w(["form-validate ",{shake:s.reshake}]),onAnimationend:t[13]||(t[13]=u=>s.reshake=!1)}," please enter a explanation ! ",34)):l("",!0)]),e("div",Es,[e("button",{class:"btn btn-light",onClick:t[14]||(t[14]=(...u)=>c.skipAddingQuestion&&c.skipAddingQuestion(...u))}," Skip "),e("button",{class:"btn purple-btn",onClick:t[15]||(t[15]=u=>s.questionSubmitted?c.showSubmittedMess():c.Submit())}," Submit ")]),s.submittedMess?(n(),o("div",Vs," You already submitted a question !! ")):l("",!0)]))])])]),s.questionAddedModal?(n(),o("div",Ps,[e("div",Ds,[e("div",Us,[js,e("div",Bs,[e("button",{type:"button",class:"btn green-btn",onClick:t[16]||(t[16]=u=>s.questionAddedModal=!1)}," ok "),s.questionSubmitted?(n(),A(d,{key:0,class:"btn btn-light purple-btn mx-2",to:"/skills"},{default:I(()=>[y(" Back to skills ")]),_:1})):l("",!0)])])])])):l("",!0)],64)}const D=x(hs,[["render",Hs]]);const Ws={setup(){return{userDetailsStore:N()}},components:{StudentAddMCQuestion:D,FlagModals:P},data(){return{assessmentResult:"",finishDate:"",finishTime:"",parent:"",score:0,totalScore:1,scorePercent:0,questions:[],essayQuestionsLength:0,correctIndex:[],passModal:!1,failsModal:!1,waitForMarkModal:!1,questionToFlagId:0,questionToFlagType:"",showFlaggingModal:!1}},props:["skill","isManualEssayMarking"],mounted(){switch(this.assessmentResult=this.$parent.assessmentStatus,this.assessmentResult){case"pass":this.passModal=!0;break;case"fails":this.failsModal=!0;break;case"wait for essay answers to be mark":this.waitForMarkModal=!0;break}this.finishDate=this.$parent.finishTime.toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),this.finishTime=this.$parent.finishTime.toLocaleTimeString(),this.score=this.$parent.score,this.isManualEssayMarking==1?this.totalScore=this.$parent.numMCQuestions:this.totalScore=this.$parent.questions.length,this.totalScore!==0&&(this.scorePercent=Math.floor(this.score/this.totalScore*100)),this.isManualEssayMarking==1?(this.questions=this.$parent.questions.filter(i=>i.questionType==="mc"),this.essayQuestionsLength=this.$parent.questions.length-this.questions.length):this.questions=this.$parent.questions,this.correctIndex=[1]},methods:{setQuestionForFlagging(i,t){this.questionToFlagId=i,this.questionToFlagType=t,this.showFlaggingModal=!0}}},f=i=>(F("data-v-b71aeffd"),i=i(),z(),i),Ys={class:"container mt-3 pb-3"},Js=f(()=>e("div",{class:"page-tile"},"Assessment Result",-1)),Ks={class:"d-flex flex-md-row flex-column gap-3"},Gs={class:"assessment-info"},Zs=f(()=>e("span",{class:"info-label"},"Result:",-1)),Os={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 512",fill:"red",height:"14",width:"14",class:"status-icon"},Xs=f(()=>e("path",{d:"M64 64c0-17.7-14.3-32-32-32S0 46.3 0 64V320c0 17.7 14.3 32 32 32s32-14.3 32-32V64zM32 480a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"},null,-1)),se=[Xs],ee={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"green",height:"14",width:"14",class:"mb-1"},te=f(()=>e("path",{d:"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"},null,-1)),ie=[te],ne=f(()=>e("span",{class:"info-label"},"Finish Date: ",-1)),oe={class:"info-value"},re={id:"finish-time"},le={class:"hover-cursor","b-on-hover":"",title:"you need to score above 80% to pass the assessment"},ae=f(()=>e("span",{class:"info-label"},"Score: ",-1)),ue={class:"info-value"},ce=f(()=>e("span",null,"*",-1)),de={key:0,class:"essay-warning"},he={class:"mc-question-result"},me=["onClick"],_e={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",style:{height:"22px",opacity:"0.5"}},fe=f(()=>e("path",{fill:"#8f7bd6",d:"M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"},null,-1)),we=[fe],pe={class:"question"},ge={class:"d-flex flex-column"},ve={class:"form-check my-3"},ye={class:"control control-checkbox"},ke={key:0,class:"correct-indicate"},qe={key:1,class:"user-answer-indicate"},be={key:2,class:"correct-indicate"},Ae=["value","disabled"],xe={class:"control_indicator"},Se={key:0,class:"checked"},Me={key:1},Te=f(()=>e("span",{class:"explain-label"},"Your answer:",-1)),Ie={key:0,class:"explain-text"},Ce={key:1,class:"explain-text"},Qe=["src"],Le={key:2,class:"explain-answer"},Ne=f(()=>e("div",{class:"explain-label"},"Explanation:",-1)),Fe={class:"explain-text"},ze={key:0},$e={id:"myModal",class:"modal"},Re={class:"modal-content"},Ee=f(()=>e("div",{class:"d-flex align-content-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"50",height:"50",fill:"green"},[e("path",{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z"})]),e("div",{class:"my-auto ms-2"}," Well done! You passed and have now mastered the skill! ")],-1)),Ve={class:"d-flex flex-row-reverse"},Pe={key:1},De={id:"myModal",class:"modal"},Ue={class:"modal-content"},je=f(()=>e("div",{class:"d-flex align-content-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"red",width:"50",height:"50"},[e("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24V264c0 13.3-10.7 24-24 24s-24-10.7-24-24V152c0-13.3 10.7-24 24-24zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})]),e("div",{class:"my-auto ms-2"}," You failed this time, try again later! ")],-1)),Be={class:"d-flex flex-row-reverse"},He={key:2},We={id:"myModal",class:"modal"},Ye={class:"modal-content"},Je=f(()=>e("div",null," There is at least one question that needs to be marked by your instructor. Please check whether you passed later. ",-1)),Ke={class:"d-flex flex-row-reverse"};function Ge(i,t,a,r,s,c){const d=g("StudentAddMCQuestion"),u=g("FlagModals");return n(),o(k,null,[e("div",Ys,[Js,e("div",Ks,[e("div",Gs,[e("div",null,[Zs,e("span",{class:w(s.assessmentResult=="pass"?"student-pass":"student-fail")},[y(m(s.assessmentResult)+" ",1),s.assessmentResult==="failed"?(n(),o("svg",Os,se)):l("",!0),s.assessmentResult==="pass"?(n(),o("svg",ee,ie)):l("",!0)],2)]),e("div",null,[ne,e("span",oe,[y(m(s.finishDate)+" ",1),e("span",re," at "+m(s.finishTime),1)])]),e("div",le,[ae,e("span",ue,m(s.score)+" out "+m(s.totalScore),1),y(" ( "+m(s.scorePercent)+"%) ",1),ce]),a.isManualEssayMarking==1&&s.essayQuestionsLength!=0?(n(),o("div",de," There are "+m(s.essayQuestionsLength)+" answers that needed to be mark by your instructor ",1)):l("",!0)]),s.assessmentResult==="pass"?(n(),A(d,{key:0})):l("",!0)]),(n(!0),o(k,null,C(s.questions,h=>(n(),o("div",he,[h.questionType=="mc"?(n(),o("div",{key:0,"b-tooltip.hover":"",title:"flag this question for review",onClick:_=>c.setQuestionForFlagging(h.id,"mc_question"),class:"flagging-icon",style:{height:"50px"}},[(n(),o("svg",_e,we))],8,me)):l("",!0),e("div",{class:w(h.userAnswer===1||h.isCorrect==!0?"correct-label":"wrong-label")},m(h.userAnswer===1||h.isCorrect==!0?"Correct !!":"Incorrect !!"),3),e("div",pe,m(h.question),1),e("div",ge,[h.questionType=="mc"?(n(!0),o(k,{key:0},C(h.answerOptions,(_,Q)=>(n(),o("div",ve,[e("label",ye,[e("div",{class:w(["my-auto mx-2 me-4 answer-option ",_.index==1?" correct-answer":h.userAnswer==_.index?"user-answer":" incorrect-answer"])},[y(m(_.option)+" ",1),_.index==1&&h.userAnswer!==1?(n(),o("span",ke," (correct answer)")):l("",!0),_.index!==1&&h.userAnswer==_.index?(n(),o("span",qe," (your answer)")):l("",!0),_.index==1&&h.userAnswer==1?(n(),o("span",be," (you are correct !)")):l("",!0)],2),e("input",{type:"radio",name:"nodeType",value:_.index,disabled:_.index!=1},null,8,Ae),e("div",xe,[_.index==1?(n(),o("div",Se)):l("",!0)])])]))),256)):(n(),o("div",Me,[Te,h.answer_type=="text"?(n(),o("div",Ie,m(h.userAnswer),1)):(n(),o("div",Ce,[e("img",{width:"100",src:h.userAnswer},null,8,Qe)]))])),h.questionType=="mc"||h.questionType=="essay"&&h.isCorrect==!1?(n(),o("div",Le,[Ne,e("div",Fe,m(h.explanation),1)])):l("",!0)])]))),256))]),s.passModal?(n(),o("div",ze,[e("div",$e,[e("div",Re,[Ee,e("div",Ve,[e("button",{type:"button",class:"btn green-btn",onClick:t[0]||(t[0]=h=>s.passModal=!1)}," Great! ")])])])])):l("",!0),s.failsModal?(n(),o("div",Pe,[e("div",De,[e("div",Ue,[je,e("div",Be,[e("button",{type:"button",class:"btn red-btn",onClick:t[1]||(t[1]=h=>s.failsModal=!1)}," OK ")])])])])):l("",!0),s.waitForMarkModal?(n(),o("div",He,[e("div",We,[e("div",Ye,[Je,e("div",Ke,[e("button",{type:"button",class:"btn green-btn",onClick:t[2]||(t[2]=h=>s.waitForMarkModal=!1)}," OK ")])])])])):l("",!0),s.showFlaggingModal?(n(),A(u,{key:3,userId:r.userDetailsStore.userId,contentType:s.questionToFlagType,contentId:s.questionToFlagId},null,8,["userId","contentType","contentId"])):l("",!0)],64)}const Ze=x(Ws,[["render",Ge],["__scopeId","data-v-b71aeffd"]]);const Oe={setup(){const i=N(),t=j(),a=V(),r=B(),s=R(),c=E();return{userDetailsStore:i,settingsStore:t,skillsStore:a,assessmentsStore:r,userSkillsStore:s,skillTreeStore:c}},data(){return{loading:!0,skillId:this.$route.params.id,skill:{},mcQuestions:[],mcQuestionsAnswer:[],essayQuestions:[],questions:[],question:{},questionNumber:0,score:0,assessmentId:null,numMCQuestions:0,numEssayQuestions:0,totalNumOfQuestions:0,isAllQuestionsAnswered:!1,waitForMarkModal:!1,oldAssessment:void 0,updatedAssessment:!1,showFlaggingModal:!1,flagContentType:"",isQuizPassed:!1,answerHoveredIndex:1/0,showResult:!1,assessmentStatus:"",haveEssayQuestion:!1,finishTime:null,needToSelectInstructor:!1,aiLoading:!1}},async created(){this.settingsStore.quizMaxQuestions==null&&await this.settingsStore.getSettings(),await this.assessmentsStore.getAssessments();const i=this.assessmentsStore.assessments,t=await this.userDetailsStore.getUserDetails();let a;for(let r=0;r<this.skillsStore.skillsList.length;r++)this.skillsStore.skillsList[r].id==this.skillId&&(a=this.skillsStore.skillsList[r].type,this.skill=this.skillsStore.skillsList[r]);if(this.oldAssessment=i.find(r=>r.student_id===t.userId&&r.skill_id===this.skill.id),this.oldAssessment!==void 0&&(this.updatedAssessment=!0),a!="super")await this.fetchMCQuestions(this.skillId);else{let r=[];for(let s=0;s<this.skillsStore.skillsList.length;s++)this.skillsStore.skillsList[s].parent==this.skillId&&this.skillsStore.skillsList[s].type=="sub"&&r.push(this.skillsStore.skillsList[s]);for(let s=0;s<r.length;s++)await this.fetchMCQuestions(r[s].id)}},components:{EssayAnswer:G,ImageAnswer:ds,StudentAddMCQuestion:D,AssessmentResult:Ze,FlagModals:P},methods:{async fetchMCQuestions(i){fetch("/questions/"+i+"/multiple-choice").then(function(t){return t.json()}).then(t=>{this.mcQuestions=this.mcQuestions.concat(t)}).then(()=>{for(let a=0;a<this.mcQuestions.length;a++)this.mcQuestions[a].userAnswer=null,this.mcQuestions[a].questionType="mc";for(let a=0;a<this.mcQuestions.length;a++){var t=[];t.push({option:this.mcQuestions[a].correct_answer,index:1}),t.push({option:this.mcQuestions[a].incorrect_answer_1,index:2}),t.push({option:this.mcQuestions[a].incorrect_answer_2,index:3}),t.push({option:this.mcQuestions[a].incorrect_answer_3,index:4}),t.push({option:this.mcQuestions[a].incorrect_answer_4,index:5}),t=t.sort((r,s)=>.5-Math.random());for(let r=0;r<t.length;r++)t[r].option.toUpperCase()=="all of the above".toUpperCase()&&function(c,d,u){var h=c[d];c.splice(d,1),c.splice(u,0,h)}(t,r,4);this.mcQuestions[a].answerOptions=t}}).then(()=>{this.fetchEssayQuestions(i)})},async fetchEssayQuestions(i){fetch("/questions/"+i+"/essay").then(function(t){return t.json()}).then(t=>{t.length>0&&!this.userDetailsStore.instructor.id&&this.settingsStore.isManualEssayMarking==1&&(this.needToSelectInstructor=!0),this.essayQuestions=this.essayQuestions.concat(t)}).then(()=>{for(let t=0;t<this.essayQuestions.length;t++)this.essayQuestions[t].userAnswer=null,this.essayQuestions[t].questionType="essay"}).then(()=>{this.questions=this.essayQuestions.concat(this.mcQuestions),this.questions=this.questions.sort((t,a)=>.5-Math.random()),this.questions.length>this.settingsStore.quizMaxQuestions&&(this.questions.length=this.settingsStore.quizMaxQuestions),this.question=this.questions[0],this.totalNumOfQuestions=this.questions.length}).then(()=>{this.loading=!1})},Next(){if(this.questions[this.questionNumber].questionType=="essay"){if(this.questions[this.questionNumber].answer_type=="text"){const i=this.$refs.essayTextAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i,this.$refs.essayTextAnswer.clearAnswer()}else if(this.questions[this.questionNumber].answer_type=="image"){const i=this.$refs.essayImageAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i,this.$refs.essayImageAnswer.clearAnswer()}}this.questionNumber++,this.questions[this.questionNumber].questionType=="essay"&&this.questions[this.questionNumber].userAnswer&&(this.questions[this.questionNumber].answer_type=="text"?this.$refs.essayTextAnswer.setAnswer(this.questions[this.questionNumber].userAnswer):this.questions[this.questionNumber].answer_type=="image"&&this.$refs.essayImageAnswer.setAnswer(this.questions[this.questionNumber].userAnswer))},Previous(){if(this.questions[this.questionNumber].questionType=="essay"){if(this.questions[this.questionNumber].answer_type=="text"){const i=this.$refs.essayTextAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i}else if(this.questions[this.questionNumber].answer_type=="image"){const i=this.$refs.essayImageAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i}}this.questionNumber--,this.questions[this.questionNumber].questionType=="essay"&&(this.questions[this.questionNumber].answer_type=="text"&&this.$refs.essayTextAnswer.setAnswer(this.questions[this.questionNumber].userAnswer),this.questions[this.questionNumber].answer_type=="image"&&this.$refs.essayImageAnswer.setAnswer(this.questions[this.questionNumber].userAnswer))},async Submit(){if(this.finishTime=new Date,this.questions[this.questionNumber].questionType=="essay"){let t;this.questions[this.questionNumber].answer_type=="text"?t=this.$refs.essayTextAnswer.getAnswer():this.questions[this.questionNumber].answer_type=="image"&&(t=this.$refs.essayImageAnswer.getAnswer()),this.questions[this.questionNumber].userAnswer=t}for(let t=0;t<this.questions.length;t++)this.questions[t].questionType=="mc"?(this.numMCQuestions++,this.questions[t].userAnswer==1&&this.score++):this.numEssayQuestions++;if(this.numEssayQuestions===0)this.score/this.numMCQuestions*100>=this.settingsStore.passMark?(this.MakeMastered(this.skill),this.isQuizPassed=!0,this.assessmentStatus="pass",this.showResult=!0):(this.isQuizPassed=!0,this.assessmentStatus="fails",this.showResult=!0);else if(this.settingsStore.isManualEssayMarking==1){let t="POST";this.oldAssessment!==void 0&&(t="PUT");const a={method:t,headers:{"Content-Type":"application/json"},body:JSON.stringify({totalScore:this.totalNumOfQuestions,currentScore:this.score,numUnmarkedQuestions:this.numEssayQuestions})};var i="/assessments/"+this.userDetailsStore.userId+"/"+this.skillId;const r=()=>{this.isQuizPassed=!0,this.showResult=!0,this.assessmentStatus="wait for essay answers to be mark"};fetch(i,a).then(function(s){return s.json()}).then(s=>{this.assessmentId=s.id,fetch("/unmarked-answers/delete/"+this.assessmentId,{method:"DELETE"}).then(()=>{for(let d=0;d<this.questions.length;d++)if(this.questions[d].questionType=="essay"){const u={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:this.questions[d].userAnswer,questionId:this.questions[d].id})};var c="/unmarked-answers/add/"+this.assessmentId;fetch(c,u).then(function(h){r()})}})})}else{for(let t=0;t<this.questions.length;t++)if(this.questions[t].questionType=="essay"){let a=this.questions[t].question,r=this.questions[t].userAnswer,s=this.questions[t].answer_type;r==""&&(r="no image"),await this.AIMarkEssayQuestion(a,s,r,t)}this.score/this.questions.length*100>=this.settingsStore.passMark?(this.MakeMastered(this.skill),this.isQuizPassed=!0,this.assessmentStatus="pass",this.showResult=!0):(this.isQuizPassed=!0,this.assessmentStatus="fails",this.showResult=!0)}},async AIMarkEssayQuestion(i,t,a,r){if(this.aiLoading=!0,t=="image"&&a=="no image"){this.questions[r].explanation="This answer is incorrect because no photograph was uploaded.",this.questions[r].isCorrect=!1;return}const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:i,answer:a,answerType:t,level:this.skill.level})};await fetch("/questions/mark-essay-question",s).then(function(d){return d.json()}).then(d=>{d.isCorrect==!0?(this.score++,this.questions[r].isCorrect=!0):(this.questions[r].explanation=d.explanation,this.questions[r].isCorrect=!1)}).finally(()=>{this.aiLoading=!1})},UserAnswer(){for(let i=0;i<this.questions.length;i++)if(this.questions[i].userAnswer==null){this.isAllQuestionsAnswered=!1;return}else this.isAllQuestionsAnswered=!0},TestPass(){this.isQuizPassed=!0},handleClickFlagIcon(){this.questions[this.questionNumber].questionType==="mc"?this.flagContentType="mc_question":this.flagContentType="essay_question",this.showFlaggingModal=!0},async MakeMastered(i){await this.userSkillsStore.MakeMastered(this.userDetailsStore.userId,i),await this.skillTreeStore.getUserSkills()}}},S=i=>(F("data-v-aeb9c026"),i=i(),z(),i),Xe={key:0},st={key:1,class:"loading-animation d-flex justify-content-center align-items-center py-4"},et=S(()=>e("span",{class:"loader"},null,-1)),tt=[et],it={key:2},nt={key:0},ot={id:"myModal",class:"modal"},rt={class:"modal-content"},lt=S(()=>e("div",{class:"mb-2"}," You are taking a new quiz for this skill while your old one is still waiting to be marked. Please note that your old answers will be replaced. ",-1)),at={class:"d-flex flex-row-reverse"},ut={class:"pb-2 pb-md-0"},ct={key:0,class:"container mt-5 mb-3 p-3 pt-2 mb-3",id:"question-container"},dt={class:"row"},ht={key:0},mt={class:"col d-flex my-2 gap-2 justify-content-between flex-column flex-md-row"},_t={class:"d-flex align-items-lg-center"},ft={id:"question-number-div"},wt={id:"question-content"},pt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",style:{height:"22px",opacity:"0.5"}},gt=S(()=>e("path",{fill:"#8f7bd6",d:"M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"},null,-1)),vt=[gt],yt={key:0},kt={class:"form-check my-3"},qt={class:"control control-checkbox"},bt=["name","value","onUpdate:modelValue"],At=["onMouseover"],xt={class:"form-group"},St={class:"mt-3 d-flex justify-content-end"},Mt={key:1,id:"question-content"},Tt={key:5,class:"modal"},It={class:"modal-content"},Ct=S(()=>e("div",{class:""},[e("p",{class:"text-center"}," Please choose an instructor before taking these quizzes. ")],-1)),Qt={class:"d-flex flex-column-reverse flex-md-row justify-content-center gap-2"},Lt=S(()=>e("span",null,"Back",-1)),Nt=S(()=>e("span",null,"Select Instructor",-1));function Ft(i,t,a,r,s,c){const d=g("EssayAnswer"),u=g("ImageAnswer"),h=g("AssessmentResult"),_=g("FlagModals"),Q=g("RouterLink");return n(),o(k,null,[s.loading==!0?(n(),o("div",Xe,"Loading...")):l("",!0),s.aiLoading?(n(),o("div",st,tt)):l("",!0),s.loading==!1&&s.isQuizPassed==!1&&!s.needToSelectInstructor&&!s.aiLoading?(n(),o("div",it,[s.updatedAssessment?(n(),o("div",nt,[e("div",ot,[e("div",rt,[lt,e("div",at,[e("button",{type:"button",class:"btn green-btn",onClick:t[0]||(t[0]=q=>s.updatedAssessment=!1)}," OK ")])])])])):l("",!0),e("div",ut,[s.questions.length>0?(n(),o("div",ct,[(n(!0),o(k,null,C(s.questions,(q,M)=>(n(),o("div",dt,[M==s.questionNumber?(n(),o("div",ht,[e("div",mt,[e("div",_t,[e("div",ft,m(M+1),1),e("div",wt,m(q.question),1)]),e("div",{"b-tooltip.hover":"",title:"flag this question for review",onClick:t[1]||(t[1]=(...b)=>c.handleClickFlagIcon&&c.handleClickFlagIcon(...b)),class:"flagging-icon",style:{height:"50px"}},[(n(),o("svg",pt,vt))])]),q.questionType=="mc"?(n(),o("div",yt,[(n(!0),o(k,null,C(q.answerOptions,(b,Kt)=>(n(),o("div",kt,[e("label",qt,[e("div",{class:w(s.answerHoveredIndex==b.index?"my-auto mx-2 me-4 answer-option checkbox-hovered":"my-auto mx-2 me-4 answer-option")},m(b.option),3),p(e("input",{type:"radio",name:M+"answer",value:b.index,"onUpdate:modelValue":L=>s.questions[M].userAnswer=L},null,8,bt),[[U,s.questions[M].userAnswer]]),e("div",{class:"control_indicator",onMouseover:L=>s.answerHoveredIndex=b.index,onMouseleave:t[2]||(t[2]=L=>s.answerHoveredIndex=1/0)},null,40,At)])]))),256))])):l("",!0)])):l("",!0)]))),256)),e("div",{class:w(`${s.questions[s.questionNumber].questionType=="essay"?"d-block":"d-none"}`)},[e("div",xt,[p(T(d,{ref:"essayTextAnswer"},null,512),[[$,s.questions[s.questionNumber].answer_type=="text"]]),p(T(u,{ref:"essayImageAnswer"},null,512),[[$,s.questions[s.questionNumber].answer_type=="image"]])])],2),e("div",St,[s.questionNumber>0?(n(),o("button",{key:0,onClick:t[3]||(t[3]=q=>c.Previous()),class:"btn red-btn me-2"}," Previous ")):l("",!0),s.questionNumber<s.questions.length-1?(n(),o("button",{key:1,onClick:t[4]||(t[4]=q=>c.Next()),class:"btn green-btn"}," Next ")):l("",!0),s.questionNumber>=s.questions.length-1?(n(),o("button",{key:2,onClick:t[5]||(t[5]=q=>c.Submit()),class:"btn green-btn"}," Submit ")):l("",!0)])])):(n(),o("div",Mt," There is no quiz for this skill yet. Please check again soon. "))])])):l("",!0),s.showResult?(n(),A(h,{key:3,skill:s.skill,isManualEssayMarking:r.settingsStore.isManualEssayMarking},null,8,["skill","isManualEssayMarking"])):l("",!0),s.showFlaggingModal?(n(),A(_,{key:4,userId:r.userDetailsStore.userId,contentId:s.questions[s.questionNumber].id,contentType:s.flagContentType},null,8,["userId","contentId","contentType"])):l("",!0),s.needToSelectInstructor?(n(),o("div",Tt,[e("div",It,[Ct,e("div",Qt,[T(Q,{to:`/skills/${s.skillId}`,type:"button",class:"btn green-btn w-100 w-md-50"},{default:I(()=>[Lt]),_:1},8,["to"]),T(Q,{to:"/profile/edit",type:"button",class:"btn green-btn w-100 w-md-50"},{default:I(()=>[Nt]),_:1})])])])):l("",!0)],64)}const zt=x(Oe,[["render",Ft],["__scopeId","data-v-aeb9c026"]]),$t="/images/skill-avatar/recurso.png";const Rt={setup(){return{skillsStore:V()}},data(){return{skillId:this.$route.params.id,skill:{name:null,image:null,firstAncestorId:null,levelInHierarchy:null}}},async mounted(){this.skillsStore.skillsList.length==0&&await this.skillsStore.getSkillsList();for(let i=0;i<this.skillsStore.skillsList.length;i++)this.skillId==this.skillsStore.skillsList[i].id&&(this.skill.name=this.skillsStore.skillsList[i].name,this.skill.image=this.skillsStore.skillsList[i].image,this.skill.firstAncestorId=this.skillsStore.skillsList[i].first_ancestor,this.skill.levelInHierarchy=this.skillsStore.skillsList[i].hierarchy_level)},components:{Assessment:zt}},Et=i=>(F("data-v-0924da32"),i=i(),z(),i),Vt={id:"banner"},Pt=["src"],Dt={class:"container mt-3"},Ut={class:"d-flex justify-content-md-between justify-content-center"},jt={class:"d-flex flex-column flex-md-row"},Bt=["src"],Ht={key:1,id:"skill-icon",src:$t,alt:"default skill icon"},Wt={id:"assessment-skill-name",class:"ms-3 d-flex justify-content-end"},Yt=Et(()=>e("div",{class:"mt-4 mb-4"},[e("hr",{class:"border border-2 opacity-100 w-md-75 w-100",id:"assessment-horizontal-line"})],-1));function Jt(i,t,a,r,s,c){const d=g("Assessment");return n(),o(k,null,[e("div",Vt,[e("img",{src:"/images/banners/skills-banner.png",class:"img-fluid"},null,8,Pt)]),e("div",Dt,[e("div",Ut,[e("div",jt,[this.skill.image?(n(),o("img",{key:0,src:this.skill.image},null,8,Bt)):(n(),o("img",Ht)),e("div",Wt,m(this.skill.name)+" Quiz ",1)])]),Yt,T(d)])],64)}const si=x(Rt,[["render",Jt],["__scopeId","data-v-0924da32"]]);export{si as default};
