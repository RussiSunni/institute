import{j,_ as B,o as y,c as b,F as E,r as H,a as u,w as z,k as K,t as q,d as J,p as D,b as R,u as O,l as W,S as Q,m as t,n as X,q as Y,G as Z,T as M,e as L,h as T,s as G,C as A,f as ee,g as F,x as le}from"./main-fd74996d.js";import"./fontfaceobserver.standalone-4f666213.js";const se=j("skillTags",{state:()=>({skillTagsList:[]}),actions:{async getSkillTagsList(){const d=await(await fetch("/skill-tags/list")).json();this.skillTagsList=d}}});const ie={setup(){},data(){return{levels:[{id:"grade_school",name:"Grade school"},{id:"middle_school",name:"Middle school"},{id:"high_school",name:"High school"},{id:"college",name:"College"},{id:"phd",name:"PhD"}],checkedFilters:[],isFilterApplied:!1}},async created(){},async mounted(){},methods:{applyFilter:function(s){this.isFilterApplied=!0,this.$parent.filterSkills(s)}}},U=s=>(D("data-v-b4ceaabf"),s=s(),R(),s),te={id:"filters"},ne=U(()=>u("h1",{id:"filterMainHeader",class:"mb-2"},"My Skill Tree",-1)),re={key:0},ae=U(()=>u("p",{class:"mb-2"},"Choose which level to filter out",-1)),oe={class:"form-check"},de=["value","onChange"],ce={class:"form-check-label",for:"flexCheckDefault"};function he(s,d,k,_,h,i){return y(),b("div",te,[ne,h.isFilterApplied==!1?(y(),b("div",re,[ae,(y(!0),b(E,null,H(h.levels,n=>(y(),b("div",null,[u("div",oe,[z(u("input",{class:"form-check-input",type:"radio",value:n.id,id:"flexCheckDefault","onUpdate:modelValue":d[0]||(d[0]=f=>h.checkedFilters=f),onChange:f=>i.applyFilter(n.id)},null,40,de),[[K,h.checkedFilters]]),u("label",ce,q(n.name),1)])]))),256))])):J("",!0)])}const fe=B(ie,[["render",he],["__scopeId","data-v-b4ceaabf"]]);const me={setup(){const s=O(),d=W(),k=se();return{userDetailsStore:s,skillTreeStore:d,skillTagsStore:k}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,regularLockedUnmasteredNodeSprite:null,radius:0,width:null,height:null,radiusMultiplier:256,firstLevelNodeSize:500,secondLevelNodeSize:100,regularNodeSize:50,subSkillRadius:50,skill:{id:null,children:[],isMastered:null,isUnlocked:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:fe,SkillPanel:Q},created(){this.$tidyTreeContainer.visible=!1,this.$radialTreeContainer.visible=!0,this.$pixiApp.renderer.background.color=0},async mounted(){if(document.getElementById("reset-button").addEventListener("click",()=>{this.resetTree()}),this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills(),this.$radialTreeContainer.children.length==0){this.width=window.innerWidth,this.height=window.innerHeight,this.radius=Math.min(this.width,this.height)/2;const s=t.from("center-node.png");this.skill={name:"SKILLS",sprite:s,children:this.skillTreeStore.userSkills},this.getAlgorithm()}document.querySelector("#skilltree").appendChild(this.$pixiApp.view)},methods:{getAlgorithm(){var s=[];s=JSON.parse(JSON.stringify(this.skill.children));function d(e){for(var c=e.length;c--;)e[c].type=="sub"&&e.splice(c,1),typeof e[c]<"u"&&e[c].children&&Array.isArray(e[c].children)&&e[c].children.length>0&&d(e[c].children)}d(s);var k={name:null,children:s};const h=X().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((e,c)=>(e.parent==c.parent,1/e.depth))(Y(k));var i=[];function n(e,c){for(let l=0;l<e.length;l++)e[l].type!="sub"&&i.push(e[l]),n(e[l].children)}n(s);let f=h.descendants().sort((e,c)=>e.data.id-c.data.id);for(let e=0;e<i.length;e++)for(let c=0;c<f.length;c++)i[e].id==f[c].data.id&&(i[e].x=f[c].x,i[e].y=f[c].y);for(var o=0;o<i.length;o++)if(i[o].children=[],i[o].parent!=null&&i[o].parent!=0){var a=i[o].parent;for(let e=0;e<i.length;e++)i[e].id==a&&i[e].children.push(i[o])}let r=[];for(var o=0;o<i.length;o++)(i[o].parent==null||i[o].parent==0)&&r.push(i[o]);this.skill.children=r,this.drawChart(h)},drawChart(s){for(let o=0;o<s.links().length;o++){const a=new Z;s.links()[o].target.data.is_mastered=="1"?a.lineStyle(16,16777215,1):a.lineStyle(2,16777215,1);var d=Math.cos(s.links()[o].source.x)*s.links()[o].source.y,k=Math.sin(s.links()[o].source.x)*s.links()[o].source.y;a.moveTo(d,k);var _=Math.cos(s.links()[o].target.x)*s.links()[o].target.y,h=Math.sin(s.links()[o].target.x)*s.links()[o].target.y;a.lineTo(_,h),this.$radialTreeContainer.addChild(a),this.stageContents.push(a)}const i=this.skill.sprite;i.x=s.x,i.y=s.y,i.anchor.set(.5),this.isRecentered==!1?i.scale.set(.5):i.scale.set(1),this.$radialTreeContainer.addChild(i),this.stageContents.push(i);let n=new M(this.skill.name,{fontFamily:"Poppins900",fontSize:200,fill:0,align:"center"});n.anchor.set(.5),n.x=s.x,n.y=s.y,n.scale.x=.2,n.scale.y=.2,this.$radialTreeContainer.addChild(n),this.stageContents.push(n);function f(o,a,r){a++;for(let[c,l]of o.entries()){let g=new A;g.x=Math.cos(l.x)*l.y,g.y=Math.sin(l.x)*l.y;var e=new t;l.level=="grade_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/grade-school-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/grade-school-unlocked.png"):e=t.from("images/skill-tree-nodes/grade-school-locked.png"):l.level=="middle_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/middle-school-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="high_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/high-school-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="college"?l.is_mastered?e=t.from("images/skill-tree-nodes/college-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="phd"?l.is_mastered?e=t.from("images/skill-tree-nodes/phd-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="domain"&&(e=t.from("images/skill-tree-nodes/domain.png"));let I=0,C=0;for(let m=0;m<l.children.length;m++)l.children[m].type!="sub"?I++:C++;a==1?(e.width=r.firstLevelNodeSize,e.height=r.firstLevelNodeSize):a==2?(e.width=r.secondLevelNodeSize,e.height=r.secondLevelNodeSize):(e.width=r.regularNodeSize,e.height=r.regularNodeSize),e.anchor.set(.5),g.addChild(e);let S;a==1?S=300:a==2?S=100:S=50;const x=l.skill_name.split(" ");for(let m=0;m<x.length;m++)x[m].length>9&&(a==1?S=250:a==2?S=90:S=40);l.skill_name=l.skill_name.replace(/(.*?\s)/g,`$1
`);let v=new M(l.skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:S,fill:16777215,align:"center"});v.anchor.set(.5),v.scale.x=.2,v.scale.y=.2,g.addChild(v),e.eventMode="static",v.eventMode="static",e.cursor="pointer",v.cursor="pointer",v.on("pointerdown",m=>{var p={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:g,name:l.skill_name,description:l.description,tagIDs:[],sprite:e};if(r.skill=p,!r.isSkillInfoPanelShown){let w=function(){r.recenterTree()};r.skill=p,r.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",w)}}),e.on("pointerdown",m=>{var p={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:g,name:l.skill_name,description:l.description,tagIDs:[],sprite:e};if(r.skill=p,!r.isSkillInfoPanelShown){let w=function(){r.recenterTree()};r.skill=p,r.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",w)}}),r.$radialTreeContainer.addChild(g),r.stageContents.push(g);for(let m=0;m<l.children.length;m++)if(l.children[m].type=="sub"){let p=new A,w=360/C,V=m-I,P=w*V*Math.PI/180,$,N;$=r.subSkillRadius*Math.cos(P),N=r.subSkillRadius*Math.sin(P),p.x=$,p.y=N;var e=new t;l.level=="grade_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/grade-school-small-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/grade-school-small-unlocked.png"):e=t.from("images/skill-tree-nodes/grade-school-small-locked.png"):l.level=="middle_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/middle-school-small-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-small-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-small-locked.png"):l.level=="high_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/high-school-small-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/high-school-small-unlocked.png"):e=t.from("images/skill-tree-nodes/high-school-small-locked.png"):l.level=="college"?l.is_mastered?e=t.from("images/skill-tree-nodes/college-smal-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/college-small-unlocked.png"):e=t.from("images/skill-tree-nodes/college-small-locked.png"):l.level=="phd"&&(l.is_mastered?e=t.from("images/skill-tree-nodes/phd-small-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/phd-small-unlocked.png"):e=t.from("images/skill-tree-nodes/phd-small-locked.png")),e.width=15,e.height=15,e.anchor.set(.5),p.addChild(e),g.addChild(p)}l.children&&Array.isArray(l.children)&&l.children.length>0&&f(l.children,a,r)}}f(this.skill.children,0,this)},recenterTree(){this.isRecentered=!0,this.radiusMultiplier=1;for(let s=0;s<this.stageContents.length;s++)this.stageContents[s].destroy();this.hideInfoPanel(),this.getAlgorithm()},resetTree(){this.isRecentered=!1,this.radiusMultiplier=4,this.$radialTreeContainer.removeChildren();const s=t.from("center-node.png");this.skill={name:"SKILLS",sprite:s,children:this.skillTreeStore.userSkills},this.getAlgorithm()},showInfoPanel(){this.isSkillInfoPanelShown||(screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",document.getElementById("sidepanel-backdrop").style.display="block",this.isSkillInfoPanelShown=!0,document.getElementById("skillDescription"),document.getElementById("skillLink"))},hideInfoPanel(){this.isSkillInfoPanelShown&&(screen.width>800?document.getElementById("skillInfoPanel").style.width="0px":document.getElementById("skillInfoPanel").style.height="0px",document.getElementById("sidepanel-backdrop").style.display="none",this.isSkillInfoPanelShown=!1)},async filterSkills(s){var d=[];function k(a,r){for(let e=0;e<a.length;e++)d.push(a[e]),k(a[e].children)}k(this.skill.children);var _=0;for(let a=0;a<d.length;a++){let r=d[a];h(r,r.parent,s),d[a].parent=_}function h(a,r,e,c){for(let l=0;l<d.length;l++)if(d[l].id==r){let g=d[l];g.level==e?(_=g.parent,h(a,_,e)):_=g.id}}let i=[];for(var n=0;n<d.length;n++)d[n].level!=s&&i.push(d[n]);for(var n=0;n<i.length;n++)if(i[n].children=[],i[n].parent!=null&&i[n].parent!=0){var f=i[n].parent;for(let r=0;r<i.length;r++)i[r].id==f&&i[r].children.push(i[n])}let o=[];for(var n=0;n<i.length;n++)(i[n].parent==null||i[n].parent==0)&&o.push(i[n]);this.skill.children=o;for(let a=0;a<this.stageContents.length;a++)this.stageContents[a].destroy();this.applyFilter()},applyFilter(){this.$pixiApp.stage.children[0].removeChildren();const s=t.from("center-node.png");this.skill={name:"SKILLS",sprite:s,children:this.skill.children},this.getAlgorithm()}}},ge=s=>(D("data-v-bcac5338"),s=s(),R(),s),ke={class:"flex-container skill-tree-container"},ue={id:"reset-button",class:"btn btn-info"},pe={id:"wrapper"},_e={id:"skilltree"},Se=ge(()=>u("div",{id:"sidepanel-backdrop"},null,-1));function ve(s,d,k,_,h,i){const n=L("SkillTreeFilter"),f=L("SkillPanel");return y(),b("div",ke,[T(n,{id:"filter"}),z(u("button",ue," Reset ",512),[[G,h.isRecentered]]),u("div",pe,[u("div",_e,[T(f,{skill:h.skill},null,8,["skill"])]),Se])])}const ye=B(me,[["render",ve],["__scopeId","data-v-bcac5338"]]);const be=u("div",{id:"purple-banner"},null,-1),we=u("span",null,"Loading...",-1),xe={__name:"PixiTreeView",setup(s){return(d,k)=>(y(),b(E,null,[be,(y(),ee(le,null,{default:F(()=>[T(ye)]),fallback:F(()=>[we]),_:1}))],64))}};export{xe as default};
