import{_ as k,u as q,k as b,o as r,c as h,a as i,t as a,w as m,C as c,l as p,n as d,e as y,f as w,F as _}from"./main-dae9e940.js";import{u as f}from"./SkillsStore-094a67ce.js";const v={setup(){const o=q(),s=f();return{userDetailsStore:o,skillsStore:s}},data(){return{skillId:this.$route.params.id,mcQuestions:[],essayQuestions:[],questions:[],questionNumber:0,isFetching:!0,score:0,assessmentId:null,numMCQuestions:0,numEssayQuestions:0,totalNumOfQuestions:0,isAllQuestionsAnswered:!1}},async created(){await(async()=>{await fetch("/questions/"+this.skillId+"/multiple-choice").then(function(t){return t.json()}).then(t=>this.mcQuestions=t).then(()=>{for(let t=0;t<this.mcQuestions.length;t++)this.mcQuestions[t].userAnswer=null,this.mcQuestions[t].questionType="mc";this.isFetching=!1})})(),await(async()=>{await fetch("/questions/"+this.skillId+"/essay").then(function(t){return t.json()}).then(t=>this.essayQuestions=t).then(()=>{for(let t=0;t<this.essayQuestions.length;t++)this.essayQuestions[t].userAnswer=null,this.essayQuestions[t].questionType="essay";this.isFetching=!1})})(),this.questions=this.essayQuestions.concat(this.mcQuestions),this.questions=this.questions.sort((t,l)=>.5-Math.random()),this.totalNumOfQuestions=this.questions.length,this.skillsStore.skillsList.length==0&&await this.skillsStore.getSkillsList()},methods:{Next(){this.questionNumber++},Previous(){this.questionNumber--},Submit(){for(let s=0;s<this.questions.length;s++)this.questions[s].questionType=="mc"?(this.numMCQuestions++,this.questions[s].userAnswer==this.questions[s].correct_answer&&this.score++):this.numEssayQuestions++;if(this.essayQuestions.length==0)this.score/this.numMCQuestions.length*100>=90?(this.MakeMastered(this.skillId),alert("Well done! You have now mastered this skill.")):alert("You failed");else{alert("There is at least one question that needs to be marked manually. Please check whether you passed later.");const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({totalScore:this.totalNumOfQuestions,currentScore:this.score,numUnmarkedQuestions:this.numEssayQuestions})};var o="/assessments/"+this.userDetailsStore.userId+"/"+this.skillId;fetch(o,s).then(function(t){return t.json()}).then(t=>{this.assessmentId=t.id,fetch("/unmarked-answers/delete/"+this.assessmentId,{method:"DELETE"}).then(()=>{for(let e=0;e<this.questions.length;e++)if(this.questions[e].questionType=="essay"){const u={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:this.questions[e].userAnswer,questionId:this.questions[e].id})};var l="/unmarked-answers/add/"+this.assessmentId;fetch(l,u).then(function(n){b.push({name:"post-login"})})}})})}this.$router.push("/skill-tree")},MakeMastered(o){var s="/user-skills/mastered/"+this.userDetailsStore.userId+"/"+o;fetch(s).then(()=>{const t=[];for(let l=0;l<this.skillsStore.skillsList.length;l++)this.skillsStore.skillsList[l].parent==o&&t.push(this.skillsStore.skillsList[l].id);for(let l=0;l<t.length;l++)this.MakeAccessible(t[l])})},UserAnswer(){for(let o=0;o<this.questions.length;o++)if(this.questions[o].userAnswer==null){this.isAllQuestionsAnswered=!1;return}else this.isAllQuestionsAnswered=!0}}},A={class:"container mt-3"},g={key:0,class:"row mt-3"},N={class:"mb-3"},S={key:0},Q={class:"form-check"},I={class:"form-check-label"},U={class:"form-check"},C={class:"form-check-label"},L={class:"form-check"},M={class:"form-check-label"},T={class:"form-check"},x={class:"form-check-label"},V={class:"form-check"},E={class:"form-check-label"},O={key:1},D={class:"form-group"},j={class:"mt-3 mb-2 d-flex justify-content-end"};function F(o,s,t,l,e,u){return r(),h("div",A,[e.isFetching?d("",!0):(r(),h("div",g,[i("h2",null,"Question "+a(this.questionNumber+1),1),i("div",N,a(this.questions[this.questionNumber].question),1),this.questions[this.questionNumber].questionType=="mc"?(r(),h("div",S,[i("div",Q,[m(i("input",{onInput:s[0]||(s[0]=n=>u.UserAnswer()),class:"form-check-input",type:"radio",value:"1","onUpdate:modelValue":s[1]||(s[1]=n=>e.questions[this.questionNumber].userAnswer=n)},null,544),[[c,e.questions[this.questionNumber].userAnswer]]),i("label",I,a(e.questions[this.questionNumber].answer_1),1)]),i("div",U,[m(i("input",{onInput:s[2]||(s[2]=n=>u.UserAnswer()),class:"form-check-input",type:"radio",value:"2","onUpdate:modelValue":s[3]||(s[3]=n=>e.questions[this.questionNumber].userAnswer=n)},null,544),[[c,e.questions[this.questionNumber].userAnswer]]),i("label",C,a(e.questions[this.questionNumber].answer_2),1)]),i("div",L,[m(i("input",{onInput:s[4]||(s[4]=n=>u.UserAnswer()),class:"form-check-input",type:"radio",value:"3","onUpdate:modelValue":s[5]||(s[5]=n=>e.questions[this.questionNumber].userAnswer=n)},null,544),[[c,e.questions[this.questionNumber].userAnswer]]),i("label",M,a(e.questions[this.questionNumber].answer_3),1)]),i("div",T,[m(i("input",{onInput:s[6]||(s[6]=n=>u.UserAnswer()),class:"form-check-input",type:"radio",value:"4","onUpdate:modelValue":s[7]||(s[7]=n=>e.questions[this.questionNumber].userAnswer=n)},null,544),[[c,e.questions[this.questionNumber].userAnswer]]),i("label",x,a(e.questions[this.questionNumber].answer_4),1)]),i("div",V,[m(i("input",{onInput:s[8]||(s[8]=n=>u.UserAnswer()),class:"form-check-input",type:"radio",value:"5","onUpdate:modelValue":s[9]||(s[9]=n=>e.questions[this.questionNumber].userAnswer=n)},null,544),[[c,e.questions[this.questionNumber].userAnswer]]),i("label",E,a(e.questions[this.questionNumber].answer_5),1)])])):this.questions[this.questionNumber].questionType=="essay"?(r(),h("div",O,[i("div",D,[m(i("textarea",{onInput:s[10]||(s[10]=n=>u.UserAnswer()),class:"form-control","onUpdate:modelValue":s[11]||(s[11]=n=>e.questions[this.questionNumber].userAnswer=n),rows:"3"},null,544),[[p,e.questions[this.questionNumber].userAnswer]])])])):d("",!0)])),i("div",j,[this.questionNumber>0?(r(),h("button",{key:0,onClick:s[12]||(s[12]=n=>u.Previous()),class:"btn green-btn me-2"},"Previous")):d("",!0),this.questionNumber!=e.questions.length-1?(r(),h("button",{key:1,onClick:s[13]||(s[13]=n=>u.Next()),class:"btn green-btn"},"Next")):d("",!0),this.questionNumber==e.questions.length-1&&!e.isAllQuestionsAnswered?(r(),h("button",{key:2,disabled:"",onClick:s[14]||(s[14]=n=>u.Submit()),class:"btn green-btn"},"Submit")):this.questionNumber==e.questions.length-1&&e.isAllQuestionsAnswered?(r(),h("button",{key:3,onClick:s[15]||(s[15]=n=>u.Submit()),class:"btn green-btn"},"Submit")):d("",!0)])])}const P=k(v,[["render",F],["__scopeId","data-v-2c20f2dc"]]),B={setup(){return{skillsStore:f()}},data(){return{skillId:this.$route.params.id,skill:{name:null,image:null,firstAncestorId:null,levelInHierarchy:null}}},async mounted(){this.skillsStore.skillsList.length==0&&await this.skillsStore.getSkillsList();for(let o=0;o<this.skillsStore.skillsList.length;o++)this.skillId==this.skillsStore.skillsList[o].id&&(this.skill.name=this.skillsStore.skillsList[o].name,this.skill.image=this.skillsStore.skillsList[o].image,this.skill.firstAncestorId=this.skillsStore.skillsList[o].first_ancestor,this.skill.levelInHierarchy=this.skillsStore.skillsList[o].hierarchy_level)},components:{Assessment:P}},H={id:"banner"},J=["src"],Y={class:"container mt-3"},z={class:"d-flex"},R=["src"],W={class:"ms-3"};function G(o,s,t,l,e,u){const n=y("Assessment");return r(),h(_,null,[i("div",H,[i("img",{src:"/images/banners/skills/"+this.skill.firstAncestorId+"/"+this.skill.levelInHierarchy+".png",class:"img-fluid"},null,8,J)]),i("div",Y,[i("div",z,[i("img",{src:this.skill.image},null,8,R),i("h1",W,a(this.skill.name)+" Quiz",1)]),w(n)])],64)}const Z=k(B,[["render",G]]);export{Z as default};
