import{d as Z,_ as V,o as b,c as A,a as _,w as $,v as L,F as W,r as Q,t as G,p as X,b as Y,u as ee,e as E,f as P,g as se,h as U,S as te}from"./main-896cd559.js";import{u as le}from"./SkillTreeStore-cf89e723.js";import{S as ie,A as ne,h as re,P as ae,a as h,G as oe,T as R,C as H}from"./fontfaceobserver.standalone-729eb3b0.js";const ce=Z("skillTags",{state:()=>({skillTagsList:[]}),actions:{async getSkillTagsList(){const s=await(await fetch("/skill-tags/list")).json();this.skillTagsList=s}}});const de={setup(){},data(){return{levels:[{id:"grade_school",name:"Grade school"},{id:"middle_school",name:"Middle school"},{id:"high_school",name:"High school"},{id:"college",name:"College"},{id:"phd",name:"PhD"}],checkedFilters:[]}},async created(){},async mounted(){},methods:{applyFilter:function(){}}},j=e=>(X("data-v-ab8954c3"),e=e(),Y(),e),he={id:"filters"},ue=j(()=>_("h1",{id:"filterMainHeader",class:"mb-2"},"My Skill Tree",-1)),fe={class:"form-check"},me=j(()=>_("label",{class:"form-check-label",for:"flexCheckDefault"}," Mastered and available skills ",-1)),pe={class:"form-check"},ge=["value"],ke={class:"form-check-label",for:"flexCheckDefault"};function _e(e,s,t,n,o,d){return b(),A("div",he,[ue,_("div",fe,[$(_("input",{class:"form-check-input",type:"checkbox",value:0,id:"flexCheckDefault","onUpdate:modelValue":s[0]||(s[0]=a=>o.checkedFilters=a),onChange:s[1]||(s[1]=a=>d.applyFilter())},null,544),[[L,o.checkedFilters]]),me]),(b(!0),A(W,null,Q(o.levels,a=>(b(),A("div",null,[_("div",pe,[$(_("input",{class:"form-check-input",type:"checkbox",value:a.id,id:"flexCheckDefault","onUpdate:modelValue":s[2]||(s[2]=c=>o.checkedFilters=c),onChange:s[3]||(s[3]=c=>d.applyFilter())},null,40,ge),[[L,o.checkedFilters]]),_("label",ke,G(a.name),1)])]))),256))])}const ye=V(de,[["render",_e],["__scopeId","data-v-ab8954c3"]]);function Se(e){var s=0,t=e.children,n=t&&t.length;if(!n)s=1;else for(;--n>=0;)s+=t[n].value;e.value=s}function we(){return this.eachAfter(Se)}function xe(e,s){let t=-1;for(const n of this)e.call(s,n,++t,this);return this}function ve(e,s){for(var t=this,n=[t],o,d,a=-1;t=n.pop();)if(e.call(s,t,++a,this),o=t.children)for(d=o.length-1;d>=0;--d)n.push(o[d]);return this}function be(e,s){for(var t=this,n=[t],o=[],d,a,c,S=-1;t=n.pop();)if(o.push(t),d=t.children)for(a=0,c=d.length;a<c;++a)n.push(d[a]);for(;t=o.pop();)e.call(s,t,++S,this);return this}function Te(e,s){let t=-1;for(const n of this)if(e.call(s,n,++t,this))return n}function Ce(e){return this.eachAfter(function(s){for(var t=+e(s.data)||0,n=s.children,o=n&&n.length;--o>=0;)t+=n[o].value;s.value=t})}function Ie(e){return this.eachBefore(function(s){s.children&&s.children.sort(e)})}function Ae(e){for(var s=this,t=Me(s,e),n=[s];s!==t;)s=s.parent,n.push(s);for(var o=n.length;e!==t;)n.splice(o,0,e),e=e.parent;return n}function Me(e,s){if(e===s)return e;var t=e.ancestors(),n=s.ancestors(),o=null;for(e=t.pop(),s=n.pop();e===s;)o=e,e=t.pop(),s=n.pop();return o}function ze(){for(var e=this,s=[e];e=e.parent;)s.push(e);return s}function Be(){return Array.from(this)}function Fe(){var e=[];return this.eachBefore(function(s){s.children||e.push(s)}),e}function Pe(){var e=this,s=[];return e.each(function(t){t!==e&&s.push({source:t.parent,target:t})}),s}function*Ne(){var e=this,s,t=[e],n,o,d;do for(s=t.reverse(),t=[];e=s.pop();)if(yield e,n=e.children)for(o=0,d=n.length;o<d;++o)t.push(n[o]);while(t.length)}function N(e,s){e instanceof Map?(e=[void 0,e],s===void 0&&(s=Le)):s===void 0&&(s=$e);for(var t=new M(e),n,o=[t],d,a,c,S;n=o.pop();)if((a=s(n.data))&&(S=(a=Array.from(a)).length))for(n.children=a,c=S-1;c>=0;--c)o.push(d=a[c]=new M(a[c])),d.parent=n,d.depth=n.depth+1;return t.eachBefore(Ue)}function De(){return N(this).eachBefore(Ee)}function $e(e){return e.children}function Le(e){return Array.isArray(e)?e[1]:null}function Ee(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Ue(e){var s=0;do e.height=s;while((e=e.parent)&&e.height<++s)}function M(e){this.data=e,this.depth=this.height=0,this.parent=null}M.prototype=N.prototype={constructor:M,count:we,each:xe,eachAfter:be,eachBefore:ve,find:Te,sum:Ce,sort:Ie,path:Ae,ancestors:ze,descendants:Be,leaves:Fe,links:Pe,copy:De,[Symbol.iterator]:Ne};function Re(e,s){return e.parent===s.parent?1:2}function B(e){var s=e.children;return s?s[0]:e.t}function F(e){var s=e.children;return s?s[s.length-1]:e.t}function He(e,s,t){var n=t/(s.i-e.i);s.c-=n,s.s+=t,e.c+=n,s.z+=t,s.m+=t}function Ve(e){for(var s=0,t=0,n=e.children,o=n.length,d;--o>=0;)d=n[o],d.z+=s,d.m+=s,s+=d.s+(t+=d.c)}function We(e,s,t){return e.a.parent===s.parent?e.a:t}function z(e,s){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=s}z.prototype=Object.create(M.prototype);function Xe(e){for(var s=new z(e,0),t,n=[s],o,d,a,c;t=n.pop();)if(d=t._.children)for(t.children=new Array(c=d.length),a=c-1;a>=0;--a)n.push(o=t.children[a]=new z(d[a],a)),o.parent=t;return(s.parent=new z(null,0)).children=[s],s}function Ye(){var e=Re,s=1,t=1,n=null;function o(r){var m=Xe(r);if(m.eachAfter(d),m.parent.m=-m.z,m.eachBefore(a),n)r.eachBefore(S);else{var u=r,i=r,k=r;r.eachBefore(function(f){f.x<u.x&&(u=f),f.x>i.x&&(i=f),f.depth>k.depth&&(k=f)});var l=u===i?1:e(u,i)/2,p=l-u.x,w=s/(i.x+l+p),x=t/(k.depth||1);r.eachBefore(function(f){f.x=(f.x+p)*w,f.y=f.depth*x})}return r}function d(r){var m=r.children,u=r.parent.children,i=r.i?u[r.i-1]:null;if(m){Ve(r);var k=(m[0].z+m[m.length-1].z)/2;i?(r.z=i.z+e(r._,i._),r.m=r.z-k):r.z=k}else i&&(r.z=i.z+e(r._,i._));r.parent.A=c(r,i,r.parent.A||u[0])}function a(r){r._.x=r.z+r.parent.m,r.m+=r.parent.m}function c(r,m,u){if(m){for(var i=r,k=r,l=m,p=i.parent.children[0],w=i.m,x=k.m,f=l.m,T=p.m,v;l=F(l),i=B(i),l&&i;)p=B(p),k=F(k),k.a=r,v=l.z+f-i.z-w+e(l._,i._),v>0&&(He(We(l,r,u),r,v),w+=v,x+=v),f+=l.m,w+=i.m,T+=p.m,x+=k.m;l&&!F(k)&&(k.t=l,k.m+=f-x),i&&!B(p)&&(p.t=i,p.m+=w-T,u=r)}return u}function S(r){r.x*=s,r.y=r.depth*t}return o.separation=function(r){return arguments.length?(e=r,o):e},o.size=function(r){return arguments.length?(n=!1,s=+r[0],t=+r[1],o):n?null:[s,t]},o.nodeSize=function(r){return arguments.length?(n=!0,s=+r[0],t=+r[1],o):n?[s,t]:null},o}function I(e,s,t){this.k=e,this.x=s,this.y=t}I.prototype={constructor:I,scale:function(e){return e===1?this:new I(this.k*e,this.x,this.y)},translate:function(e,s){return e===0&s===0?this:new I(this.k,this.x+this.k*e,this.y+this.k*s)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};I.prototype;const je={setup(){const e=ee(),s=le(),t=ce();return{userDetailsStore:e,skillTreeStore:s,skillTagsStore:t}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,regularLockedUnmasteredNodeSprite:null,radius:0,radiusMultiplier:2,skill:{id:null,children:[],isMastered:null,isUnlocked:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:ye,SkillPanel:ie},async mounted(){this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills();const e=window.innerWidth,s=window.innerHeight;this.radius=Math.min(e,s)/2;var t=new ne({width:e,height:s,resolution:2,transparent:!0,antialias:!0,autoDensity:!0,autoStart:!0});document.querySelector("#skilltree").appendChild(t.view);const n=new re({screenWidth:e,screenHeight:s,worldWidth:e,worldHeight:s,events:t.renderer.events});this.viewport=n,t.stage.addChild(n),n.center=new ae(0,0),n.drag().pinch().wheel().decelerate().clampZoom({minScale:.2,maxScale:5});const o=h.from("center-node.png");this.skill={name:"SKILLS",sprite:o,children:this.skillTreeStore.userSkills},this.getAlgorithm(n),document.getElementById("reset-button").addEventListener("click",()=>{this.resetTree(n)})},methods:{getAlgorithm(e){var s=[];s=JSON.parse(JSON.stringify(this.skill.children));function t(a){for(var c=a.length;c--;)a[c].type=="sub"&&a.splice(c,1),typeof a[c]<"u"&&a[c].children&&Array.isArray(a[c].children)&&a[c].children.length>0&&t(a[c].children)}t(s);var n={name:null,children:s};const d=Ye().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((a,c)=>(a.parent==c.parent?1:2)/a.depth)(N(n));this.drawChart(d,e)},drawChart(e,s){for(let r=0;r<e.links().length;r++){const m=new oe;m.lineStyle(2,16777215,1);var t=Math.cos(e.links()[r].source.x)*e.links()[r].source.y,n=Math.sin(e.links()[r].source.x)*e.links()[r].source.y;m.moveTo(t,n);var o=Math.cos(e.links()[r].target.x)*e.links()[r].target.y,d=Math.sin(e.links()[r].target.x)*e.links()[r].target.y;m.lineTo(o,d),s.addChild(m),this.stageContents.push(m)}const a=this.skill.sprite;a.x=e.x,a.y=e.y,a.anchor.set(.5),this.isRecentered==!1?a.scale.set(.1):a.scale.set(.5),s.addChild(a),this.stageContents.push(a);let c=new R(this.skill.name,{fontFamily:"Poppins900",fontSize:40,fill:0,align:"center"});c.anchor.set(.5),c.x=e.x,c.y=e.y,c.scale.x=.1,c.scale.y=.1,s.addChild(c),this.stageContents.push(c);function S(r,m,u){m++;for(let[k,l]of r.entries()){for(let g=0;g<e.descendants().length;g++)e.descendants()[g].data.id==l.id&&(l.x=e.descendants()[g].x,l.y=e.descendants()[g].y);let p=new H;p.x=Math.cos(l.x)*l.y,p.y=Math.sin(l.x)*l.y;var i=new h;l.level=="grade_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/grade-school-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/grade-school-unlocked.png"):i=h.from("images/skill-tree-nodes/grade-school-locked.png"):l.level=="middle_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/middle-school-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="high_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/high-school-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="college"?l.is_mastered?i=h.from("images/skill-tree-nodes/college-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="phd"?l.is_mastered?i=h.from("images/skill-tree-nodes/phd-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="domain"&&(i=h.from("images/skill-tree-nodes/domain.png")),i.width=30,i.height=30,i.anchor.set(.5),p.addChild(i);let w=40;const x=l.skill_name.split(" ");for(let g=0;g<x.length;g++)x[g].length>9&&(w=37);l.skill_name=l.skill_name.replace(/(.*?\s)/g,`$1
`);let f=new R(l.skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:w,fill:16777215,align:"center"});f.anchor.set(.5),f.scale.x=.1,f.scale.y=.1,p.addChild(f),i.eventMode="static",f.eventMode="static",i.cursor="pointer",f.cursor="pointer",f.on("pointerdown",g=>{var y={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:p,name:l.skill_name,description:l.description,tagIDs:[],sprite:i};if(u.skill=y,!u.isSkillInfoPanelShown){let C=function(){u.recenterTree(s)};u.skill=y,u.showInfoPanel(s),document.getElementById("recenterTree").addEventListener("click",C)}}),i.on("pointerdown",g=>{var y={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:p,name:l.skill_name,description:l.description,tagIDs:[],sprite:i};if(u.skill=y,!u.isSkillInfoPanelShown){let C=function(){u.recenterTree(s)};u.skill=y,u.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",C)}}),s.addChild(p),u.stageContents.push(p);let T=0,v=0;for(let g=0;g<l.children.length;g++)l.children[g].type!="sub"?T++:v++;for(let g=0;g<l.children.length;g++)if(l.children[g].type=="sub"){let y=new H,C=360/v,J=g-T,D=C*J*Math.PI/180,K=25*Math.cos(D),q=25*Math.sin(D);y.x=K,y.y=q;var i=new h;l.level=="grade_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/grade-school-small-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/grade-school-small-unlocked.png"):i=h.from("images/skill-tree-nodes/grade-school-small-locked.png"):l.level=="middle_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/middle-school-small-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-small-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-small-locked.png"):l.level=="high_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/high-school-small-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/high-school-small-unlocked.png"):i=h.from("images/skill-tree-nodes/high-school-small-locked.png"):l.level=="college"?l.is_mastered?i=h.from("images/skill-tree-nodes/college-smal-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/college-small-unlocked.png"):i=h.from("images/skill-tree-nodes/college-small-locked.png"):l.level=="phd"&&(l.is_mastered?i=h.from("images/skill-tree-nodes/phd-small-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/phd-small-unlocked.png"):i=h.from("images/skill-tree-nodes/phd-small-locked.png")),i.width=10,i.height=10,i.anchor.set(.5),y.addChild(i),p.addChild(y)}l.children&&Array.isArray(l.children)&&l.children.length>0&&S(l.children,m,u)}}S(this.skill.children,0,this)},recenterTree(e){this.isRecentered=!0,this.radiusMultiplier=1;for(let s=0;s<this.stageContents.length;s++)this.stageContents[s].destroy();this.getAlgorithm(e)},resetTree(e){this.isRecentered=!1,this.radiusMultiplier=6,console.log(e),e.parent.removeChildren();const s=h.from("center-node.png");this.skill={name:"SKILLS",sprite:s,children:this.skillTreeStore.userSkills},this.getAlgorithm(e)},showInfoPanel(){this.isSkillInfoPanelShown||(screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",document.getElementById("sidepanel-backdrop").style.display="block",this.isSkillInfoPanelShown=!0,document.getElementById("skillDescription"),document.getElementById("skillLink"))}}},O=e=>(X("data-v-50fab722"),e=e(),Y(),e),Oe={class:"flex-container skill-tree-container"},Je=O(()=>_("button",{id:"reset-button",class:"btn btn-info"},"Reset",-1)),Ke={id:"wrapper"},qe={id:"skilltree"},Ze=O(()=>_("div",{id:"sidepanel-backdrop"},null,-1));function Qe(e,s,t,n,o,d){const a=E("SkillTreeFilter"),c=E("SkillPanel");return b(),A("div",Oe,[P(a,{id:"filter"}),Je,_("div",Ke,[_("div",qe,[P(c,{skill:o.skill},null,8,["skill"])]),Ze])])}const Ge=V(je,[["render",Qe],["__scopeId","data-v-50fab722"]]);const es=_("div",{id:"purple-banner"},null,-1),ss=_("span",null,"Loading...",-1),rs={__name:"SkillTreeView",setup(e){return(s,t)=>(b(),A(W,null,[es,(b(),se(te,null,{default:U(()=>[P(Ge)]),fallback:U(()=>[ss]),_:1}))],64))}};export{rs as default};
