import{d as Z,_ as V,o as b,c as A,a as _,w as $,v as L,F as W,r as Q,t as G,p as X,b as Y,u as ee,e as E,f as P,g as te,h as U,S as se}from"./main-6cdcb322.js";import{u as le}from"./SkillTreeStore-77d764ae.js";import{S as ie,A as ne,h as re,P as ae,a as h,G as oe,T as R,C as H}from"./fontfaceobserver.standalone-af50e80b.js";const ce=Z("skillTags",{state:()=>({skillTagsList:[]}),actions:{async getSkillTagsList(){const t=await(await fetch("/skill-tags/list")).json();this.skillTagsList=t}}});const de={setup(){},data(){return{levels:[{id:"grade_school",name:"Grade school"},{id:"middle_school",name:"Middle school"},{id:"high_school",name:"High school"},{id:"college",name:"College"},{id:"phd",name:"PhD"}],checkedFilters:[]}},async created(){},async mounted(){},methods:{applyFilter:function(){}}},j=e=>(X("data-v-ab8954c3"),e=e(),Y(),e),he={id:"filters"},ue=j(()=>_("h1",{id:"filterMainHeader",class:"mb-2"},"My Skill Tree",-1)),fe={class:"form-check"},me=j(()=>_("label",{class:"form-check-label",for:"flexCheckDefault"}," Mastered and available skills ",-1)),pe={class:"form-check"},ge=["value"],ke={class:"form-check-label",for:"flexCheckDefault"};function _e(e,t,s,n,o,d){return b(),A("div",he,[ue,_("div",fe,[$(_("input",{class:"form-check-input",type:"checkbox",value:0,id:"flexCheckDefault","onUpdate:modelValue":t[0]||(t[0]=a=>o.checkedFilters=a),onChange:t[1]||(t[1]=a=>d.applyFilter())},null,544),[[L,o.checkedFilters]]),me]),(b(!0),A(W,null,Q(o.levels,a=>(b(),A("div",null,[_("div",pe,[$(_("input",{class:"form-check-input",type:"checkbox",value:a.id,id:"flexCheckDefault","onUpdate:modelValue":t[2]||(t[2]=c=>o.checkedFilters=c),onChange:t[3]||(t[3]=c=>d.applyFilter())},null,40,ge),[[L,o.checkedFilters]]),_("label",ke,G(a.name),1)])]))),256))])}const ye=V(de,[["render",_e],["__scopeId","data-v-ab8954c3"]]);function Se(e){var t=0,s=e.children,n=s&&s.length;if(!n)t=1;else for(;--n>=0;)t+=s[n].value;e.value=t}function we(){return this.eachAfter(Se)}function xe(e,t){let s=-1;for(const n of this)e.call(t,n,++s,this);return this}function ve(e,t){for(var s=this,n=[s],o,d,a=-1;s=n.pop();)if(e.call(t,s,++a,this),o=s.children)for(d=o.length-1;d>=0;--d)n.push(o[d]);return this}function be(e,t){for(var s=this,n=[s],o=[],d,a,c,S=-1;s=n.pop();)if(o.push(s),d=s.children)for(a=0,c=d.length;a<c;++a)n.push(d[a]);for(;s=o.pop();)e.call(t,s,++S,this);return this}function Te(e,t){let s=-1;for(const n of this)if(e.call(t,n,++s,this))return n}function Ce(e){return this.eachAfter(function(t){for(var s=+e(t.data)||0,n=t.children,o=n&&n.length;--o>=0;)s+=n[o].value;t.value=s})}function Ie(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Ae(e){for(var t=this,s=Me(t,e),n=[t];t!==s;)t=t.parent,n.push(t);for(var o=n.length;e!==s;)n.splice(o,0,e),e=e.parent;return n}function Me(e,t){if(e===t)return e;var s=e.ancestors(),n=t.ancestors(),o=null;for(e=s.pop(),t=n.pop();e===t;)o=e,e=s.pop(),t=n.pop();return o}function ze(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Be(){return Array.from(this)}function Fe(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Pe(){var e=this,t=[];return e.each(function(s){s!==e&&t.push({source:s.parent,target:s})}),t}function*Ne(){var e=this,t,s=[e],n,o,d;do for(t=s.reverse(),s=[];e=t.pop();)if(yield e,n=e.children)for(o=0,d=n.length;o<d;++o)s.push(n[o]);while(s.length)}function N(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Le)):t===void 0&&(t=$e);for(var s=new M(e),n,o=[s],d,a,c,S;n=o.pop();)if((a=t(n.data))&&(S=(a=Array.from(a)).length))for(n.children=a,c=S-1;c>=0;--c)o.push(d=a[c]=new M(a[c])),d.parent=n,d.depth=n.depth+1;return s.eachBefore(Ue)}function De(){return N(this).eachBefore(Ee)}function $e(e){return e.children}function Le(e){return Array.isArray(e)?e[1]:null}function Ee(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Ue(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function M(e){this.data=e,this.depth=this.height=0,this.parent=null}M.prototype=N.prototype={constructor:M,count:we,each:xe,eachAfter:be,eachBefore:ve,find:Te,sum:Ce,sort:Ie,path:Ae,ancestors:ze,descendants:Be,leaves:Fe,links:Pe,copy:De,[Symbol.iterator]:Ne};function Re(e,t){return e.parent===t.parent?1:2}function B(e){var t=e.children;return t?t[0]:e.t}function F(e){var t=e.children;return t?t[t.length-1]:e.t}function He(e,t,s){var n=s/(t.i-e.i);t.c-=n,t.s+=s,e.c+=n,t.z+=s,t.m+=s}function Ve(e){for(var t=0,s=0,n=e.children,o=n.length,d;--o>=0;)d=n[o],d.z+=t,d.m+=t,t+=d.s+(s+=d.c)}function We(e,t,s){return e.a.parent===t.parent?e.a:s}function z(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}z.prototype=Object.create(M.prototype);function Xe(e){for(var t=new z(e,0),s,n=[t],o,d,a,c;s=n.pop();)if(d=s._.children)for(s.children=new Array(c=d.length),a=c-1;a>=0;--a)n.push(o=s.children[a]=new z(d[a],a)),o.parent=s;return(t.parent=new z(null,0)).children=[t],t}function Ye(){var e=Re,t=1,s=1,n=null;function o(r){var m=Xe(r);if(m.eachAfter(d),m.parent.m=-m.z,m.eachBefore(a),n)r.eachBefore(S);else{var u=r,i=r,k=r;r.eachBefore(function(f){f.x<u.x&&(u=f),f.x>i.x&&(i=f),f.depth>k.depth&&(k=f)});var l=u===i?1:e(u,i)/2,p=l-u.x,w=t/(i.x+l+p),x=s/(k.depth||1);r.eachBefore(function(f){f.x=(f.x+p)*w,f.y=f.depth*x})}return r}function d(r){var m=r.children,u=r.parent.children,i=r.i?u[r.i-1]:null;if(m){Ve(r);var k=(m[0].z+m[m.length-1].z)/2;i?(r.z=i.z+e(r._,i._),r.m=r.z-k):r.z=k}else i&&(r.z=i.z+e(r._,i._));r.parent.A=c(r,i,r.parent.A||u[0])}function a(r){r._.x=r.z+r.parent.m,r.m+=r.parent.m}function c(r,m,u){if(m){for(var i=r,k=r,l=m,p=i.parent.children[0],w=i.m,x=k.m,f=l.m,T=p.m,v;l=F(l),i=B(i),l&&i;)p=B(p),k=F(k),k.a=r,v=l.z+f-i.z-w+e(l._,i._),v>0&&(He(We(l,r,u),r,v),w+=v,x+=v),f+=l.m,w+=i.m,T+=p.m,x+=k.m;l&&!F(k)&&(k.t=l,k.m+=f-x),i&&!B(p)&&(p.t=i,p.m+=w-T,u=r)}return u}function S(r){r.x*=t,r.y=r.depth*s}return o.separation=function(r){return arguments.length?(e=r,o):e},o.size=function(r){return arguments.length?(n=!1,t=+r[0],s=+r[1],o):n?null:[t,s]},o.nodeSize=function(r){return arguments.length?(n=!0,t=+r[0],s=+r[1],o):n?[t,s]:null},o}function I(e,t,s){this.k=e,this.x=t,this.y=s}I.prototype={constructor:I,scale:function(e){return e===1?this:new I(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new I(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};I.prototype;const je={setup(){const e=ee(),t=le(),s=ce();return{userDetailsStore:e,skillTreeStore:t,skillTagsStore:s}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,regularLockedUnmasteredNodeSprite:null,radius:0,radiusMultiplier:6,skill:{id:null,children:[],isMastered:null,isUnlocked:null,color:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:ye,SkillPanel:ie},async mounted(){this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills();const e=window.innerWidth,t=window.innerHeight;this.radius=Math.min(e,t)/2;var s=new ne({width:e,height:t,resolution:2,transparent:!0,antialias:!0,autoDensity:!0,autoStart:!0});document.querySelector("#skilltree").appendChild(s.view);const n=new re({screenWidth:e,screenHeight:t,worldWidth:e,worldHeight:t,events:s.renderer.events});this.viewport=n,s.stage.addChild(n),n.center=new ae(0,0),n.drag().pinch().wheel().decelerate().clampZoom({minScale:.2,maxScale:5});const o=h.from("center-node.png");this.skill={name:"SKILLS",sprite:o,children:this.skillTreeStore.userSkills},this.getAlgorithm(n),document.getElementById("reset-button").addEventListener("click",()=>{this.resetTree(n)})},methods:{getAlgorithm(e){var t=[];t=JSON.parse(JSON.stringify(this.skill.children));function s(a){for(var c=a.length;c--;)a[c].type=="sub"&&a.splice(c,1),typeof a[c]<"u"&&a[c].children&&Array.isArray(a[c].children)&&a[c].children.length>0&&s(a[c].children)}s(t);var n={name:null,children:t};const d=Ye().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((a,c)=>(a.parent==c.parent?1:4)/a.depth)(N(n));this.drawChart(d,e)},drawChart(e,t){for(let r=0;r<e.links().length;r++){const m=new oe;m.lineStyle(2,16777215,1);var s=Math.cos(e.links()[r].source.x)*e.links()[r].source.y,n=Math.sin(e.links()[r].source.x)*e.links()[r].source.y;m.moveTo(s,n);var o=Math.cos(e.links()[r].target.x)*e.links()[r].target.y,d=Math.sin(e.links()[r].target.x)*e.links()[r].target.y;m.lineTo(o,d),t.addChild(m),this.stageContents.push(m)}const a=this.skill.sprite;a.x=e.x,a.y=e.y,a.anchor.set(.5),this.isRecentered==!1?a.scale.set(.1):a.scale.set(.5),t.addChild(a),this.stageContents.push(a);let c=new R(this.skill.name,{fontFamily:"Poppins900",fontSize:40,fill:0,align:"center"});c.anchor.set(.5),c.x=e.x,c.y=e.y,c.scale.x=.1,c.scale.y=.1,t.addChild(c),this.stageContents.push(c);function S(r,m,u){m++;for(let[k,l]of r.entries()){for(let g=0;g<e.descendants().length;g++)e.descendants()[g].data.id==l.id&&(l.x=e.descendants()[g].x,l.y=e.descendants()[g].y);let p=new H;p.x=Math.cos(l.x)*l.y,p.y=Math.sin(l.x)*l.y;var i=new h;l.level=="grade_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/grade-school-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/grade-school-unlocked.png"):i=h.from("images/skill-tree-nodes/grade-school-locked.png"):l.level=="middle_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/middle-school-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="high_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/high-school-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="college"?l.is_mastered?i=h.from("images/skill-tree-nodes/college-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="phd"?l.is_mastered?i=h.from("images/skill-tree-nodes/phd-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="domain"&&(i=h.from("images/skill-tree-nodes/domain.png")),i.width=30,i.height=30,i.anchor.set(.5),p.addChild(i);let w=40;const x=l.skill_name.split(" ");for(let g=0;g<x.length;g++)x[g].length>9&&(w=37);l.skill_name=l.skill_name.replace(/(.*?\s)/g,`$1
`);let f=new R(l.skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:w,fill:16777215,align:"center"});f.anchor.set(.5),f.scale.x=.1,f.scale.y=.1,p.addChild(f),i.eventMode="static",f.eventMode="static",i.cursor="pointer",f.cursor="pointer",f.on("pointerdown",g=>{var y={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,color,container:p,name:l.skill_name,description:l.description,tagIDs:[],sprite:i};if(u.skill=y,!u.isSkillInfoPanelShown){let C=function(){u.recenterTree(t)};u.skill=y,u.showInfoPanel(t),document.getElementById("recenterTree").addEventListener("click",C)}}),i.on("pointerdown",g=>{var y={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,color,container:p,name:l.skill_name,description:l.description,tagIDs:[],sprite:i};if(u.skill=y,!u.isSkillInfoPanelShown){let C=function(){u.recenterTree(t)};u.skill=y,u.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",C)}}),t.addChild(p),u.stageContents.push(p);let T=0,v=0;for(let g=0;g<l.children.length;g++)l.children[g].type!="sub"?T++:v++;for(let g=0;g<l.children.length;g++)if(l.children[g].type=="sub"){let y=new H,C=360/v,J=g-T,D=C*J*Math.PI/180,K=25*Math.cos(D),q=25*Math.sin(D);y.x=K,y.y=q;var i=new h;l.level=="grade_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/grade-school-small-mastered.png"):l.is_accessible&&(i=h.from("images/skill-tree-nodes/grade-school-small-unlocked.png")):l.level=="middle_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/middle-school-small-mastered.png"):l.is_accessible&&(i=h.from("images/skill-tree-nodes/middle-school-small-unlocked.png")):l.level=="high_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/high-school-small-mastered.png"):l.is_accessible&&(i=h.from("images/skill-tree-nodes/high-school-small-unlocked.png")):l.level=="college"?l.is_mastered?i=h.from("images/skill-tree-nodes/college-smal-mastered.png"):l.is_accessible&&(i=h.from("images/skill-tree-nodes/college-small-unlocked.png")):l.level=="phd"&&(l.is_mastered?i=h.from("images/skill-tree-nodes/phd-small-mastered.png"):l.is_accessible&&(i=h.from("images/skill-tree-nodes/phd-small-unlocked.png"))),i.width=10,i.height=10,i.anchor.set(.5),y.addChild(i),p.addChild(y)}l.children&&Array.isArray(l.children)&&l.children.length>0&&S(l.children,m,u)}}S(this.skill.children,0,this)},recenterTree(e){this.isRecentered=!0,this.radiusMultiplier=1;for(let t=0;t<this.stageContents.length;t++)this.stageContents[t].destroy();this.getAlgorithm(e)},resetTree(e){this.isRecentered=!1,this.radiusMultiplier=6,console.log(e),e.parent.removeChildren();const t=h.from("center-node.png");this.skill={name:"SKILLS",sprite:t,children:this.skillTreeStore.userSkills},this.getAlgorithm(e)},showInfoPanel(){this.isSkillInfoPanelShown||(screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",document.getElementById("sidepanel-backdrop").style.display="block",this.isSkillInfoPanelShown=!0,document.getElementById("skillDescription"),document.getElementById("skillLink"))}}},O=e=>(X("data-v-b357cca2"),e=e(),Y(),e),Oe={class:"flex-container skill-tree-container"},Je=O(()=>_("button",{id:"reset-button",class:"btn btn-info"},"Reset",-1)),Ke={id:"wrapper"},qe={id:"skilltree"},Ze=O(()=>_("div",{id:"sidepanel-backdrop"},null,-1));function Qe(e,t,s,n,o,d){const a=E("SkillTreeFilter"),c=E("SkillPanel");return b(),A("div",Oe,[P(a,{id:"filter"}),Je,_("div",Ke,[_("div",qe,[P(c,{skill:o.skill},null,8,["skill"])]),Ze])])}const Ge=V(je,[["render",Qe],["__scopeId","data-v-b357cca2"]]);const et=_("div",{id:"purple-banner"},null,-1),tt=_("span",null,"Loading...",-1),rt={__name:"SkillTreeView",setup(e){return(t,s)=>(b(),A(W,null,[et,(b(),te(se,null,{default:U(()=>[P(Ge)]),fallback:U(()=>[tt]),_:1}))],64))}};export{rt as default};
