import{_ as k,u as q,k as f,o as r,c as l,a as t,t as h,w as a,B as m,l as b,n as c,e as p,f as y,F as w}from"./main-abd25214.js";import{u as v}from"./UserSkillsStore-af70878e.js";import{u as _}from"./SkillsStore-08417db0.js";const A={setup(){const o=q(),s=v();return{userDetailsStore:o,userSkillsStore:s}},data(){return{skillId:this.$route.params.id,mcQuestions:[],essayQuestions:[],questions:[],questionNumber:0,isFetching:!0,score:0,assessmentId:null,numMCQuestions:0,numEssayQuestions:0,totalNumOfQuestions:0,isAllQuestionsAnswered:!1}},async created(){await(async()=>{await fetch("/questions/"+this.skillId+"/multiple-choice").then(function(n){return n.json()}).then(n=>this.mcQuestions=n).then(()=>{for(let n=0;n<this.mcQuestions.length;n++)this.mcQuestions[n].userAnswer=null,this.mcQuestions[n].questionType="mc";this.isFetching=!1})})(),await(async()=>{await fetch("/questions/"+this.skillId+"/essay").then(function(n){return n.json()}).then(n=>this.essayQuestions=n).then(()=>{for(let n=0;n<this.essayQuestions.length;n++)this.essayQuestions[n].userAnswer=null,this.essayQuestions[n].questionType="essay";this.isFetching=!1})})(),this.questions=this.essayQuestions.concat(this.mcQuestions),this.questions=this.questions.sort((n,d)=>.5-Math.random()),this.totalNumOfQuestions=this.questions.length},methods:{Next(){this.questionNumber++},Previous(){this.questionNumber--},Submit(){for(let s=0;s<this.questions.length;s++)this.questions[s].questionType=="mc"?(this.numMCQuestions++,this.questions[s].userAnswer==this.questions[s].correct_answer&&this.score++):this.numEssayQuestions++;if(this.essayQuestions.length==0)this.score/this.numMCQuestions.length*100>=90?(this.userSkillsStore.MakeMastered(this.userDetailsStore.userId,skillId),alert("Well done! You have now mastered this skill.")):alert("You failed");else{alert("There is at least one question that needs to be marked manually. Please check whether you passed later.");const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({totalScore:this.totalNumOfQuestions,currentScore:this.score,numUnmarkedQuestions:this.numEssayQuestions})};var o="/assessments/"+this.userDetailsStore.userId+"/"+this.skillId;fetch(o,s).then(function(n){return n.json()}).then(n=>{this.assessmentId=n.id,fetch("/unmarked-answers/delete/"+this.assessmentId,{method:"DELETE"}).then(()=>{for(let e=0;e<this.questions.length;e++)if(this.questions[e].questionType=="essay"){const u={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:this.questions[e].userAnswer,questionId:this.questions[e].id})};var d="/unmarked-answers/add/"+this.assessmentId;fetch(d,u).then(function(i){f.push({name:"post-login"})})}})})}this.$router.push("/skill-tree")},async MakeMastered(o){await this.userSkillsStore.MakeMastered(this.userDetailsStore.userId,o)},UserAnswer(){for(let o=0;o<this.questions.length;o++)if(this.questions[o].userAnswer==null){this.isAllQuestionsAnswered=!1;return}else this.isAllQuestionsAnswered=!0},TestPass(){this.MakeMastered(this.skillId)}}},g={class:"container mt-3"},N={key:0,class:"row mt-3"},S={class:"mb-3"},Q={key:0},I={class:"form-check"},M={class:"form-check-label"},T={class:"form-check"},U={class:"form-check-label"},C={class:"form-check"},x={class:"form-check-label"},V={class:"form-check"},E={class:"form-check-label"},L={class:"form-check"},O={class:"form-check-label"},P={key:1},D={class:"form-group"},j={class:"mt-3 mb-2 d-flex justify-content-end"};function F(o,s,n,d,e,u){return r(),l("div",g,[t("button",{onClick:s[0]||(s[0]=i=>u.TestPass()),class:"btn green-btn me-2"},"Test Pass"),e.isFetching?c("",!0):(r(),l("div",N,[t("h2",null,"Question "+h(this.questionNumber+1),1),t("div",S,h(this.questions[this.questionNumber].question),1),this.questions[this.questionNumber].questionType=="mc"?(r(),l("div",Q,[t("div",I,[a(t("input",{onInput:s[1]||(s[1]=i=>u.UserAnswer()),class:"form-check-input",type:"radio",value:"1","onUpdate:modelValue":s[2]||(s[2]=i=>e.questions[this.questionNumber].userAnswer=i)},null,544),[[m,e.questions[this.questionNumber].userAnswer]]),t("label",M,h(e.questions[this.questionNumber].answer_1),1)]),t("div",T,[a(t("input",{onInput:s[3]||(s[3]=i=>u.UserAnswer()),class:"form-check-input",type:"radio",value:"2","onUpdate:modelValue":s[4]||(s[4]=i=>e.questions[this.questionNumber].userAnswer=i)},null,544),[[m,e.questions[this.questionNumber].userAnswer]]),t("label",U,h(e.questions[this.questionNumber].answer_2),1)]),t("div",C,[a(t("input",{onInput:s[5]||(s[5]=i=>u.UserAnswer()),class:"form-check-input",type:"radio",value:"3","onUpdate:modelValue":s[6]||(s[6]=i=>e.questions[this.questionNumber].userAnswer=i)},null,544),[[m,e.questions[this.questionNumber].userAnswer]]),t("label",x,h(e.questions[this.questionNumber].answer_3),1)]),t("div",V,[a(t("input",{onInput:s[7]||(s[7]=i=>u.UserAnswer()),class:"form-check-input",type:"radio",value:"4","onUpdate:modelValue":s[8]||(s[8]=i=>e.questions[this.questionNumber].userAnswer=i)},null,544),[[m,e.questions[this.questionNumber].userAnswer]]),t("label",E,h(e.questions[this.questionNumber].answer_4),1)]),t("div",L,[a(t("input",{onInput:s[9]||(s[9]=i=>u.UserAnswer()),class:"form-check-input",type:"radio",value:"5","onUpdate:modelValue":s[10]||(s[10]=i=>e.questions[this.questionNumber].userAnswer=i)},null,544),[[m,e.questions[this.questionNumber].userAnswer]]),t("label",O,h(e.questions[this.questionNumber].answer_5),1)])])):this.questions[this.questionNumber].questionType=="essay"?(r(),l("div",P,[t("div",D,[a(t("textarea",{onInput:s[11]||(s[11]=i=>u.UserAnswer()),class:"form-control","onUpdate:modelValue":s[12]||(s[12]=i=>e.questions[this.questionNumber].userAnswer=i),rows:"3"},null,544),[[b,e.questions[this.questionNumber].userAnswer]])])])):c("",!0)])),t("div",j,[this.questionNumber>0?(r(),l("button",{key:0,onClick:s[13]||(s[13]=i=>u.Previous()),class:"btn green-btn me-2"},"Previous")):c("",!0),this.questionNumber!=e.questions.length-1?(r(),l("button",{key:1,onClick:s[14]||(s[14]=i=>u.Next()),class:"btn green-btn"},"Next")):c("",!0),this.questionNumber==e.questions.length-1&&!e.isAllQuestionsAnswered?(r(),l("button",{key:2,disabled:"",onClick:s[15]||(s[15]=i=>u.Submit()),class:"btn green-btn"},"Submit")):this.questionNumber==e.questions.length-1&&e.isAllQuestionsAnswered?(r(),l("button",{key:3,onClick:s[16]||(s[16]=i=>u.Submit()),class:"btn green-btn"},"Submit")):c("",!0)])])}const B=k(A,[["render",F],["__scopeId","data-v-f59ca3e0"]]),H={setup(){return{skillsStore:_()}},data(){return{skillId:this.$route.params.id,skill:{name:null,image:null,firstAncestorId:null,levelInHierarchy:null}}},async mounted(){this.skillsStore.skillsList.length==0&&await this.skillsStore.getSkillsList();for(let o=0;o<this.skillsStore.skillsList.length;o++)this.skillId==this.skillsStore.skillsList[o].id&&(this.skill.name=this.skillsStore.skillsList[o].name,this.skill.image=this.skillsStore.skillsList[o].image,this.skill.firstAncestorId=this.skillsStore.skillsList[o].first_ancestor,this.skill.levelInHierarchy=this.skillsStore.skillsList[o].hierarchy_level)},components:{Assessment:B}},J={id:"banner"},Y=["src"],z={class:"container mt-3"},R={class:"d-flex"},W=["src"],G={class:"ms-3"};function K(o,s,n,d,e,u){const i=p("Assessment");return r(),l(w,null,[t("div",J,[t("img",{src:"/images/banners/skills/"+this.skill.firstAncestorId+"/"+this.skill.levelInHierarchy+".png",class:"img-fluid"},null,8,Y)]),t("div",z,[t("div",R,[t("img",{src:this.skill.image},null,8,W),t("h1",G,h(this.skill.name)+" Quiz",1)]),y(i)])],64)}const ss=k(H,[["render",K]]);export{ss as default};
