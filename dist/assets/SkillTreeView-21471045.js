import{d as O,_ as H,o as b,c as I,F as V,r as J,a as y,w as j,v as q,t as Z,b as Q,p as W,e as X,u as G,P as ee,S as c,G as ie,T as E,f as D,g as $,h as te,C as R,i as se,j as U,k as le}from"./main-1065e85e.js";import{u as ne}from"./SkillTreeStore-3a075d05.js";import{S as re,h as ae}from"./fontfaceobserver.standalone-814df3b5.js";const oe=O("skillTags",{state:()=>({skillTagsList:[]}),actions:{async getSkillTagsList(){const i=await(await fetch("/skill-tags/list")).json();this.skillTagsList=i}}});const de={setup(){},data(){return{levels:[{id:"grade_school",name:"Grade school"},{id:"middle_school",name:"Middle school"},{id:"high_school",name:"High school"},{id:"college",name:"College"},{id:"phd",name:"PhD"}],checkedFilters:[],isFilterApplied:!1}},async created(){},async mounted(){},methods:{applyFilter:function(e){this.isFilterApplied=!0,this.$parent.filterSkills(e)}}},Y=e=>(W("data-v-b4ceaabf"),e=e(),X(),e),he={id:"filters"},ce=Y(()=>y("h1",{id:"filterMainHeader",class:"mb-2"},"My Skill Tree",-1)),fe={key:0},ue=Y(()=>y("p",{class:"mb-2"},"Choose which level to filter out",-1)),pe={class:"form-check"},me=["value","onChange"],ge={class:"form-check-label",for:"flexCheckDefault"};function ke(e,i,s,o,d,a){return b(),I("div",he,[ce,d.isFilterApplied==!1?(b(),I("div",fe,[ue,(b(!0),I(V,null,J(d.levels,r=>(b(),I("div",null,[y("div",pe,[j(y("input",{class:"form-check-input",type:"radio",value:r.id,id:"flexCheckDefault","onUpdate:modelValue":i[0]||(i[0]=m=>d.checkedFilters=m),onChange:m=>a.applyFilter(r.id)},null,40,me),[[q,d.checkedFilters]]),y("label",ge,Z(r.name),1)])]))),256))])):Q("",!0)])}const _e=H(de,[["render",ke],["__scopeId","data-v-b4ceaabf"]]);function ye(e){var i=0,s=e.children,o=s&&s.length;if(!o)i=1;else for(;--o>=0;)i+=s[o].value;e.value=i}function Se(){return this.eachAfter(ye)}function we(e,i){let s=-1;for(const o of this)e.call(i,o,++s,this);return this}function ve(e,i){for(var s=this,o=[s],d,a,r=-1;s=o.pop();)if(e.call(i,s,++r,this),d=s.children)for(a=d.length-1;a>=0;--a)o.push(d[a]);return this}function xe(e,i){for(var s=this,o=[s],d=[],a,r,m,g=-1;s=o.pop();)if(d.push(s),a=s.children)for(r=0,m=a.length;r<m;++r)o.push(a[r]);for(;s=d.pop();)e.call(i,s,++g,this);return this}function be(e,i){let s=-1;for(const o of this)if(e.call(i,o,++s,this))return o}function Ie(e){return this.eachAfter(function(i){for(var s=+e(i.data)||0,o=i.children,d=o&&o.length;--d>=0;)s+=o[d].value;i.value=s})}function Ae(e){return this.eachBefore(function(i){i.children&&i.children.sort(e)})}function Te(e){for(var i=this,s=Ce(i,e),o=[i];i!==s;)i=i.parent,o.push(i);for(var d=o.length;e!==s;)o.splice(d,0,e),e=e.parent;return o}function Ce(e,i){if(e===i)return e;var s=e.ancestors(),o=i.ancestors(),d=null;for(e=s.pop(),i=o.pop();e===i;)d=e,e=s.pop(),i=o.pop();return d}function ze(){for(var e=this,i=[e];e=e.parent;)i.push(e);return i}function Ne(){return Array.from(this)}function Pe(){var e=[];return this.eachBefore(function(i){i.children||e.push(i)}),e}function $e(){var e=this,i=[];return e.each(function(s){s!==e&&i.push({source:s.parent,target:s})}),i}function*Be(){var e=this,i,s=[e],o,d,a;do for(i=s.reverse(),s=[];e=i.pop();)if(yield e,o=e.children)for(d=0,a=o.length;d<a;++d)s.push(o[d]);while(s.length)}function B(e,i){e instanceof Map?(e=[void 0,e],i===void 0&&(i=Le)):i===void 0&&(i=Fe);for(var s=new C(e),o,d=[s],a,r,m,g;o=d.pop();)if((r=i(o.data))&&(g=(r=Array.from(r)).length))for(o.children=r,m=g-1;m>=0;--m)d.push(a=r[m]=new C(r[m])),a.parent=o,a.depth=o.depth+1;return s.eachBefore(De)}function Me(){return B(this).eachBefore(Ee)}function Fe(e){return e.children}function Le(e){return Array.isArray(e)?e[1]:null}function Ee(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function De(e){var i=0;do e.height=i;while((e=e.parent)&&e.height<++i)}function C(e){this.data=e,this.depth=this.height=0,this.parent=null}C.prototype=B.prototype={constructor:C,count:Se,each:we,eachAfter:xe,eachBefore:ve,find:be,sum:Ie,sort:Ae,path:Te,ancestors:ze,descendants:Ne,leaves:Pe,links:$e,copy:Me,[Symbol.iterator]:Be};function Re(e,i){return e.parent===i.parent?1:2}function N(e){var i=e.children;return i?i[0]:e.t}function P(e){var i=e.children;return i?i[i.length-1]:e.t}function Ue(e,i,s){var o=s/(i.i-e.i);i.c-=o,i.s+=s,e.c+=o,i.z+=s,i.m+=s}function He(e){for(var i=0,s=0,o=e.children,d=o.length,a;--d>=0;)a=o[d],a.z+=i,a.m+=i,i+=a.s+(s+=a.c)}function Ve(e,i,s){return e.a.parent===i.parent?e.a:s}function z(e,i){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=i}z.prototype=Object.create(C.prototype);function je(e){for(var i=new z(e,0),s,o=[i],d,a,r,m;s=o.pop();)if(a=s._.children)for(s.children=new Array(m=a.length),r=m-1;r>=0;--r)o.push(d=s.children[r]=new z(a[r],r)),d.parent=s;return(i.parent=new z(null,0)).children=[i],i}function We(){var e=Re,i=1,s=1,o=null;function d(l){var h=je(l);if(h.eachAfter(a),h.parent.m=-h.z,h.eachBefore(r),o)l.eachBefore(g);else{var n=l,u=l,t=l;l.eachBefore(function(k){k.x<n.x&&(n=k),k.x>u.x&&(u=k),k.depth>t.depth&&(t=k)});var f=n===u?1:e(n,u)/2,_=f-n.x,v=i/(u.x+f+_),x=s/(t.depth||1);l.eachBefore(function(k){k.x=(k.x+_)*v,k.y=k.depth*x})}return l}function a(l){var h=l.children,n=l.parent.children,u=l.i?n[l.i-1]:null;if(h){He(l);var t=(h[0].z+h[h.length-1].z)/2;u?(l.z=u.z+e(l._,u._),l.m=l.z-t):l.z=t}else u&&(l.z=u.z+e(l._,u._));l.parent.A=m(l,u,l.parent.A||n[0])}function r(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function m(l,h,n){if(h){for(var u=l,t=l,f=h,_=u.parent.children[0],v=u.m,x=t.m,k=f.m,S=_.m,p;f=P(f),u=N(u),f&&u;)_=N(_),t=P(t),t.a=l,p=f.z+k-u.z-v+e(f._,u._),p>0&&(Ue(Ve(f,l,n),l,p),v+=p,x+=p),k+=f.m,v+=u.m,S+=_.m,x+=t.m;f&&!P(t)&&(t.t=f,t.m+=k-x),u&&!N(_)&&(_.t=u,_.m+=v-S,n=l)}return n}function g(l){l.x*=i,l.y=l.depth*s}return d.separation=function(l){return arguments.length?(e=l,d):e},d.size=function(l){return arguments.length?(o=!1,i=+l[0],s=+l[1],d):o?null:[i,s]},d.nodeSize=function(l){return arguments.length?(o=!0,i=+l[0],s=+l[1],d):o?[i,s]:null},d}function T(e,i,s){this.k=e,this.x=i,this.y=s}T.prototype={constructor:T,scale:function(e){return e===1?this:new T(this.k*e,this.x,this.y)},translate:function(e,i){return e===0&i===0?this:new T(this.k,this.x+this.k*e,this.y+this.k*i)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};T.prototype;const Xe={setup(){const e=G(),i=ne(),s=oe();return{userDetailsStore:e,skillTreeStore:i,skillTagsStore:s}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,regularLockedUnmasteredNodeSprite:null,radius:0,width:null,height:null,radiusMultiplier:16,firstLevelNodeSize:100,regularNodeSize:50,subSkillRadius:50,skill:{id:null,children:[],isMastered:null,isUnlocked:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:_e,SkillPanel:re},async mounted(){document.getElementById("reset-button").addEventListener("click",()=>{this.resetTree()}),this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills(),this.width=window.innerWidth,this.height=window.innerHeight,this.radius=Math.min(this.width,this.height)/2,document.querySelector("#skilltree").appendChild(this.$pixiApp.view);const e=new ae({screenWidth:this.width,screenHeight:this.height,worldWidth:this.width,worldHeight:this.height,events:this.$pixiApp.renderer.events});this.$pixiApp.stage.addChild(e),e.center=new ee(0,0),e.drag().pinch().wheel().decelerate().clampZoom({minScale:.05,maxScale:10});const i=c.from("center-node.png");this.skill={name:"SKILLS",sprite:i,children:this.skillTreeStore.userSkills},this.getAlgorithm()},methods:{getAlgorithm(){var e=[];e=JSON.parse(JSON.stringify(this.skill.children));function i(a){for(var r=a.length;r--;)a[r].type=="sub"&&a.splice(r,1),typeof a[r]<"u"&&a[r].children&&Array.isArray(a[r].children)&&a[r].children.length>0&&i(a[r].children)}i(e);var s={name:null,children:e};const d=We().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((a,r)=>(a.parent==r.parent,1/a.depth))(B(s));this.drawChart(d)},drawChart(e){for(let g=0;g<e.links().length;g++){const l=new ie;l.lineStyle(2,16777215,1);var i=Math.cos(e.links()[g].source.x)*e.links()[g].source.y,s=Math.sin(e.links()[g].source.x)*e.links()[g].source.y;l.moveTo(i,s);var o=Math.cos(e.links()[g].target.x)*e.links()[g].target.y,d=Math.sin(e.links()[g].target.x)*e.links()[g].target.y;l.lineTo(o,d),this.$pixiApp.stage.children[0].addChild(l),this.stageContents.push(l)}const a=this.skill.sprite;a.x=e.x,a.y=e.y,a.anchor.set(.5),this.isRecentered==!1?a.scale.set(.5):a.scale.set(1),this.$pixiApp.stage.children[0].addChild(a),this.stageContents.push(a);let r=new E(this.skill.name,{fontFamily:"Poppins900",fontSize:40,fill:0,align:"center"});r.anchor.set(.5),r.x=e.x,r.y=e.y,r.scale.x=.2,r.scale.y=.2,this.$pixiApp.stage.children[0].addChild(r),this.stageContents.push(r);function m(g,l,h){l++;for(let[u,t]of g.entries()){for(let p=0;p<e.descendants().length;p++)e.descendants()[p].data.id==t.id&&(t.x=e.descendants()[p].x,t.y=e.descendants()[p].y);let f=new R;f.x=Math.cos(t.x)*t.y,f.y=Math.sin(t.x)*t.y;var n=new c;t.level=="grade_school"?t.is_mastered?n=c.from("images/skill-tree-nodes/grade-school-mastered.png"):t.is_accessible?n=c.from("images/skill-tree-nodes/grade-school-unlocked.png"):n=c.from("images/skill-tree-nodes/grade-school-locked.png"):t.level=="middle_school"?t.is_mastered?n=c.from("images/skill-tree-nodes/middle-school-mastered.png"):t.is_accessible?n=c.from("images/skill-tree-nodes/middle-school-unlocked.png"):n=c.from("images/skill-tree-nodes/middle-school-locked.png"):t.level=="high_school"?t.is_mastered?n=c.from("images/skill-tree-nodes/high-school-mastered.png"):t.is_accessible?n=c.from("images/skill-tree-nodes/middle-school-unlocked.png"):n=c.from("images/skill-tree-nodes/middle-school-locked.png"):t.level=="college"?t.is_mastered?n=c.from("images/skill-tree-nodes/college-mastered.png"):t.is_accessible?n=c.from("images/skill-tree-nodes/middle-school-unlocked.png"):n=c.from("images/skill-tree-nodes/middle-school-locked.png"):t.level=="phd"?t.is_mastered?n=c.from("images/skill-tree-nodes/phd-mastered.png"):t.is_accessible?n=c.from("images/skill-tree-nodes/middle-school-unlocked.png"):n=c.from("images/skill-tree-nodes/middle-school-locked.png"):t.level=="domain"&&(n=c.from("images/skill-tree-nodes/domain.png"));let _=0,v=0;for(let p=0;p<t.children.length;p++)t.children[p].type!="sub"?_++:v++;l==1?(n.width=h.firstLevelNodeSize,n.height=h.firstLevelNodeSize):(n.width=h.regularNodeSize,n.height=h.regularNodeSize),n.anchor.set(.5),f.addChild(n);let x=40;const k=t.skill_name.split(" ");for(let p=0;p<k.length;p++)k[p].length>9&&(x=30);t.skill_name=t.skill_name.replace(/(.*?\s)/g,`$1
`);let S=new E(t.skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:x,fill:16777215,align:"center"});S.anchor.set(.5),S.scale.x=.1,S.scale.y=.1,f.addChild(S),n.eventMode="static",S.eventMode="static",n.cursor="pointer",S.cursor="pointer",S.on("pointerdown",p=>{var w={id:t.id,children:t.children,isMastered:t.is_mastered,isUnlocked:t.is_accessible,container:f,name:t.skill_name,description:t.description,tagIDs:[],sprite:n};if(h.skill=w,!h.isSkillInfoPanelShown){let A=function(){h.recenterTree()};h.skill=w,h.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",A)}}),n.on("pointerdown",p=>{var w={id:t.id,children:t.children,isMastered:t.is_mastered,isUnlocked:t.is_accessible,container:f,name:t.skill_name,description:t.description,tagIDs:[],sprite:n};if(h.skill=w,!h.isSkillInfoPanelShown){let A=function(){h.recenterTree()};h.skill=w,h.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",A)}}),h.$pixiApp.stage.children[0].addChild(f),h.stageContents.push(f);for(let p=0;p<t.children.length;p++)if(t.children[p].type=="sub"){let w=new R,A=360/v,K=p-_,M=A*K*Math.PI/180,F,L;F=h.subSkillRadius*Math.cos(M),L=h.subSkillRadius*Math.sin(M),w.x=F,w.y=L;var n=new c;t.level=="grade_school"?t.is_mastered?n=c.from("images/skill-tree-nodes/grade-school-small-mastered.png"):t.is_accessible?n=c.from("images/skill-tree-nodes/grade-school-small-unlocked.png"):n=c.from("images/skill-tree-nodes/grade-school-small-locked.png"):t.level=="middle_school"?t.is_mastered?n=c.from("images/skill-tree-nodes/middle-school-small-mastered.png"):t.is_accessible?n=c.from("images/skill-tree-nodes/middle-school-small-unlocked.png"):n=c.from("images/skill-tree-nodes/middle-school-small-locked.png"):t.level=="high_school"?t.is_mastered?n=c.from("images/skill-tree-nodes/high-school-small-mastered.png"):t.is_accessible?n=c.from("images/skill-tree-nodes/high-school-small-unlocked.png"):n=c.from("images/skill-tree-nodes/high-school-small-locked.png"):t.level=="college"?t.is_mastered?n=c.from("images/skill-tree-nodes/college-smal-mastered.png"):t.is_accessible?n=c.from("images/skill-tree-nodes/college-small-unlocked.png"):n=c.from("images/skill-tree-nodes/college-small-locked.png"):t.level=="phd"&&(t.is_mastered?n=c.from("images/skill-tree-nodes/phd-small-mastered.png"):t.is_accessible?n=c.from("images/skill-tree-nodes/phd-small-unlocked.png"):n=c.from("images/skill-tree-nodes/phd-small-locked.png")),n.width=15,n.height=15,n.anchor.set(.5),w.addChild(n),f.addChild(w)}t.children&&Array.isArray(t.children)&&t.children.length>0&&m(t.children,l,h)}}m(this.skill.children,0,this)},recenterTree(){this.isRecentered=!0,this.radiusMultiplier=1;for(let e=0;e<this.stageContents.length;e++)this.stageContents[e].destroy();this.hideInfoPanel(),this.getAlgorithm()},resetTree(){this.isRecentered=!1,this.radiusMultiplier=4,this.$pixiApp.stage.children[0].removeChildren();const e=c.from("center-node.png");this.skill={name:"SKILLS",sprite:e,children:this.skillTreeStore.userSkills},this.getAlgorithm()},showInfoPanel(){this.isSkillInfoPanelShown||(screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",document.getElementById("sidepanel-backdrop").style.display="block",this.isSkillInfoPanelShown=!0,document.getElementById("skillDescription"),document.getElementById("skillLink"))},hideInfoPanel(){this.isSkillInfoPanelShown&&(screen.width>800?document.getElementById("skillInfoPanel").style.width="0px":document.getElementById("skillInfoPanel").style.height="0px",document.getElementById("sidepanel-backdrop").style.display="none",this.isSkillInfoPanelShown=!1)},async filterSkills(e){var i=[];function s(l,h){for(let n=0;n<l.length;n++)i.push(l[n]),s(l[n].children)}s(this.skill.children);var o=0;for(let l=0;l<i.length;l++){let h=i[l];d(h,h.parent,e),i[l].parent=o}function d(l,h,n,u){for(let t=0;t<i.length;t++)if(i[t].id==h){let f=i[t];f.level==n?(o=f.parent,d(l,o,n)):o=f.id}}let a=[];for(var r=0;r<i.length;r++)i[r].level!=e&&a.push(i[r]);for(var r=0;r<a.length;r++)if(a[r].children=[],a[r].parent!=null&&a[r].parent!=0){var m=a[r].parent;for(let h=0;h<a.length;h++)a[h].id==m&&a[h].children.push(a[r])}let g=[];for(var r=0;r<a.length;r++)(a[r].parent==null||a[r].parent==0)&&g.push(a[r]);this.skill.children=g;for(let l=0;l<this.stageContents.length;l++)this.stageContents[l].destroy();this.applyFilter()},applyFilter(){this.$pixiApp.stage.children[0].removeChildren();const e=c.from("center-node.png");this.skill={name:"SKILLS",sprite:e,children:this.skill.children},this.getAlgorithm()}}},Ye=e=>(W("data-v-0527e34c"),e=e(),X(),e),Ke={class:"flex-container skill-tree-container"},Oe={id:"reset-button",class:"btn btn-info"},Je={id:"wrapper"},qe={id:"skilltree"},Ze=Ye(()=>y("div",{id:"sidepanel-backdrop"},null,-1));function Qe(e,i,s,o,d,a){const r=D("SkillTreeFilter"),m=D("SkillPanel");return b(),I("div",Ke,[$(r,{id:"filter"}),j(y("button",Oe,"Reset",512),[[te,d.isRecentered]]),y("div",Je,[y("div",qe,[$(m,{skill:d.skill},null,8,["skill"])]),Ze])])}const Ge=H(Xe,[["render",Qe],["__scopeId","data-v-0527e34c"]]);const ei=y("div",{id:"purple-banner"},null,-1),ii=y("span",null,"Loading...",-1),ri={__name:"SkillTreeView",setup(e){return(i,s)=>(b(),I(V,null,[ei,(b(),se(le,null,{default:U(()=>[$(Ge)]),fallback:U(()=>[ii]),_:1}))],64))}};export{ri as default};
