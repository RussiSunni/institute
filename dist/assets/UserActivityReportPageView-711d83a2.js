import{_ as g,q as b,i as w,o as i,c as l,d as t,F as y,l as x,t as r,A as p,m as u,a as d,w as m,b as f,n as I,T as v}from"./main-415b9ba1.js";import{u as C,a as Q,b as D}from"./EssayQuestionsStore-f208cb47.js";const N={props:["userId","deleteFlag"],setup(){const e=b(),n=C(),a=Q(),_=D();return{skillsStore:e,resourcesStore:n,mcQuestionsStore:a,essayQuestionsStore:_}},data(){return{contentFlags:[],rows:[]}},components:{},async created(){},async mounted(){await this.getContentFlagLogs(),this.contentFlags.forEach(e=>{const n=JSON.parse(e.content_obj),a=new Date(e.create_date),_=a.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"UTC"}),c={date:a.toLocaleTimeString()+` (${_})`,action:e.action,questionName:n.question,skillName:n.name};switch(e.flag_type){case"mc_question":c.type="mc_question",c.questionId=n.question_id,c.skillId=n.skill_id;break;case"resource":c.type="resource",c.skillId=n.skill_id;break;case"skill":c.type="skill",c.skillId=n.skill_id;break}this.rows.push(c)})},methods:{async getContentFlagLogs(){const e=await fetch(`/user-actions/${this.userId}/flag`);this.contentFlags=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},U={key:0,class:"container-md main-container"},M={class:"d-flex flex-column gap-3"},R={class:"d-flex"},T={class:"d-flex w-fit me-1"},$={key:0,class:"d-flex flex-wrap ml-1"},j={key:1,class:"d-flex flex-wrap ml-1"},A={key:2,class:"d-flex flex-wrap ml-1"},L={key:1,class:"shake"};function q(e,n,a,_,s,c){const h=w("router-link");return s.rows.length?(i(),l("div",U,[t("div",M,[(i(!0),l(y,null,x(s.rows,o=>(i(),l("div",R,[t("div",T,r(o.date)+" -",1),o.type==="skill"?(i(),l("div",$,[t("span",{class:p(c.actionColor(o.action))},r(o.action),3),u("  flag on skill:  "),d(h,{class:"skill-link",target:"_blank",to:`/skills/${o.skillId}`},{default:m(()=>[u(r(o.skillName),1)]),_:2},1032,["to"])])):f("",!0),o.type==="resource"?(i(),l("div",j,[t("span",{class:p(c.actionColor(o.action))},r(o.action),3),u("  flag on resource of skill:  "),d(h,{class:"skill-link",target:"_blank",to:`/skills/${o.skillId}`},{default:m(()=>[u(r(o.skillName),1)]),_:2},1032,["to"])])):f("",!0),o.type==="mc_question"?(i(),l("div",A,[t("span",{class:p(c.actionColor(o.action))},r(o.action),3),u("  flag on mc_question: "),d(h,{class:"question-link",target:"_blank",to:`/skills/${o.skillId}/question-bank`},{default:m(()=>[u(r(o.questionName),1)]),_:2},1032,["to"]),u(" on skill:  "),d(h,{class:"skill-link",target:"_blank",to:`/skills/${o.skillId}`},{default:m(()=>[u(r(o.skillName),1)]),_:2},1032,["to"])])):f("",!0)]))),256))])])):(i(),l("div",L,"The user has no action on flags"))}const O=g(N,[["render",q]]),B={props:["userId","deleteResource"],data(){return{resourcesData:[],rows:[]}},components:{},async created(){await this.getResourceLogs(),this.resourcesData.forEach(e=>{const n=JSON.parse(e.content_obj),a=new Date(e.create_date),_=a.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"UTC"}),s=a.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:_,time:s})})},methods:{async getResourceLogs(){const e=await fetch(`/user-actions/${this.userId}/resource`);this.resourcesData=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},E={key:0,class:"container-md main-container"},V={class:"d-flex flex-column"},F={key:1,class:"shake"};function z(e,n,a,_,s,c){const h=w("router-link");return s.rows.length?(i(),l("div",E,[t("div",V,[(i(!0),l(y,null,x(s.rows,o=>(i(),l("div",null,[u(r(o.time)+" ("+r(o.date)+") - ",1),t("span",{class:p(c.actionColor(o.action))},r(o.action),3),u(" resource for skill: "),d(h,{class:"skill-link",target:"_blank",to:`/skills/${o.skillId}`},{default:m(()=>[u(r(o.skillName),1)]),_:2},1032,["to"])]))),256))])])):(i(),l("div",F,"The user has no action on resource"))}const H=g(B,[["render",z]]),J={props:["userId","deleteMcQuestion"],data(){return{questionsData:[],rows:[]}},components:{},async created(){await this.getMcQuestionsLog(),this.questionsData.forEach(e=>{const n=JSON.parse(e.content_obj),a=new Date(e.create_date),_=a.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric",timeZone:"UTC"}),s=a.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:_,time:s})})},methods:{async getMcQuestionsLog(){const e=await fetch(`/user-actions/${this.userId}/mc_question`);this.questionsData=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},P={key:0,class:"container-md main-container"},Z={class:"d-flex flex-column"},G={key:1,class:"shake"};function K(e,n,a,_,s,c){const h=w("router-link");return s.rows.length>0?(i(),l("div",P,[t("div",Z,[(i(!0),l(y,null,x(s.rows,o=>(i(),l("div",null,[u(r(o.time)+" ("+r(o.date)+") - ",1),t("span",{class:p(c.actionColor(o.action))},r(o.action),3),u(" mc_question for skill: "),d(h,{class:"skill-link",target:"_blank",to:`/skills/${o.skillId}`},{default:m(()=>[u(r(o.skillName),1)]),_:2},1032,["to"])]))),256))])])):(i(),l("div",G," The user has no action on multiple-choice questions "))}const W=g(J,[["render",K]]);const X={setup(){return{usersStore:I()}},data(){return{user:{id:this.$route.params.id,firstName:null,lastName:null,username:null,role:null,avatar:null},showFlags:!1,showSources:!1,showQuestions:!1,showSkills:!1,mcQuestions:[],resources:[],flags:[],skillEdits:[],deleteFlag:!1,deleteResource:!1,deleteMcQuestion:!1}},components:{UserFlagActions:O,UserResourceActions:H,UserMcQuestionActions:W},async created(){await this.getUserDetails()},methods:{async getUserDetails(){this.usersStore.users.length<1&&await this.usersStore.getUsers();for(let e=0;e<this.usersStore.users.length;e++)this.usersStore.users[e].id==this.user.id&&(this.user.firstName=this.usersStore.users[e].first_name,this.user.lastName=this.usersStore.users[e].last_name,this.user.username=this.usersStore.users[e].username,this.user.role=this.usersStore.users[e].role,this.user.avatar=this.usersStore.users[e].avatar)}}},Y={class:"container"},ee=t("div",{class:"mt-4 mb-4"},[t("h1",null,"User Activity Report")],-1),se={class:"row"},te={class:"d-flex flex-column flex-md-row gap-3"},oe=["src"],ne={class:"d-flex flex-column"},ie={id:"user-name"},le={id:"role"},re={class:"d-flex flex-column"},ce={class:"d-flex flex-row justify-content-between"},ae=["title"],ue=t("span",null," Flags ",-1),de=t("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),_e=[de],he={key:0},me=t("hr",{class:"mt-5 mb-3"},null,-1),pe={class:"d-flex flex-column"},we={class:"d-flex flex-row justify-content-between"},fe=["title"],ke=t("span",null," Resources ",-1),ge=t("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),ve=[ge],ye={key:0},xe=t("hr",{class:"mt-5 mb-3"},null,-1),Se={class:"d-flex flex-column"},be={class:"d-flex flex-row justify-content-between"},Ie=["title"],Ce=t("span",null," Student MC Questions (before being accepted by instructors)",-1),Qe=t("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),De=[Qe],Ne={key:0},Ue=t("hr",{class:"mt-5 mb-3"},null,-1);function Me(e,n,a,_,s,c){const h=w("UserFlagActions"),o=w("UserResourceActions"),S=w("UserMcQuestionActions");return i(),l("div",Y,[ee,t("div",se,[t("div",te,[t("img",{id:"activity-report-user-avatar",src:s.user.avatar},null,8,oe),t("div",ne,[t("div",ie,r(s.user.username),1),t("div",le,r(s.user.role),1)])])]),t("div",null,[t("div",re,[t("div",ce,[t("div",{class:"log-type",onClick:n[0]||(n[0]=k=>s.showFlags=!s.showFlags),"b-on-hover":"",title:s.showFlags?"collapse":"expand"},[ue,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([s.showFlags?"arrow-point-down mb-2":"arrow-point-up "])},_e,2))],8,ae)]),d(v,{name:"dropdown"},{default:m(()=>[s.showFlags?(i(),l("div",he,[d(h,{ref:"contentFlagsPerUser",userId:s.user.id,deleteFlag:s.deleteFlag,onCloseFlagDiv:n[1]||(n[1]=k=>s.showFlags=!1)},null,8,["userId","deleteFlag"])])):f("",!0)]),_:1})]),me,t("div",pe,[t("div",we,[t("div",{class:"log-type",onClick:n[2]||(n[2]=k=>s.showSources=!s.showSources),"b-on-hover":"",title:s.showSources?"collapse":"expand"},[ke,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([s.showSources?"arrow-point-down mb-2":"arrow-point-up "])},ve,2))],8,fe)]),d(v,{name:"dropdown"},{default:m(()=>[s.showSources?(i(),l("div",ye,[d(o,{userId:s.user.id,deleteResource:s.deleteResource,onCloseResourceDiv:n[3]||(n[3]=k=>s.showSources=!1)},null,8,["userId","deleteResource"])])):f("",!0)]),_:1})]),xe,t("div",Se,[t("div",be,[t("div",{class:"log-type",onClick:n[4]||(n[4]=k=>s.showQuestions=!s.showQuestions),"b-on-hover":"",title:s.showQuestions?"collapse":"expand"},[Ce,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([s.showQuestions?"arrow-point-down mb-2":"arrow-point-up"])},De,2))],8,Ie)]),d(v,{name:"dropdown"},{default:m(()=>[s.showQuestions?(i(),l("div",Ne,[d(S,{userId:s.user.id,deleteMcQuestion:s.deleteMcQuestion,onCloseMcQuestionDiv:n[5]||(n[5]=k=>s.showQuestions=!1)},null,8,["userId","deleteMcQuestion"])])):f("",!0)]),_:1})]),Ue])])}const $e=g(X,[["render",Me]]);export{$e as default};
