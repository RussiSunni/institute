import{_ as g,q as I,r as w,o as i,c as l,a as o,F as v,m as x,t as c,A as k,n as d,b as m,d as u,g as p,f as Q,h as D,T as y}from"./main-8edcbe3c.js";import{u as $,a as C,b as N}from"./EssayQuestionsStore-98767f6a.js";const U={props:["userId","deleteFlag"],setup(){const e=I(),n=$(),a=C(),_=N();return{skillsStore:e,resourcesStore:n,mcQuestionsStore:a,essayQuestionsStore:_}},data(){return{contentFlags:[],rows:[]}},components:{},async created(){},async mounted(){await this.getContentFlagLogs(),this.contentFlags.forEach(e=>{const n=JSON.parse(e.content_obj),a=new Date(e.create_date),_=a.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),r={date:a.toLocaleTimeString()+` (${_})`,action:e.action,questionName:n.question,skillName:n.name,id:e.id};switch(e.flag_type){case"mc_question":r.type="mc_question",r.questionId=n.question_id,r.skillId=n.skill_id;break;case"resource":r.type="resource",r.skillId=n.skill_id;break;case"skill":r.type="skill",r.skillId=n.skill_id;break;default:r.type="delete";break}this.rows.push(r)})},methods:{async getContentFlagLogs(){const e=await fetch(`/user-actions/${this.userId}/flag`);this.contentFlags=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},j={key:0,class:"container-md main-container"},L={class:"d-flex flex-column gap-3"},A={class:"d-flex"},T={class:"d-flex w-fit me-1"},R={key:0,class:"d-flex flex-wrap ml-1"},O={key:0},B={key:1,class:"d-flex flex-wrap ml-1"},E={key:2,class:"d-flex flex-wrap ml-1"},z={key:3,class:"d-flex flex-wrap ml-1"},V={key:1,class:"shake"};function H(e,n,a,_,s,r){const h=w("router-link");return s.rows.length?(i(),l("div",j,[o("div",L,[(i(!0),l(v,null,x(s.rows,t=>(i(),l("div",A,[o("div",T,c(t.date),1),t.type==="skill"?(i(),l("div",R,[o("span",{class:k(r.actionColor(t.action))}," - "+c(t.action),3),d("   "),t.action=="delete"?(i(),l("span",O," flag with id: "+c(t.id),1)):m("",!0),d("flag on skill:  "),u(h,{class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"])])):m("",!0),t.type==="resource"?(i(),l("div",B,[o("span",{class:k(r.actionColor(t.action))}," - "+c(t.action),3),d("  flag on resource of skill:  "),u(h,{class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"])])):m("",!0),t.type==="mc_question"?(i(),l("div",E,[o("span",{class:k(r.actionColor(t.action))}," - "+c(t.action),3),d("  flag on mc_question: "),u(h,{class:"question-link",target:"_blank",to:`/skills/${t.skillId}/question-bank`},{default:p(()=>[d(c(t.questionName),1)]),_:2},1032,["to"]),d(" on skill:  "),u(h,{class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"])])):m("",!0),t.type==="delete"?(i(),l("div",z,[o("span",{class:k(r.actionColor(t.action)+" me-1")}," - "+c(t.action),3),d(" flag with id "+c(t.id),1)])):m("",!0)]))),256))])])):(i(),l("div",V,"The user has no action on flags"))}const J=g(U,[["render",H]]),q={props:["userId","deleteResource"],data(){return{resourcesData:[],rows:[]}},components:{},async created(){await this.getResourceLogs(),this.resourcesData.forEach(e=>{const n=JSON.parse(e.content_obj),a=new Date(e.create_date),_=a.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),s=a.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:_,time:s,id:e.id})})},methods:{async getResourceLogs(){const e=await fetch(`/user-actions/${this.userId}/resource`);this.resourcesData=await e.json(),console.log(this.resourcesData)},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},W={key:0,class:"container-md main-container"},P={class:"d-flex flex-column"},K=o("span",null," resource in forum of skill: ",-1),G={key:1,class:"shake"};function X(e,n,a,_,s,r){const h=w("router-link");return s.rows.length?(i(),l("div",W,[o("div",P,[(i(!0),l(v,null,x(s.rows,t=>(i(),l("div",null,[d(c(t.time)+" ("+c(t.date)+") - ",1),o("span",{class:k(r.actionColor(t.action))},c(t.action),3),K,u(h,{class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"])]))),256))])])):(i(),l("div",G,"The user has no action on resource"))}const Y=g(q,[["render",X]]),Z={props:["userId","deleteMcQuestion"],data(){return{questionsData:[],rows:[]}},components:{},async created(){await this.getMcQuestionsLog(),this.questionsData.forEach(e=>{const n=JSON.parse(e.content_obj),a=new Date(e.create_date),_=a.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),s=a.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:_,time:s,id:e.id,studentName:n.student_name,studentId:n.student_id,type:e.content_type})})},methods:{async getMcQuestionsLog(){const e=await fetch(`/user-actions/${this.userId}/question`);this.questionsData=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";case"bulk-create":return"bulk-create-action";default:return"delete-action"}}}},F={key:0,class:"container-md main-container"},ee={class:"d-flex flex-column"},se={key:0},te={key:1},oe={key:1,class:"shake"};function ne(e,n,a,_,s,r){const h=w("router-link");return s.rows.length>0?(i(),l("div",F,[o("div",ee,[(i(!0),l(v,null,x(s.rows,t=>(i(),l("div",null,[d(c(t.time)+" ("+c(t.date)+") ",1),o("span",{class:k(r.actionColor(t.action))}," - "+c(t.action),3),t.type==="mc_question"?(i(),l("span",se," mc_question in question bank of skill: ")):m("",!0),t.type==="essay_question"?(i(),l("span",te," essay question in question bank of skill: ")):m("",!0),u(h,{class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"])]))),256))])])):(i(),l("div",oe," The user has no action on multiple-choice questions "))}const ie=g(Z,[["render",ne]]);const le={props:["userId","deleteResource"],data(){return{skillsData:[],rows:[],showWarnModal:!1}},components:{},async created(){await this.getSkillLogs(),this.skillsData.forEach(e=>{const n=JSON.parse(e.content_obj),a=new Date(e.create_date),_=a.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),s=a.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:_,time:s,id:e.id})})},methods:{async getSkillLogs(){const e=await fetch(`/user-actions/${this.userId}/skill`);this.skillsData=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},ce={key:0,class:"container-md main-container"},re={class:"d-flex flex-column"},ae=o("span",null," skill: ",-1),de={key:1,class:"shake"},ue={key:2},_e={id:"myModal",class:"modal"},he={class:"modal-content"},me=o("div",{class:"d-flex gap-4 justify-content-center mb-4"},[o("div",{class:"modal-label"},"This skill is deleted !!")],-1),pe={class:"d-flex justify-content-center"},ke=o("div",null,"OK",-1),we=[ke];function fe(e,n,a,_,s,r){const h=w("router-link");return i(),l(v,null,[s.rows.length?(i(),l("div",ce,[o("div",re,[(i(!0),l(v,null,x(s.rows,t=>(i(),l("div",null,[d(c(t.time)+" ("+c(t.date)+") - ",1),o("span",{class:k(r.actionColor(t.action))},c(t.action),3),ae,t.action==="delete"?(i(),l("span",{key:0,class:"skill-link",onClick:n[0]||(n[0]=S=>s.showWarnModal=!0)},c(t.skillName),1)):(i(),Q(h,{key:1,class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"]))]))),256))])])):(i(),l("div",de,"The user has no action on skill")),s.showWarnModal?(i(),l("div",ue,[o("div",_e,[o("div",he,[me,o("div",pe,[o("button",{type:"button",class:"btn green-btn w-25",onClick:n[1]||(n[1]=t=>s.showWarnModal=!1)},we)])])])])):m("",!0)],64)}const ve=g(le,[["render",fe]]),ge={props:["userId","deleteMcQuestion"],data(){return{questionsData:[],rows:[]}},components:{},async created(){await this.getMcQuestionsLog(),this.questionsData.forEach(e=>{e.action==="update"&&console.log(e);const n=JSON.parse(e.content_obj),a=new Date(e.create_date),_=a.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),s=a.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:_,time:s,id:e.id,studentName:n.student_name,studentId:n.student_id})})},methods:{async getMcQuestionsLog(){const e=await fetch(`/user-actions/${this.userId}/student_mc_question`);this.questionsData=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},ye={key:0,class:"container-md main-container"},xe={class:"d-flex flex-column"},Se={key:0},be={key:1},Me={key:2},Ie={key:1,class:"shake"};function Qe(e,n,a,_,s,r){const h=w("router-link");return s.rows.length>0?(i(),l("div",ye,[o("div",xe,[(i(!0),l(v,null,x(s.rows,t=>(i(),l("div",null,[d(c(t.time)+" ("+c(t.date)+") ",1),o("span",{class:k(r.actionColor(t.action))}," - "+c(t.action),3),t.action==="delete"?(i(),l("span",Se," student mc_question with id "+c(t.id),1)):t.action==="create"?(i(),l("span",be," student mc_question for skill: ")):(i(),l("span",Me,[d(" mc question of student "),u(h,{class:"user-link",target:"_blank",to:"/users"},{default:p(()=>[d(c(t.studentName),1)]),_:2},1024),d(" on skill: ")])),u(h,{class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"])]))),256))])])):(i(),l("div",Ie," The user has no action on multiple-choice questions "))}const De=g(ge,[["render",Qe]]);const $e={setup(){return{usersStore:D()}},data(){return{user:{id:this.$route.params.id,firstName:null,lastName:null,username:null,role:null,avatar:null},showFlags:!1,showSources:!1,showMcQuestions:!1,showStudentMcQuestions:!1,showSkills:!1,mcQuestions:[],resources:[],flags:[],skillEdits:[]}},components:{UserFlagActions:J,UserResourceActions:Y,UserQuestionActions:ie,UserStudentMcQuestionActions:De,UserSkillActions:ve},async created(){await this.getUserDetails()},methods:{async getUserDetails(){this.usersStore.users.length<1&&await this.usersStore.getUsers();for(let e=0;e<this.usersStore.users.length;e++)this.usersStore.users[e].id==this.user.id&&(this.user.firstName=this.usersStore.users[e].first_name,this.user.lastName=this.usersStore.users[e].last_name,this.user.username=this.usersStore.users[e].username,this.user.role=this.usersStore.users[e].role,this.user.avatar=this.usersStore.users[e].avatar)}}},Ce={class:"container"},Ne=o("div",{class:"mt-4 mb-4"},[o("h1",null,"User Activity Report")],-1),Ue={class:"row"},je={class:"d-flex flex-column flex-md-row gap-3"},Le=["src"],Ae={class:"d-flex flex-column"},Te={id:"user-name"},Re={id:"role"},Oe={class:"d-flex flex-column"},Be={class:"d-flex flex-row justify-content-between"},Ee=["title"],ze=o("span",null," Flags ",-1),Ve=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),He=[Ve],Je={key:0},qe=o("hr",{class:"mt-5 mb-3"},null,-1),We={key:0,class:"d-flex flex-column"},Pe={class:"d-flex flex-row justify-content-between"},Ke=["title"],Ge=o("span",null,"Questions ",-1),Xe=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),Ye=[Xe],Ze={key:0},Fe={key:1,class:"mt-5 mb-3"},es={class:"d-flex flex-column"},ss={class:"d-flex flex-row justify-content-between"},ts=["title"],os=o("span",null,"Student MC Questions ",-1),ns=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),is=[ns],ls={key:0},cs=o("hr",{class:"mt-5 mb-3"},null,-1),rs={class:"d-flex flex-column"},as={class:"d-flex flex-row justify-content-between"},ds=["title"],us=o("span",null," Resources ",-1),_s=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),hs=[_s],ms={key:0},ps=o("hr",{class:"mt-5 mb-3"},null,-1),ks={class:"d-flex flex-column"},ws={class:"d-flex flex-row justify-content-between"},fs=["title"],vs=o("span",null," Skills ",-1),gs=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),ys=[gs],xs={key:0},Ss=o("hr",{class:"mt-5 mb-3"},null,-1);function bs(e,n,a,_,s,r){const h=w("UserFlagActions"),t=w("UserQuestionActions"),S=w("UserStudentMcQuestionActions"),b=w("UserResourceActions"),M=w("UserSkillActions");return i(),l("div",Ce,[Ne,o("div",Ue,[o("div",je,[o("img",{id:"activity-report-user-avatar",src:s.user.avatar},null,8,Le),o("div",Ae,[o("div",Te,c(s.user.username),1),o("div",Re,c(s.user.role),1)])])]),o("div",null,[o("div",Oe,[o("div",Be,[o("div",{class:"log-type",onClick:n[0]||(n[0]=f=>s.showFlags=!s.showFlags),"b-on-hover":"",title:s.showFlags?"collapse":"expand"},[ze,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:k([s.showFlags?"arrow-point-down mb-2":"arrow-point-up "])},He,2))],8,Ee)]),u(y,{name:"dropdown"},{default:p(()=>[s.showFlags?(i(),l("div",Je,[u(h,{ref:"contentFlagsPerUser",userId:s.user.id,deleteFlag:e.deleteFlag,onCloseFlagDiv:n[1]||(n[1]=f=>s.showFlags=!1)},null,8,["userId","deleteFlag"])])):m("",!0)]),_:1})]),qe,s.user.role==="admin"?(i(),l("div",We,[o("div",Pe,[o("div",{class:"log-type",onClick:n[2]||(n[2]=f=>s.showMcQuestions=!s.showMcQuestions),"b-on-hover":"",title:s.showMcQuestions?"collapse":"expand"},[Ge,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:k([s.showMcQuestions?"arrow-point-down mb-2":"arrow-point-up"])},Ye,2))],8,Ke)]),u(y,{name:"dropdown"},{default:p(()=>[s.showMcQuestions?(i(),l("div",Ze,[u(t,{userId:s.user.id,deleteMcQuestion:e.deleteMcQuestion,onCloseMcQuestionDiv:n[3]||(n[3]=f=>s.showMcQuestions=!1)},null,8,["userId","deleteMcQuestion"])])):m("",!0)]),_:1})])):m("",!0),s.user.role==="admin"?(i(),l("hr",Fe)):m("",!0),o("div",es,[o("div",ss,[o("div",{class:"log-type",onClick:n[4]||(n[4]=f=>s.showStudentMcQuestions=!s.showStudentMcQuestions),"b-on-hover":"",title:s.showStudentMcQuestions?"collapse":"expand"},[os,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:k([s.showStudentMcQuestions?"arrow-point-down mb-2":"arrow-point-up"])},is,2))],8,ts)]),u(y,{name:"dropdown"},{default:p(()=>[s.showStudentMcQuestions?(i(),l("div",ls,[u(S,{userId:s.user.id,deleteMcQuestion:e.deleteMcQuestion,onCloseMcQuestionDiv:n[5]||(n[5]=f=>s.showStudentMcQuestions=!1)},null,8,["userId","deleteMcQuestion"])])):m("",!0)]),_:1})]),cs,o("div",rs,[o("div",as,[o("div",{class:"log-type",onClick:n[6]||(n[6]=f=>s.showSources=!s.showSources),"b-on-hover":"",title:s.showSources?"collapse":"expand"},[us,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:k([s.showSources?"arrow-point-down mb-2":"arrow-point-up "])},hs,2))],8,ds)]),u(y,{name:"dropdown"},{default:p(()=>[s.showSources?(i(),l("div",ms,[u(b,{userId:s.user.id,deleteResource:e.deleteResource,onCloseResourceDiv:n[7]||(n[7]=f=>s.showSources=!1)},null,8,["userId","deleteResource"])])):m("",!0)]),_:1})]),ps,o("div",ks,[o("div",ws,[o("div",{class:"log-type",onClick:n[8]||(n[8]=f=>s.showSkills=!s.showSkills),"b-on-hover":"",title:s.showSkills?"collapse":"expand"},[vs,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:k([s.showSkills?"arrow-point-down mb-2":"arrow-point-up "])},ys,2))],8,fs)]),u(y,{name:"dropdown"},{default:p(()=>[s.showSkills?(i(),l("div",xs,[u(M,{userId:s.user.id,onCloseResourceDiv:n[9]||(n[9]=f=>s.showSkills=!1)},null,8,["userId"])])):m("",!0)]),_:1})]),Ss])])}const Qs=g($e,[["render",bs]]);export{Qs as default};
