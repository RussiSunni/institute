import{_ as $,u as L,j as z,S as B,k as _,l as S,m as l,C as y,T as w,n as v,G as R,s as E,q as U,x as j,e as A,o as m,c as b,a as h,h as T,F as I,p as G,b as V,f as F,g as x,y as O}from"./main-9ca7b5ce.js";const q={setup(){const e=L(),i=z();return{userDetailsStore:e,skillTreeStore:i}},data(){return{width:null,height:null,skill:{id:null,children:[],isMastered:null,isUnlocked:null,name:null},tree:{},root:{},isSkillInfoPanelShown:!1,dx:null,dy:null,data:{},radius:0,radiusMultiplier:256,firstLevelNodeSize:400,secondLevelNodeSize:100,regularNodeSize:50,subSkillRadius:50}},components:{SkillPanel:B},created(){this.$pixiApp.start(),this.$radialTreeContainer.visible=!0,this.$tidyTreeContainer.visible=!1,this.$pixiApp.renderer.background.color=0},async mounted(){this.skillTreeStore.userSkillsSubSkillsSeparate.length==0&&await this.skillTreeStore.getUserSkillsSubSkillsSeparate(),this.$radialTreeContainer.children.length==0&&(this.width=window.innerWidth,this.height=window.innerHeight,this.radius=Math.min(this.width,this.height)/2-30,this.skill={name:"SKILLS",sprite:null,children:this.skillTreeStore.userSkillsSubSkillsSeparate},this.getAlgorithm()),document.querySelector("#skilltree").appendChild(this.$pixiApp.view)},methods:{getAlgorithm(){var e=[];e=JSON.parse(JSON.stringify(this.skill.children)),this.data={skill_name:"My skills",children:e};const i=_().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((s,r)=>(s.parent==r.parent?1:2)/s.depth);this.root=i(S(this.data)),this.drawTree()},drawTree(){const e=l.from("center-node.png");e.x=this.root.x,e.y=this.root.y,e.anchor.set(.5),this.$radialTreeContainer.addChild(e);const i=this.root.descendants(),s=this.root.links();for(const r of s)this.drawLink(r);for(const r of i)this.drawNode(r)},drawNode(e){let i=new y;i.x=Math.cos(e.x)*e.y,i.y=Math.sin(e.x)*e.y,this.$radialTreeContainer.addChild(i);var s=new l;if(e.data.level=="grade_school"?e.data.is_mastered?s=l.from("images/skill-tree-nodes/grade-school-mastered.png"):e.data.is_accessible?s=l.from("images/skill-tree-nodes/grade-school-unlocked.png"):s=l.from("images/skill-tree-nodes/grade-school-locked.png"):e.data.level=="middle_school"?e.data.is_mastered?s=l.from("images/skill-tree-nodes/middle-school-mastered.png"):e.data.is_accessible?s=l.from("images/skill-tree-nodes/middle-school-unlocked.png"):s=l.from("images/skill-tree-nodes/middle-school-locked.png"):e.data.level=="high_school"?e.data.is_mastered?s=l.from("images/skill-tree-nodes/high-school-mastered.png"):e.data.is_accessible?s=l.from("images/skill-tree-nodes/middle-school-unlocked.png"):s=l.from("images/skill-tree-nodes/middle-school-locked.png"):e.data.level=="college"?e.data.is_mastered?s=l.from("images/skill-tree-nodes/college-mastered.png"):e.data.is_accessible?s=l.from("images/skill-tree-nodes/middle-school-unlocked.png"):s=l.from("images/skill-tree-nodes/middle-school-locked.png"):e.data.level=="phd"?e.data.is_mastered?s=l.from("images/skill-tree-nodes/phd-mastered.png"):e.data.is_accessible?s=l.from("images/skill-tree-nodes/middle-school-unlocked.png"):s=l.from("images/skill-tree-nodes/middle-school-locked.png"):e.data.level=="domain"&&(s=l.from("images/skill-tree-nodes/domain.png")),s.anchor.set(.5),e.depth==1?(s.width=this.firstLevelNodeSize,s.height=this.firstLevelNodeSize):e.depth==2?(s.width=this.secondLevelNodeSize,s.height=this.secondLevelNodeSize):(s.width=this.regularNodeSize,s.height=this.regularNodeSize),i.addChild(s),s.eventMode="static",s.cursor="pointer",s.on("pointerdown",a=>{var d={id:e.data.id,isMastered:e.data.is_mastered,isUnlocked:e.data.is_accessible,name:e.data.skill_name};this.skill=d,this.isSkillInfoPanelShown||this.showInfoPanel()}),e.data.subskills)for(let a=0;a<e.data.subskills.length;a++){let d=new y,g=360/e.data.subskills.length*a,k=g*Math.PI/180,P=this.subSkillRadius*Math.cos(k),C=this.subSkillRadius*Math.sin(k);d.x=P,d.y=C;var s=new l;e.data.level=="grade_school"?e.data.is_mastered?s=l.from("images/skill-tree-nodes/grade-school-small-mastered.png"):e.data.is_accessible?s=l.from("images/skill-tree-nodes/grade-school-small-unlocked.png"):s=l.from("images/skill-tree-nodes/grade-school-small-locked.png"):e.data.level=="middle_school"?e.data.is_mastered?s=l.from("images/skill-tree-nodes/middle-school-small-mastered.png"):e.data.is_accessible?s=l.from("images/skill-tree-nodes/middle-school-small-unlocked.png"):s=l.from("images/skill-tree-nodes/middle-school-small-locked.png"):e.data.level=="high_school"?e.data.is_mastered?s=l.from("images/skill-tree-nodes/high-school-small-mastered.png"):e.data.is_accessible?s=l.from("images/skill-tree-nodes/high-school-small-unlocked.png"):s=l.from("images/skill-tree-nodes/high-school-small-locked.png"):e.data.level=="college"?e.data.is_mastered?s=l.from("images/skill-tree-nodes/college-smal-mastered.png"):e.data.is_accessible?s=l.from("images/skill-tree-nodes/college-small-unlocked.png"):s=l.from("images/skill-tree-nodes/college-small-locked.png"):e.data.level=="phd"&&(e.data.is_mastered?s=l.from("images/skill-tree-nodes/phd-small-mastered.png"):e.data.is_accessible?s=l.from("images/skill-tree-nodes/phd-small-unlocked.png"):s=l.from("images/skill-tree-nodes/phd-small-locked.png")),s.width=15,s.height=15,s.anchor.set(.5),s.eventMode="static",s.cursor="pointer",s.on("pointerdown",Z=>{var N={id:e.data.subskills[a].id,isMastered:e.data.subskills[a].is_mastered,isUnlocked:e.data.subskills[a].is_accessible,name:e.data.subskills[a].skill_name};this.skill=N,this.isSkillInfoPanelShown||this.showInfoPanel()}),d.addChild(s);const M=new w({fontFamily:"Poppins900",fontSize:"10",fill:"white",align:"center",strokeThickness:2,stroke:"black"}),u=new v(e.data.subskills[a].skill_name,M);u.angle=g,d.addChild(u),i.addChild(d)}let r,n;e.depth==0?(r=200,n="#000000"):e.depth==1?(r=100,n="#ffffff"):(r=50,n="#ffffff");const c=new w({fontFamily:"Poppins900",fontSize:r,fill:n,align:"center",strokeThickness:4,stroke:"black"}),o=new v(e.data.skill_name,c);e.depth==0||e.depth==1?o.anchor.set(.5,.5):e.depth>1&&(o.anchor.set(0,.5),o.angle=e.x*180/Math.PI-90,i.x>0?o.angle=o.angle+90:o.angle=o.angle-90),o.scale.set(.5,.5),i.addChild(o)},drawLink(e){const i=new R;e.target.data.is_mastered=="1"?i.lineStyle(16,16777215,1):i.lineStyle(2,16777215,1);var s=Math.cos(e.source.x)*e.source.y,r=Math.sin(e.source.x)*e.source.y;i.moveTo(s,r);var n=Math.cos(e.target.x)*e.target.y,c=Math.sin(e.target.x)*e.target.y;i.lineTo(n,c),this.$radialTreeContainer.addChild(i)},showInfoPanel(){this.isSkillInfoPanelShown||(this.isSkillInfoPanelShown=!0,screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",this.skill.isMastered=="1"?document.getElementById("mastery-checkbox").checked=!0:document.getElementById("mastery-checkbox").checked=!1)},hideInfoPanel(){this.isSkillInfoPanelShown&&(screen.width>800?document.getElementById("skillInfoPanel").style.width="0px":document.getElementById("skillInfoPanel").style.height="0px",document.getElementById("sidepanel-backdrop").style.display="none",this.isSkillInfoPanelShown=!1)},async printPDF(){await this.createSVGTree();var e=document.getElementById("linearTree"),i=E(e),s=i.node(),r=new XMLSerializer,n=r.serializeToString(s),c={svg:n,treeType:"linear"},o=JSON.stringify(c),a=new XMLHttpRequest;a.responseType="arraybuffer",a.open("POST","/skilltree/print-pdf",!0),a.setRequestHeader("Content-type","application/json;charset=UTF-8"),a.setRequestHeader("Accept","application/json, text/plain, */*"),a.send(o),a.onload=function(){if(this.readyState==4&&this.status==200){let f=new Blob([a.response],{type:"application/pdf"});const t=window.URL.createObjectURL(f);var d=document.createElement("a");document.body.appendChild(d),d.style="display: none",d.href=t,d.download="My-Skill-Tree.pdf",d.click(),window.URL.revokeObjectURL(t)}}},createSVGTree(){const e=S(this.data),i=15,s=this.width/(e.height+1);_().nodeSize([i,s])(e);let n=1/0,c=-n;e.each(t=>{t.x>c&&(c=t.x),t.x<n&&(n=t.x)});const o=c-n+this.dx*2;let a=U("svg").attr("id","linearTree").attr("width",this.width).attr("height",o).attr("viewBox",[-s/3,n-i,this.width,o]).attr("style","max-width: 100%; height: auto; font: 10px sans-serif;");const d=a.append("g");d.append("g").attr("fill","none").attr("stroke-opacity",1).selectAll().data(e.links()).join("path").attr("d",j().x(t=>t.y).y(t=>t.x)).attr("stroke",function(t){return"#000"}).attr("stroke-width",function(t){return t.target.data.is_mastered==1?8:1.5}).style("stroke-dasharray",function(t){if(t.source.data.type=="super"&&t.target.data.position=="end"||t.target.data.type=="sub")return 5});const f=d.append("g").attr("stroke-linejoin","round").attr("stroke-width",3).selectAll().data(e.descendants()).join("g").attr("transform",t=>`translate(${t.y},${t.x})`);f.append("circle").attr("fill",t=>t.children?"#555":"#000").attr("r",2.5),f.append("text").style("font-weight",function(t){return t.data.type=="super"?"700":"400"}).style("font-style",function(t){if(t.data.type=="sub")return"italic"}).attr("dy","0.31em").attr("x",t=>t.children?-6:6).attr("text-anchor",t=>t.children?"end":"start").text(function(t){return t.data.position=="end"?"":t.data.skill_name}).clone(!0).lower().attr("stroke",function(t){return"white"}),document.querySelector("#SVGskilltree").append(a.node())}}},p=e=>(G("data-v-6fee91d9"),e=e(),V(),e),H={id:"wrapper"},D=p(()=>h("div",{id:"skilltree"},null,-1)),X=p(()=>h("div",{id:"SVGskilltree"},null,-1)),J=p(()=>h("div",{id:"sidepanel-backdrop"},null,-1));function Y(e,i,s,r,n,c){const o=A("SkillPanel");return m(),b(I,null,[h("button",{id:"print-btn",class:"btn btn-info",onClick:i[0]||(i[0]=a=>c.printPDF())}," Print "),h("div",H,[T(o,{skill:n.skill},null,8,["skill"]),D,X,J])],64)}const K=$(q,[["render",Y],["__scopeId","data-v-6fee91d9"]]);const W=h("div",{id:"purple-banner"},null,-1),Q=h("span",null,"Loading...",-1),se={__name:"RadialTreeView",setup(e){return(i,s)=>(m(),b(I,null,[W,(m(),F(O,null,{default:x(()=>[T(K)]),fallback:x(()=>[Q]),_:1}))],64))}};export{se as default};
