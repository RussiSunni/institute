import{_ as g,q as M,i as w,o as i,c as l,d as o,F as y,l as S,t as c,A as p,m as r,b as k,a as u,w as m,n as Q,T as v}from"./main-bb333cd6.js";import{u as D,a as $,b as C}from"./EssayQuestionsStore-aaa9c68e.js";const N={props:["userId","deleteFlag"],setup(){const e=M(),n=D(),d=$(),_=C();return{skillsStore:e,resourcesStore:n,mcQuestionsStore:d,essayQuestionsStore:_}},data(){return{contentFlags:[],rows:[]}},components:{},async created(){},async mounted(){await this.getContentFlagLogs(),this.contentFlags.forEach(e=>{const n=JSON.parse(e.content_obj),d=new Date(e.create_date),_=d.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),a={date:d.toLocaleTimeString()+` (${_})`,action:e.action,questionName:n.question,skillName:n.name,id:e.id};switch(e.flag_type){case"mc_question":a.type="mc_question",a.questionId=n.question_id,a.skillId=n.skill_id;break;case"resource":a.type="resource",a.skillId=n.skill_id;break;case"skill":a.type="skill",a.skillId=n.skill_id;break;default:a.type="delete";break}this.rows.push(a)})},methods:{async getContentFlagLogs(){const e=await fetch(`/user-actions/${this.userId}/flag`);this.contentFlags=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},U={key:0,class:"container-md main-container"},j={class:"d-flex flex-column gap-3"},L={class:"d-flex"},A={class:"d-flex w-fit me-1"},T={key:0,class:"d-flex flex-wrap ml-1"},R={key:0},O={key:1,class:"d-flex flex-wrap ml-1"},B={key:2,class:"d-flex flex-wrap ml-1"},E={key:3,class:"d-flex flex-wrap ml-1"},z={key:1,class:"shake"};function V(e,n,d,_,t,a){const h=w("router-link");return t.rows.length?(i(),l("div",U,[o("div",j,[(i(!0),l(y,null,S(t.rows,s=>(i(),l("div",L,[o("div",A,c(s.date),1),s.type==="skill"?(i(),l("div",T,[o("span",{class:p(a.actionColor(s.action))}," - "+c(s.action),3),r("   "),s.action=="delete"?(i(),l("span",R," flag with id: "+c(s.id),1)):k("",!0),r("flag on skill:  "),u(h,{class:"skill-link",target:"_blank",to:`/skills/${s.skillId}`},{default:m(()=>[r(c(s.skillName),1)]),_:2},1032,["to"])])):k("",!0),s.type==="resource"?(i(),l("div",O,[o("span",{class:p(a.actionColor(s.action))}," - "+c(s.action),3),r("  flag on resource of skill:  "),u(h,{class:"skill-link",target:"_blank",to:`/skills/${s.skillId}`},{default:m(()=>[r(c(s.skillName),1)]),_:2},1032,["to"])])):k("",!0),s.type==="mc_question"?(i(),l("div",B,[o("span",{class:p(a.actionColor(s.action))}," - "+c(s.action),3),r("  flag on mc_question: "),u(h,{class:"question-link",target:"_blank",to:`/skills/${s.skillId}/question-bank`},{default:m(()=>[r(c(s.questionName),1)]),_:2},1032,["to"]),r(" on skill:  "),u(h,{class:"skill-link",target:"_blank",to:`/skills/${s.skillId}`},{default:m(()=>[r(c(s.skillName),1)]),_:2},1032,["to"])])):k("",!0),s.type==="delete"?(i(),l("div",E,[o("span",{class:p(a.actionColor(s.action)+" me-1")}," - "+c(s.action),3),r(" flag with id "+c(s.id),1)])):k("",!0)]))),256))])])):(i(),l("div",z,"The user has no action on flags"))}const H=g(N,[["render",V]]),J={props:["userId","deleteResource"],data(){return{resourcesData:[],rows:[]}},components:{},async created(){await this.getResourceLogs(),this.resourcesData.forEach(e=>{const n=JSON.parse(e.content_obj),d=new Date(e.create_date),_=d.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),t=d.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:_,time:t,id:e.id})})},methods:{async getResourceLogs(){const e=await fetch(`/user-actions/${this.userId}/resource`);this.resourcesData=await e.json(),console.log(this.resourcesData)},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},P={key:0,class:"container-md main-container"},G={class:"d-flex flex-column"},K={key:0},W={key:1},X={key:1,class:"shake"};function Y(e,n,d,_,t,a){const h=w("router-link");return t.rows.length?(i(),l("div",P,[o("div",G,[(i(!0),l(y,null,S(t.rows,s=>(i(),l("div",null,[r(c(s.time)+" ("+c(s.date)+") - ",1),o("span",{class:p(a.actionColor(s.action))},c(s.action),3),s.action==="delete"?(i(),l("span",K," a resource with id "+c(s.id),1)):(i(),l("span",W," resource for skill: ")),u(h,{class:"skill-link",target:"_blank",to:`/skills/${s.skillId}`},{default:m(()=>[r(c(s.skillName),1)]),_:2},1032,["to"])]))),256))])])):(i(),l("div",X,"The user has no action on resource"))}const Z=g(J,[["render",Y]]),q={props:["userId","deleteMcQuestion"],data(){return{questionsData:[],rows:[]}},components:{},async created(){await this.getMcQuestionsLog(),this.questionsData.forEach(e=>{e.action==="update"&&console.log(e);const n=JSON.parse(e.content_obj),d=new Date(e.create_date),_=d.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),t=d.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:_,time:t,id:e.id,studentName:n.student_name,studentId:n.student_id})})},methods:{async getMcQuestionsLog(){const e=await fetch(`/user-actions/${this.userId}/mc_question`);this.questionsData=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},F={key:0,class:"container-md main-container"},ee={class:"d-flex flex-column"},se={key:0},te={key:1},oe={key:2},ne={key:1,class:"shake"};function ie(e,n,d,_,t,a){const h=w("router-link");return t.rows.length>0?(i(),l("div",F,[o("div",ee,[(i(!0),l(y,null,S(t.rows,s=>(i(),l("div",null,[r(c(s.time)+" ("+c(s.date)+") ",1),o("span",{class:p(a.actionColor(s.action))}," - "+c(s.action),3),s.action==="delete"?(i(),l("span",se," mc_question with id "+c(s.id),1)):s.action==="create"?(i(),l("span",te," mc_question for skill: ")):(i(),l("span",oe,[r(" mc question of student "),u(h,{class:"user-link",target:"_blank",to:"/users"},{default:m(()=>[r(c(s.studentName),1)]),_:2},1024),r(" on skill: ")])),u(h,{class:"skill-link",target:"_blank",to:`/skills/${s.skillId}`},{default:m(()=>[r(c(s.skillName),1)]),_:2},1032,["to"])]))),256))])])):(i(),l("div",ne," The user has no action on multiple-choice questions "))}const le=g(q,[["render",ie]]),ce={props:["userId","deleteResource"],data(){return{skillsData:[],rows:[]}},components:{},async created(){await this.getSkillLogs(),this.skillsData.forEach(e=>{const n=JSON.parse(e.content_obj),d=new Date(e.create_date),_=d.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),t=d.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:_,time:t,id:e.id})})},methods:{async getSkillLogs(){const e=await fetch(`/user-actions/${this.userId}/skill`);this.skillsData=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},re={key:0,class:"container-md main-container"},ae={class:"d-flex flex-column"},de={key:0},ue={key:1},_e={key:1,class:"shake"};function he(e,n,d,_,t,a){const h=w("router-link");return t.rows.length?(i(),l("div",re,[o("div",ae,[(i(!0),l(y,null,S(t.rows,s=>(i(),l("div",null,[r(c(s.time)+" ("+c(s.date)+") - ",1),o("span",{class:p(a.actionColor(s.action))},c(s.action),3),s.action==="delete"?(i(),l("span",de," a skill with id "+c(s.id),1)):(i(),l("span",ue," skill: ")),u(h,{class:"skill-link",target:"_blank",to:`/skills/${s.skillId}`},{default:m(()=>[r(c(s.skillName),1)]),_:2},1032,["to"])]))),256))])])):(i(),l("div",_e,"The user has no action on skill"))}const me=g(ce,[["render",he]]),pe={props:["userId","deleteMcQuestion"],data(){return{questionsData:[],rows:[]}},components:{},async created(){await this.getMcQuestionsLog(),this.questionsData.forEach(e=>{e.action==="update"&&console.log(e);const n=JSON.parse(e.content_obj),d=new Date(e.create_date),_=d.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),t=d.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:_,time:t,id:e.id,studentName:n.student_name,studentId:n.student_id})})},methods:{async getMcQuestionsLog(){const e=await fetch(`/user-actions/${this.userId}/student_mc_question`);this.questionsData=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},we={key:0,class:"container-md main-container"},ke={class:"d-flex flex-column"},fe={key:0},ge={key:1},ve={key:2},ye={key:1,class:"shake"};function Se(e,n,d,_,t,a){const h=w("router-link");return t.rows.length>0?(i(),l("div",we,[o("div",ke,[(i(!0),l(y,null,S(t.rows,s=>(i(),l("div",null,[r(c(s.time)+" ("+c(s.date)+") ",1),o("span",{class:p(a.actionColor(s.action))}," - "+c(s.action),3),s.action==="delete"?(i(),l("span",fe," student mc_question with id "+c(s.id),1)):s.action==="create"?(i(),l("span",ge," student mc_question for skill: ")):(i(),l("span",ve,[r(" mc question of student "),u(h,{class:"user-link",target:"_blank",to:"/users"},{default:m(()=>[r(c(s.studentName),1)]),_:2},1024),r(" on skill: ")])),u(h,{class:"skill-link",target:"_blank",to:`/skills/${s.skillId}`},{default:m(()=>[r(c(s.skillName),1)]),_:2},1032,["to"])]))),256))])])):(i(),l("div",ye," The user has no action on multiple-choice questions "))}const xe=g(pe,[["render",Se]]);const be={setup(){return{usersStore:Q()}},data(){return{user:{id:this.$route.params.id,firstName:null,lastName:null,username:null,role:null,avatar:null},showFlags:!1,showSources:!1,showMcQuestions:!1,showStudentMcQuestions:!1,showSkills:!1,mcQuestions:[],resources:[],flags:[],skillEdits:[]}},components:{UserFlagActions:H,UserResourceActions:Z,UserMcQuestionActions:le,UserStudentMcQuestionActions:xe,UserSkillActions:me},async created(){await this.getUserDetails()},methods:{async getUserDetails(){this.usersStore.users.length<1&&await this.usersStore.getUsers();for(let e=0;e<this.usersStore.users.length;e++)this.usersStore.users[e].id==this.user.id&&(this.user.firstName=this.usersStore.users[e].first_name,this.user.lastName=this.usersStore.users[e].last_name,this.user.username=this.usersStore.users[e].username,this.user.role=this.usersStore.users[e].role,this.user.avatar=this.usersStore.users[e].avatar)}}},Ie={class:"container"},Me=o("div",{class:"mt-4 mb-4"},[o("h1",null,"User Activity Report")],-1),Qe={class:"row"},De={class:"d-flex flex-column flex-md-row gap-3"},$e=["src"],Ce={class:"d-flex flex-column"},Ne={id:"user-name"},Ue={id:"role"},je={class:"d-flex flex-column"},Le={class:"d-flex flex-row justify-content-between"},Ae=["title"],Te=o("span",null," Flags ",-1),Re=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),Oe=[Re],Be={key:0},Ee=o("hr",{class:"mt-5 mb-3"},null,-1),ze={class:"d-flex flex-column"},Ve={class:"d-flex flex-row justify-content-between"},He=["title"],Je=o("span",null,"MC Questions ",-1),Pe=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),Ge=[Pe],Ke={key:0},We=o("hr",{class:"mt-5 mb-3"},null,-1),Xe={class:"d-flex flex-column"},Ye={class:"d-flex flex-row justify-content-between"},Ze=["title"],qe=o("span",null,"Student MC Questions ",-1),Fe=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),es=[Fe],ss={key:0},ts=o("hr",{class:"mt-5 mb-3"},null,-1),os={class:"d-flex flex-column"},ns={class:"d-flex flex-row justify-content-between"},is=["title"],ls=o("span",null," Resources ",-1),cs=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),rs=[cs],as={key:0},ds=o("hr",{class:"mt-5 mb-3"},null,-1),us={class:"d-flex flex-column"},_s={class:"d-flex flex-row justify-content-between"},hs=["title"],ms=o("span",null," Skills ",-1),ps=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),ws=[ps],ks={key:0},fs=o("hr",{class:"mt-5 mb-3"},null,-1);function gs(e,n,d,_,t,a){const h=w("UserFlagActions"),s=w("UserMcQuestionActions"),x=w("UserStudentMcQuestionActions"),b=w("UserResourceActions"),I=w("UserSkillActions");return i(),l("div",Ie,[Me,o("div",Qe,[o("div",De,[o("img",{id:"activity-report-user-avatar",src:t.user.avatar},null,8,$e),o("div",Ce,[o("div",Ne,c(t.user.username),1),o("div",Ue,c(t.user.role),1)])])]),o("div",null,[o("div",je,[o("div",Le,[o("div",{class:"log-type",onClick:n[0]||(n[0]=f=>t.showFlags=!t.showFlags),"b-on-hover":"",title:t.showFlags?"collapse":"expand"},[Te,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([t.showFlags?"arrow-point-down mb-2":"arrow-point-up "])},Oe,2))],8,Ae)]),u(v,{name:"dropdown"},{default:m(()=>[t.showFlags?(i(),l("div",Be,[u(h,{ref:"contentFlagsPerUser",userId:t.user.id,deleteFlag:e.deleteFlag,onCloseFlagDiv:n[1]||(n[1]=f=>t.showFlags=!1)},null,8,["userId","deleteFlag"])])):k("",!0)]),_:1})]),Ee,o("div",ze,[o("div",Ve,[o("div",{class:"log-type",onClick:n[2]||(n[2]=f=>t.showMcQuestions=!t.showMcQuestions),"b-on-hover":"",title:t.showMcQuestions?"collapse":"expand"},[Je,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([t.showMcQuestions?"arrow-point-down mb-2":"arrow-point-up"])},Ge,2))],8,He)]),u(v,{name:"dropdown"},{default:m(()=>[t.showMcQuestions?(i(),l("div",Ke,[u(s,{userId:t.user.id,deleteMcQuestion:e.deleteMcQuestion,onCloseMcQuestionDiv:n[3]||(n[3]=f=>t.showMcQuestions=!1)},null,8,["userId","deleteMcQuestion"])])):k("",!0)]),_:1})]),We,o("div",Xe,[o("div",Ye,[o("div",{class:"log-type",onClick:n[4]||(n[4]=f=>t.showStudentMcQuestions=!t.showStudentMcQuestions),"b-on-hover":"",title:t.showStudentMcQuestions?"collapse":"expand"},[qe,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([t.showStudentMcQuestions?"arrow-point-down mb-2":"arrow-point-up"])},es,2))],8,Ze)]),u(v,{name:"dropdown"},{default:m(()=>[t.showStudentMcQuestions?(i(),l("div",ss,[u(x,{userId:t.user.id,deleteMcQuestion:e.deleteMcQuestion,onCloseMcQuestionDiv:n[5]||(n[5]=f=>t.showStudentMcQuestions=!1)},null,8,["userId","deleteMcQuestion"])])):k("",!0)]),_:1})]),ts,o("div",os,[o("div",ns,[o("div",{class:"log-type",onClick:n[6]||(n[6]=f=>t.showSources=!t.showSources),"b-on-hover":"",title:t.showSources?"collapse":"expand"},[ls,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([t.showSources?"arrow-point-down mb-2":"arrow-point-up "])},rs,2))],8,is)]),u(v,{name:"dropdown"},{default:m(()=>[t.showSources?(i(),l("div",as,[u(b,{userId:t.user.id,deleteResource:e.deleteResource,onCloseResourceDiv:n[7]||(n[7]=f=>t.showSources=!1)},null,8,["userId","deleteResource"])])):k("",!0)]),_:1})]),ds,o("div",us,[o("div",_s,[o("div",{class:"log-type",onClick:n[8]||(n[8]=f=>t.showSkills=!t.showSkills),"b-on-hover":"",title:t.showSkills?"collapse":"expand"},[ms,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:p([t.showSkills?"arrow-point-down mb-2":"arrow-point-up "])},ws,2))],8,hs)]),u(v,{name:"dropdown"},{default:m(()=>[t.showSkills?(i(),l("div",ks,[u(I,{userId:t.user.id,onCloseResourceDiv:n[9]||(n[9]=f=>t.showSkills=!1)},null,8,["userId"])])):k("",!0)]),_:1})]),fs])])}const Ss=g(be,[["render",gs]]);export{Ss as default};
