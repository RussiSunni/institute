import{_ as k,u as S,S as m,r as v,o as u,c as _,b as o,a as g,p as y,d as w,e as x,f,g as b,F as T}from"./main-5654a60e.js";import{u as I}from"./SkillTreeStore-3c743cda.js";import{u as P,S as M,h as $}from"./transform-2c764ffe.js";import{S as L}from"./fontfaceobserver.standalone-2f9819b3.js";import{c as N,l as R,z as j,s as z}from"./zoom-01382c06.js";import{t as D}from"./tree-ecf365d3.js";const A={setup(){const t=S(),s=I(),a=P();return{userDetailsStore:t,skillTreeStore:s,skillTagsStore:a}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,width:null,height:null,radiusMultiplier:1,firstLevelNodeSize:100,regularNodeSize:50,subSkillRadius:50,skill:{id:null,children:[],isMastered:null,isUnlocked:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:M,SkillPanel:L},async mounted(){this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills(),this.width=3e4,this.height=3e4,this.radius=Math.min(this.width,this.height)/2;const t=m.from("center-node.png");this.skill={name:"SKILLS",sprite:t,children:this.skillTreeStore.userSkills},this.getAlgorithm()},methods:{getAlgorithm(){var t=[];t=JSON.parse(JSON.stringify(this.skill.children));function s(e){for(var l=e.length;l--;)e[l].type=="sub"&&e.splice(l,1),typeof e[l]<"u"&&e[l].children&&Array.isArray(e[l].children)&&e[l].children.length>0&&s(e[l].children)}s(t);var a={name:null,children:t};const n=D().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((e,l)=>(e.parent==l.parent,1/e.depth))($(a)),d=this.width*.5,c=this.height*.5,r=N("svg").attr("id","radialTree").attr("width",this.width).attr("height",this.height).attr("viewBox",[-d,-c,this.width,this.height]).attr("style","width: 100%; height: auto; font: 10px sans-serif;"),i=r.append("g");i.append("g").attr("fill","none").attr("stroke","#000").attr("stroke-opacity",1).selectAll().data(n.links()).join("path").attr("d",R().angle(e=>e.x).radius(e=>e.y)).attr("stroke-width",function(e){return e.target.data.is_mastered==1?8:2}),i.append("g").selectAll().data(n.descendants()).join("circle").attr("transform",e=>`rotate(${e.x*180/Math.PI-90}) translate(${e.y},0)`).attr("fill",function(e){if(e.depth==0)return"lightgreen";if(e.data.type=="domain")return"orange";if(e.data.level=="grade_school")return"yellow";if(e.data.level=="middle_school")return"lightblue";if(e.data.level=="high_school")return"green";if(e.data.level=="college")return"red";if(e.data.level=="phd")return"purple"}).attr("r",function(e){return e.depth==0?50:e.data.type=="domain"?20:5}),i.append("g").attr("stroke-linejoin","round").attr("stroke-width",3).selectAll().data(n.descendants()).join("text").attr("transform",e=>`rotate(${e.x*180/Math.PI-90}) translate(${e.y},0) rotate(${e.x>=Math.PI?180:0})`).attr("dy","0.31em").attr("x",e=>e.x<Math.PI==!e.children?6:-6).attr("text-anchor",e=>e.x<Math.PI==!e.children?"start":"end").attr("paint-order","stroke").attr("stroke","white").attr("fill","currentColor").text(e=>e.data.skill_name),r.call(j().extent([[0,0],[this.width,this.height]]).scaleExtent([1e-4,20]).on("zoom",p));function p({transform:e}){i.attr("transform",e)}document.querySelector("#skilltree").append(r.node())},printPDF(){var t=document.getElementById("radialTree"),s=z(t),a=s.node(),h=new XMLSerializer,n=h.serializeToString(a),d={svg:n,treeType:"radial"},c=JSON.stringify(d),r=new XMLHttpRequest;r.responseType="arraybuffer",r.open("POST","/skilltree/print-pdf",!0),r.setRequestHeader("Content-type","application/json;charset=UTF-8"),r.setRequestHeader("Accept","application/json, text/plain, */*"),r.send(c),r.onload=function(){if(this.readyState==4&&this.status==200){let p=new Blob([r.response],{type:"application/pdf"});const e=window.URL.createObjectURL(p);var i=document.createElement("a");document.body.appendChild(i),i.style="display: none",i.href=e,i.download="My-Skill-Tree.pdf",i.click(),window.URL.revokeObjectURL(e)}}}}},B=t=>(y("data-v-02aa7fa4"),t=t(),w(),t),U={class:"flex-container skill-tree-container"},O={id:"wrapper"},F={id:"skilltree"},q=B(()=>o("div",{id:"sidepanel-backdrop"},null,-1));function E(t,s,a,h,n,d){const c=v("SkillPanel");return u(),_("div",U,[o("button",{id:"print-btn",class:"btn btn-info",onClick:s[0]||(s[0]=r=>d.printPDF())}," Print "),o("div",O,[o("div",F,[g(c,{skill:n.skill},null,8,["skill"])]),q])])}const V=k(A,[["render",E],["__scopeId","data-v-02aa7fa4"]]);const H=o("div",{id:"purple-banner"},null,-1),J=o("span",null,"Loading...",-1),Y={__name:"SkillTreeD3View",setup(t){return(s,a)=>(u(),_(T,null,[H,(u(),x(b,null,{default:f(()=>[g(V)]),fallback:f(()=>[J]),_:1}))],64))}};export{Y as default};
