import{E as f,_ as S,j as g,G as p,o,c as d,b as r,k as c,t as m,i as k,g as h,F as v,p as b,a as A}from"./main-2caa7d4a.js";import{u as _}from"./AssessmentsStore-7f65a933.js";import{u as y}from"./UsersStore-377b3790.js";import{u as q}from"./UserSkillsStore-4b6bfcf2.js";import{_ as N}from"./general-banner-1c13aca4.js";const U=f("unmarkedAnswers",{state:()=>({unmarkedAnswers:[]}),actions:{async getUnmarkedAnswers(){const e=await(await fetch("/unmarked-answers/list")).json(),l=await(await fetch("/questions/essay/list")).json();for(let i=0;i<e.length;i++)for(let n=0;n<l.length;n++)e[i].question_id==l[n].id&&(e[i].question=l[n].question);const a=await(await fetch("/assessments/list")).json();for(let i=0;i<e.length;i++)for(let n=0;n<a.length;n++)e[i].assessment_id==a[n].id&&(e[i].studentId=a[n].student_id,e[i].skillId=a[n].skill_id);return this.unmarkedAnswers=e,this.$state},async deleteUnmarkedAnswer(s){const e=await fetch("/unmarked-answers/"+s.id,{method:"DELETE"});await(await fetch("/unmarked-answers/list/"+s.assessment_id)).json()==0&&_().deleteAssessment(s.assessment_id),e.error&&console.log(e.error),this.getUnmarkedAnswers()}}});const I={setup(){const s=U(),e=_(),t=y(),l=g(),u=q();return{unmarkedAnswersStore:s,usersStore:t,skillsStore:l,assessmentsStore:e,userSkillsStore:u}},data(){return{assessmentId:this.$route.params.id,questionNumber:0,answers:[],assessment:{},skill:{}}},async created(){this.unmarkedAnswersStore.unmarkedAnswers.length==0&&await this.unmarkedAnswersStore.getUnmarkedAnswers(),this.assessmentsStore.assessments.length==0&&await this.assessmentsStore.getAssessments();for(let s=0;s<this.unmarkedAnswersStore.unmarkedAnswers.length;s++)this.unmarkedAnswersStore.unmarkedAnswers[s].assessment_id==this.assessmentId&&this.answers.push(this.unmarkedAnswersStore.unmarkedAnswers[s]);for(let s=0;s<this.assessmentsStore.assessments.length;s++)this.assessmentsStore.assessments[s].id==this.assessmentId&&(this.assessment=this.assessmentsStore.assessments[s]);this.usersStore.users.length==0&&await this.usersStore.getUsers();for(let s=0;s<this.answers.length;s++)for(let e=0;e<this.usersStore.users.length;e++)this.answers[s].studentId==this.usersStore.users[e].id&&(this.answers[s].studentUsername=this.usersStore.users[e].username);this.skillsStore.skillsList.length==0&&await this.skillsStore.getSkillsList();for(let s=0;s<this.answers.length;s++)for(let e=0;e<this.skillsStore.skillsList.length;e++)this.answers[s].skillId==this.skillsStore.skillsList[e].id&&(this.answers[s].skillName=this.skillsStore.skillsList[e].name,this.skill=this.skillsStore.skillsList[e])},computed:{},methods:{Next(){this.questionNumber++},Previous(){this.questionNumber--},async MarkCorrect(s){var e="/assessments/"+s.assessment_id+"/increase-grade";await fetch(e,{method:"PUT",headers:{"Content-Type":"content/type"},body:{}}),await this.assessmentsStore.getAssessments();for(let t=0;t<this.assessmentsStore.assessments.length;t++)this.assessmentsStore.assessments[t].id==s.assessment_id&&this.assessmentsStore.assessments[t].num_unmarked_questions_remaining==0&&this.assessmentsStore.assessments[t].current_score/this.assessmentsStore.assessments[t].total_score*100>=90&&(this.MakeMastered(this.assessmentsStore.assessments[t].student_id,this.skill),alert("Student passed"));this.unmarkedAnswersStore.deleteUnmarkedAnswer(s),this.answers.splice(this.questionNumber,1)},async MarkIncorrect(s){var e="/assessments/"+s.assessment_id+"/decrease-grade";fetch(e,{method:"PUT",headers:{"Content-Type":"content/type"},body:{}}),await this.assessmentsStore.getAssessments();for(let t=0;t<this.assessmentsStore.assessments.length;t++)this.assessmentsStore.assessments[t].id==s.assessment_id&&this.assessmentsStore.assessments[t].num_unmarked_questions_remaining==0&&this.assessmentsStore.assessments[t].current_score/this.assessmentsStore.assessments[t].total_score*100<90&&alert("Student failed");this.unmarkedAnswersStore.deleteUnmarkedAnswer(s),this.answers.splice(this.questionNumber,1)},async MakeMastered(s,e){await this.userSkillsStore.MakeMastered(s,e)}}},w=s=>(b("data-v-128dd92d"),s=s(),A(),s),x=w(()=>r("div",{id:"banner"},[r("img",{src:N,class:"img-fluid"})],-1)),M={class:"container mt-3"},j=w(()=>r("div",{id:"page-tile"},"Unmarked Essay Questions",-1)),C={id:"assessment-info"},L={id:"date"},E={key:0},T={id:"question-bg"},$={class:"d-flex w-100 flex-row justify-content-end"},P={title:"student need to have at least 90% score per total score to pass",id:"score-text",class:"me-2"},V={title:"current score",id:"current-score"},D={title:"total score",id:"total-score"},B={id:"question",class:"mb-3"},F={id:"answer",class:"mb-3"},O={key:1},G={key:2,class:"d-flex mt-3 mb-2"},Q={class:"d-flex w-100 justify-content-center gap-2"},z={key:0,class:"d-flex justify-content-end"};function H(s,e,t,l,u,a){const i=p("b-tooltip");return o(),d(v,null,[x,r("div",M,[j,r("div",C,[c(m(this.assessment.studentUsername)+" : "+m(this.assessment.skillName)+" ",1),r("span",L,m(this.assessment.date),1)]),this.answers.length>0?(o(),d("div",E,[r("div",T,[r("div",$,[k((o(),d("span",P,[c(" score: ")])),[[i,void 0,void 0,{hover:!0}]]),k((o(),d("span",V,[c(m(this.assessment.current_score)+" / ",1)])),[[i,void 0,void 0,{hover:!0}]]),r("span",D,m(this.assessment.total_score),1)]),r("div",B,m(this.answers[this.questionNumber].question),1),r("div",F,m(this.answers[this.questionNumber].answer),1)])])):(o(),d("p",O,"No unmarked questions currently")),this.answers.length>0?(o(),d("div",G,[r("div",Q,[r("button",{onClick:e[0]||(e[0]=n=>a.MarkCorrect(this.answers[this.questionNumber])),class:"btn green-btn"}," Mark Correct "),r("button",{onClick:e[1]||(e[1]=n=>a.MarkIncorrect(this.answers[this.questionNumber])),class:"btn red-btn"}," Mark Incorrect ")]),this.answers.length>0?(o(),d("div",z,[this.questionNumber>0?(o(),d("button",{key:0,onClick:e[2]||(e[2]=n=>a.Previous()),class:"btn green-btn me-2"}," Previous ")):h("",!0),this.questionNumber!=this.answers.length-1?(o(),d("button",{key:1,onClick:e[3]||(e[3]=n=>a.Next()),class:"btn green-btn"}," Next ")):h("",!0)])):h("",!0)])):h("",!0)])],64)}const Y=S(I,[["render",H],["__scopeId","data-v-128dd92d"]]);export{Y as default};
