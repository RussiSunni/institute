import{_ as k,u as S,S as m,r as v,o as u,c as _,b as o,a as g,p as y,d as w,e as b,f,g as x,F as T}from"./main-9e950be5.js";import{u as I}from"./SkillTreeStore-2701a7f7.js";import{u as P,S as R,h as M}from"./transform-a6d6848e.js";import{S as $}from"./fontfaceobserver.standalone-2885f38f.js";import{c as L,l as N,z as j,s as z}from"./zoom-d657277b.js";import{t as A}from"./tree-c8b9f3a5.js";const B={setup(){const t=S(),i=I(),l=P();return{userDetailsStore:t,skillTreeStore:i,skillTagsStore:l}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,width:null,height:null,radiusMultiplier:1,firstLevelNodeSize:100,regularNodeSize:50,subSkillRadius:50,skill:{id:null,children:[],isMastered:null,isUnlocked:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:R,SkillPanel:$},async mounted(){this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills(),this.width=3e4,this.height=3e4,this.radius=Math.min(this.width,this.height)/2;const t=m.from("center-node.png");this.skill={name:"SKILLS",sprite:t,children:this.skillTreeStore.userSkills},this.getAlgorithm()},methods:{getAlgorithm(){var t=[];t=JSON.parse(JSON.stringify(this.skill.children));function i(e){for(var a=e.length;a--;)e[a].type=="sub"&&e.splice(a,1),typeof e[a]<"u"&&e[a].children&&Array.isArray(e[a].children)&&e[a].children.length>0&&i(e[a].children)}i(t);var l={name:null,children:t};const n=A().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((e,a)=>(e.parent==a.parent,1/e.depth))(M(l)),d=this.width*.5,c=this.height*.5,r=L("svg").attr("id","radialTree").attr("width",this.width).attr("height",this.height).attr("viewBox",[-d,-c,this.width,this.height]).attr("style","width: 100%; height: auto; font: 10px sans-serif;"),s=r.append("g");s.append("g").attr("fill","none").attr("stroke","#000").attr("stroke-opacity",1).selectAll().data(n.links()).join("path").attr("d",N().angle(e=>e.x).radius(e=>e.y)).attr("stroke-width",function(e){return e.target.data.is_mastered==1?8:2}),s.append("g").selectAll().data(n.descendants()).join("circle").attr("transform",e=>`rotate(${e.x*180/Math.PI-90}) translate(${e.y},0)`).attr("fill",function(e){if(e.depth==0)return"lightgreen";if(e.data.type=="domain")return"orange";if(e.data.level=="grade_school")return"yellow";if(e.data.level=="middle_school")return"lightblue";if(e.data.level=="high_school")return"green";if(e.data.level=="college")return"red";if(e.data.level=="phd")return"purple"}).attr("r",function(e){return e.depth==0?50:e.data.type=="domain"?20:5}),s.append("g").attr("stroke-linejoin","round").attr("stroke-width",3).selectAll().data(n.descendants()).join("text").attr("transform",e=>`rotate(${e.x*180/Math.PI-90}) translate(${e.y},0) rotate(${e.x>=Math.PI?180:0})`).attr("dy","0.31em").attr("x",e=>e.x<Math.PI==!e.children?6:-6).attr("text-anchor",e=>e.x<Math.PI==!e.children?"start":"end").attr("paint-order","stroke").attr("stroke","white").attr("fill","currentColor").text(e=>e.data.skill_name),r.call(j().extent([[0,0],[this.width,this.height]]).scaleExtent([1e-4,20]).on("zoom",p));function p({transform:e}){s.attr("transform",e)}document.querySelector("#skilltree").append(r.node())},printPDF(){var t=document.getElementById("radialTree"),i=z(t),l=i.node(),h=new XMLSerializer,n=h.serializeToString(l),d={svg:n,treeType:"radial"},c=JSON.stringify(d),r=new XMLHttpRequest;r.responseType="arraybuffer",r.open("POST","/skilltree/print-pdf",!0),r.setRequestHeader("Content-type","application/json;charset=UTF-8"),r.setRequestHeader("Accept","application/json, text/plain, */*"),r.send(c),r.onload=function(){if(this.readyState==4&&this.status==200){let p=new Blob([r.response],{type:"application/pdf"});const e=window.URL.createObjectURL(p);var s=document.createElement("a");document.body.appendChild(s),s.style="display: none",s.href=e,s.download="My-Skill-Tree.pdf",s.click(),window.URL.revokeObjectURL(e)}}}}},U=t=>(y("data-v-bb6c7cd7"),t=t(),w(),t),O={class:"flex-container skill-tree-container"},F={id:"wrapper"},D={id:"skilltree"},q=U(()=>o("div",{id:"sidepanel-backdrop"},null,-1));function E(t,i,l,h,n,d){const c=v("SkillPanel");return u(),_("div",O,[o("button",{id:"print-btn",class:"btn btn-info",onClick:i[0]||(i[0]=r=>d.printPDF())}," Print "),o("div",F,[o("div",D,[g(c,{skill:n.skill},null,8,["skill"])]),q])])}const V=k(B,[["render",E],["__scopeId","data-v-bb6c7cd7"]]);const H=o("div",{id:"purple-banner"},null,-1),J=o("span",null,"Loading...",-1),Y={__name:"RadialTidyTreeView",setup(t){return(i,l)=>(u(),_(T,null,[H,(u(),b(x,null,{default:f(()=>[g(V)]),fallback:f(()=>[J]),_:1}))],64))}};export{Y as default};
