import{_ as k,u as q,j as f,o as n,c as o,h as a,a as t,t as d,F as m,i as b,w as _,B as S,v as w,p,b as y,r as Q,e as M}from"./main-55b0ed21.js";import{u as x}from"./UserSkillsStore-e8eb4efd.js";import{u as A}from"./SettingsStore-7f0943e9.js";const I={setup(){const e=q(),s=x(),i=A(),h=f();return{userDetailsStore:e,userSkillsStore:s,settingsStore:i,skillsStore:h}},data(){return{loading:!0,skillId:this.$route.params.id,skill:{},mcQuestions:[],essayQuestions:[],questions:[],question:{},questionNumber:0,score:0,assessmentId:null,numMCQuestions:0,numEssayQuestions:0,totalNumOfQuestions:0,isAllQuestionsAnswered:!1,passModal:!1,failedModal:!1,waitForMarkModal:!1}},async created(){this.settingsStore.quizMaxQuestions==null&&await this.settingsStore.getSettings();let e;for(let s=0;s<this.skillsStore.skillsList.length;s++)this.skillsStore.skillsList[s].id==this.skillId&&(e=this.skillsStore.skillsList[s].type,this.skill=this.skillsStore.skillsList[s]);if(e!="super")await this.fetchMCQuestions(this.skillId);else{let s=[];for(let i=0;i<this.skillsStore.skillsList.length;i++)this.skillsStore.skillsList[i].parent==this.skillId&&this.skillsStore.skillsList[i].type=="sub"&&s.push(this.skillsStore.skillsList[i]);for(let i=0;i<s.length;i++)await this.fetchMCQuestions(s[i].id)}},methods:{async fetchMCQuestions(e){fetch("/questions/"+e+"/multiple-choice").then(function(s){return s.json()}).then(s=>{this.mcQuestions=this.mcQuestions.concat(s)}).then(()=>{for(let i=0;i<this.mcQuestions.length;i++)this.mcQuestions[i].userAnswer=null,this.mcQuestions[i].questionType="mc";for(let i=0;i<this.mcQuestions.length;i++){var s=[];s.push({option:this.mcQuestions[i].correct_answer,index:1}),s.push({option:this.mcQuestions[i].incorrect_answer_1,index:2}),s.push({option:this.mcQuestions[i].incorrect_answer_2,index:3}),s.push({option:this.mcQuestions[i].incorrect_answer_3,index:4}),s.push({option:this.mcQuestions[i].incorrect_answer_4,index:5}),s=s.sort((h,l)=>.5-Math.random()),this.mcQuestions[i].answerOptions=s}}).then(()=>{this.fetchEssayQuestions(e)})},async fetchEssayQuestions(e){fetch("/questions/"+e+"/essay").then(function(s){return s.json()}).then(s=>{this.essayQuestions=this.essayQuestions.concat(s)}).then(()=>{for(let s=0;s<this.essayQuestions.length;s++)this.essayQuestions[s].userAnswer=null,this.essayQuestions[s].questionType="essay"}).then(()=>{this.questions=this.essayQuestions.concat(this.mcQuestions),this.questions=this.questions.sort((s,i)=>.5-Math.random()),this.questions.length>this.settingsStore.quizMaxQuestions&&(this.questions.length=this.settingsStore.quizMaxQuestions),this.question=this.questions[0],this.totalNumOfQuestions=this.questions.length}).then(()=>{this.loading=!1})},Next(){this.questionNumber++,this.question=this.questions[this.questionNumber]},Previous(){this.questionNumber--,this.question=this.questions[this.questionNumber]},Submit(){for(let s=0;s<this.questions.length;s++)this.questions[s].questionType=="mc"?(this.numMCQuestions++,this.questions[s].userAnswer==1&&this.score++):this.numEssayQuestions++;if(this.numEssayQuestions===0)this.score/this.numMCQuestions*100>=90?(this.MakeMastered(this.skill),this.passModal=!0):this.failedModal=!0;else{const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({totalScore:this.totalNumOfQuestions,currentScore:this.score,numUnmarkedQuestions:this.numEssayQuestions})};var e="/assessments/"+this.userDetailsStore.userId+"/"+this.skillId;const i=()=>{this.waitForMarkModal=!0};fetch(e,s).then(function(h){return h.json()}).then(h=>{this.assessmentId=h.id,fetch("/unmarked-answers/delete/"+this.assessmentId,{method:"DELETE"}).then(()=>{for(let u=0;u<this.questions.length;u++)if(this.questions[u].questionType=="essay"){const r={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:this.questions[u].userAnswer,questionId:this.questions[u].id})};var l="/unmarked-answers/add/"+this.assessmentId;fetch(l,r).then(function(v){i()})}})})}},async MakeMastered(e){await this.userSkillsStore.MakeMastered(this.userDetailsStore.userId,e)},UserAnswer(){for(let e=0;e<this.questions.length;e++)if(this.questions[e].userAnswer==null){this.isAllQuestionsAnswered=!1;return}else this.isAllQuestionsAnswered=!0},TestPass(){this.MakeMastered(this.skillId)}}},c=e=>(p("data-v-4d2d45df"),e=e(),y(),e),N={key:0},L={key:1},T={key:0,class:"container mt-5 mb-3 p-3 pt-2 mb-3",id:"question-container"},C={class:"row"},$={class:"col d-flex my-2 gap-2 align-items-lg-center"},z={id:"question-number-div"},E={id:"question-content"},V={key:0},P={class:"form-check my-3"},j={class:"control control-checkbox"},D={class:"my-auto mx-2 me-4"},U=["value"],B=c(()=>t("div",{class:"control_indicator"},null,-1)),F={key:1},O={class:"form-group"},H={class:"mt-3 d-flex justify-content-end"},J={key:1,id:"question-content"},K={key:2},Y={id:"myModal",class:"modal"},G={class:"modal-content"},R=c(()=>t("div",{class:"d-flex align-content-center"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"50",height:"50",fill:"green"},[t("path",{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z"})]),t("div",{class:"my-auto ms-2"}," Well done! You have now mastered this skill. ")],-1)),W={class:"d-flex flex-row-reverse"},X={key:3},Z={id:"myModal",class:"modal"},ss={class:"modal-content"},ts=c(()=>t("div",{class:"d-flex align-content-center"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"red",width:"50",height:"50"},[t("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24V264c0 13.3-10.7 24-24 24s-24-10.7-24-24V152c0-13.3 10.7-24 24-24zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})]),t("div",{class:"my-auto ms-2"}," You Failed This Time, Try Again Later ! ")],-1)),es={class:"d-flex flex-row-reverse"},is={key:4},ns={id:"myModal",class:"modal"},os={class:"modal-content"},ls=c(()=>t("p",null," There is at least one question that needs to be marked manually. Please check whether you passed later. ",-1)),rs={class:"d-flex flex-row-reverse"};function us(e,s,i,h,l,u){return n(),o(m,null,[l.loading==!0?(n(),o("div",N,"Loading...")):a("",!0),l.loading==!1?(n(),o("div",L,[l.questions.length>0?(n(),o("div",T,[t("div",C,[t("div",$,[t("div",z,d(this.questionNumber+1),1),t("div",E,d(l.question.question),1)]),this.question.questionType=="mc"?(n(),o("div",V,[(n(!0),o(m,null,b(this.question.answerOptions,(r,v)=>(n(),o("div",P,[t("label",j,[t("span",D,d(r.option),1),_(t("input",{type:"radio",name:"nodeType",value:r.index,"onUpdate:modelValue":s[0]||(s[0]=g=>l.questions[this.questionNumber].userAnswer=g)},null,8,U),[[S,l.questions[this.questionNumber].userAnswer]]),B])]))),256))])):this.question.questionType=="essay"?(n(),o("div",F,[t("div",O,[_(t("textarea",{id:"essay-answer",onInput:s[1]||(s[1]=r=>u.UserAnswer()),class:"form-control","onUpdate:modelValue":s[2]||(s[2]=r=>l.questions[this.questionNumber].userAnswer=r),rows:"3"},null,544),[[w,l.questions[this.questionNumber].userAnswer]])])])):a("",!0)]),t("div",H,[this.questionNumber>0?(n(),o("button",{key:0,onClick:s[3]||(s[3]=r=>u.Previous()),class:"btn red-btn me-2"}," Previous ")):a("",!0),this.questionNumber!=l.questions.length-1?(n(),o("button",{key:1,onClick:s[4]||(s[4]=r=>u.Next()),class:"btn green-btn"}," Next ")):a("",!0),this.questionNumber==l.questions.length-1?(n(),o("button",{key:2,onClick:s[5]||(s[5]=r=>u.Submit()),class:"btn green-btn"}," Submit ")):a("",!0)])])):(n(),o("div",J," There is no quiz for this skill yet. Please check again soon. "))])):a("",!0),l.passModal?(n(),o("div",K,[t("div",Y,[t("div",G,[R,t("div",W,[t("button",{type:"button",class:"btn green-btn",onClick:s[6]||(s[6]=r=>this.$router.push("/skills/"+this.skillId))}," Great! ")])])])])):a("",!0),l.failedModal?(n(),o("div",X,[t("div",Z,[t("div",ss,[ts,t("div",es,[t("button",{type:"button",class:"btn red-btn",onClick:s[7]||(s[7]=r=>this.$router.push("/skills/"+this.skillId))}," OK ")])])])])):a("",!0),l.waitForMarkModal?(n(),o("div",is,[t("div",ns,[t("div",os,[ls,t("div",rs,[t("button",{type:"button",class:"btn green-btn",onClick:s[8]||(s[8]=r=>this.$router.push("/"))}," OK ")])])])])):a("",!0)],64)}const as=k(I,[["render",us],["__scopeId","data-v-4d2d45df"]]),hs="/images/skill-avatar/recurso.png";const ds={setup(){return{skillsStore:f()}},data(){return{skillId:this.$route.params.id,skill:{name:null,image:null,firstAncestorId:null,levelInHierarchy:null}}},async mounted(){this.skillsStore.skillsList.length==0&&await this.skillsStore.getSkillsList();for(let e=0;e<this.skillsStore.skillsList.length;e++)this.skillId==this.skillsStore.skillsList[e].id&&(this.skill.name=this.skillsStore.skillsList[e].name,this.skill.image=this.skillsStore.skillsList[e].image,this.skill.firstAncestorId=this.skillsStore.skillsList[e].first_ancestor,this.skill.levelInHierarchy=this.skillsStore.skillsList[e].hierarchy_level)},components:{Assessment:as}},cs=e=>(p("data-v-7e21eeff"),e=e(),y(),e),ms={id:"banner"},_s=["src"],ks={class:"container mt-3"},fs={class:"d-flex"},ps=["src"],ys={key:1,src:hs,alt:"default skill icon"},vs={class:"ms-3"},gs=cs(()=>t("div",{class:"mt-4 mb-4"},[t("hr",{class:"border border-2 opacity-100 w-75",id:"assessment-horizontal-line"})],-1));function qs(e,s,i,h,l,u){const r=Q("Assessment");return n(),o(m,null,[t("div",ms,[t("img",{src:"/images/banners/skills-banner.png",class:"img-fluid"},null,8,_s)]),t("div",ks,[t("div",fs,[this.skill.image?(n(),o("img",{key:0,src:this.skill.image},null,8,ps)):(n(),o("img",ys)),t("h1",vs,d(this.skill.name)+" Quiz",1)]),gs,M(r)])],64)}const Qs=k(ds,[["render",qs],["__scopeId","data-v-7e21eeff"]]);export{Qs as default};
