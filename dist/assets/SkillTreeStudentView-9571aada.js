import{S as fe,F as me,A as _e,h as we,G as M,T as U,C as ne}from"./fontfaceobserver.standalone-c6f1c176.js";import{_ as ye,e as ke,o as O,c as le,a as F,f as se,p as ge,b as xe,g as ve,h as te,S as Ie,F as Se}from"./main-7fa0580e.js";const be={setup(){},data(){return{userId:this.$route.params.id,firstLevelNodeRadius:36,otherLevelNodeRadius:17,firstLevelCircleRadius:300,nodeDistance:300,isSkillInfoPanelShown:!1}},components:{SkillPanel:fe},async mounted(){const n=await fetch("/user-skills/"+this.userId);this.userSkills=await n.json(),new me("Poppins900",{}).load().then(()=>{const c=document.getElementById("skilltree"),a=new _e({resizeTo:c,antialias:!0,useContextAlpha:!1});var m=window.getComputedStyle(document.getElementById("skilltree"),null),v=m.getPropertyValue("width"),W=m.getPropertyValue("height");const o=new we({screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:v,worldHeight:W,events:a.renderer.events});o.sortableChildren=!0,a.stage.addChild(o),o.drag().pinch().wheel().clampZoom({minScale:.2,maxScale:4}),c.appendChild(a.view);let N=new M;N.lineStyle(3,13162458,1),N.beginFill(16777215,1),N.drawCircle(window.innerWidth/2,window.innerHeight/2,65),N.endFill(),o.addChild(N);let I=new U("SKILLS",{fontFamily:"Poppins900",fontSize:90,fill:0,align:"center"});I.anchor.set(.5),I.x=window.innerWidth/2,I.y=window.innerHeight/2,I.scale.x=.2,I.scale.y=.2,o.addChild(I);var j=this.userSkills.length;for(let B=0;B<j;B++){let J=function(t,R,he,C,H,D,y){D++;let Q={depth:D,skills:[]};C=C+R.x,H=H+R.y;let X=300,Y=75,pe=17;for(let[u,d]of t.entries()){let e=new ne,b=0,G=0;for(let l=0;l<t.length;l++)t[l].type!="sub"?b++:G++;let k=0;if(d.type!="sub"){let l=0;D==1?l=135/b:l=90/b;let V=u-G;k=he+l*V,D==1?k=k-67.5+67.5/b:k=k-45+45/b;let z=k*Math.PI/180,L=e.x+X*Math.cos(z),A=e.y+X*Math.sin(z);e.x=e.x+L,e.y=e.y+A,Q.skills.push(e)}else{let l=360/G,V=u-b,L=l*V*Math.PI/180,A=e.x+Y*Math.cos(L),ue=e.y+Y*Math.sin(L);e.x=e.x+A,e.y=e.y+ue}let g=new M;var S;t[u].is_mastered==1?S="0x"+i.mastered_color:t[u].is_accessible==1?(g.lineStyle(1,"0x"+i.mastered_color,1),S="0x"+i.unlocked_color):S="0xD9D9D9",g.beginFill(S),g.drawCircle(0,0,pe),e.addChild(g);let ee=40;const ie=t[u].skill_name.split(" ");for(let l=0;l<ie.length;l++)ie[l].length>9&&(ee=37);t[u].skill_name=t[u].skill_name.replace(/(.*?\s)/g,`$1
`);let x=new U(t[u].skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:ee,fill:16777215,align:"center"});x.anchor.set(.5),x.scale.x=.1,x.scale.y=.1,e.addChild(x);let $={id:d.id,isMastered:d.is_mastered,isUnlocked:d.is_accessible,color:S,container:e,name:d.skill_name,description:d.description,tagIDs:[]};g.eventMode="static",x.eventMode="static",g.cursor="pointer",x.cursor="pointer",x.on("pointerdown",l=>{y.isSkillInfoPanelShown?y.updateInfoPanel($):y.showInfoPanel($)}),g.on("pointerdown",l=>{y.isSkillInfoPanelShown?y.updateInfoPanel($):y.showInfoPanel($)}),R.addChild(e);const P=new M;P.lineStyle(2,S,1),P.position.x=C,P.position.y=H,P.lineTo(e.x,e.y),P.zIndex=-1,o.addChild(P),Z.push(Q),d.children&&Array.isArray(d.children)&&d.children.length>0&&J(d.children,e,k,C,H,D,y)}},i=this.userSkills[B],h=new M;var _;i.is_mastered==1?_="0x"+i.mastered_color:i.is_accessible==1?(h.lineStyle(1,"0x"+i.mastered_color,1),_="0x"+i.unlocked_color):_="0xD9D9D9";var de=Math.PI*2/j,T=de*B,ae=65*Math.cos(T),oe=65*Math.sin(T);let r=new M;r.x=window.innerWidth/2+ae,r.y=window.innerHeight/2+oe,r.beginFill(_),r.drawCircle(0,0,7.5),o.addChild(r);var re=this.firstLevelCircleRadius*Math.cos(T),ce=this.firstLevelCircleRadius*Math.sin(T),s=new ne;s.x=window.innerWidth/2+re,s.y=window.innerHeight/2+ce,h.beginFill(_),h.drawCircle(0,0,this.firstLevelNodeRadius),h.endFill();const p=new M;p.lineStyle(2,_,1),p.position.x=s.x,p.position.y=s.y,p.lineTo(r.x-s.x,r.y-s.y),o.addChild(p),p.position.x,p.position.y,r.x-s.x,r.y-s.y;var q=60;const K=i.skill_name.split(" ");for(let t=0;t<K.length;t++)K[t].length>8&&(q=45);i.skill_name=i.skill_name.replace(/(.*?\s)/g,`$1
`);let w=new U(i.skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:q,fill:16777215,align:"center"});w.anchor.set(.5),w.scale.x=.2,w.scale.y=.2,s.addChild(h),s.addChild(w),o.addChild(s);let E={id:i.id,isMastered:i.is_mastered,isUnlocked:i.is_accessible,color:_,container:s,tagIDs:[],name:i.skill_name,description:i.description};h.eventMode="static",w.eventMode="static",h.cursor="pointer",w.cursor="pointer",h.on("pointerdown",t=>{this.isSkillInfoPanelShown?this.updateInfoPanel(E):this.showInfoPanel(E)}),w.on("pointerdown",t=>{this.isSkillInfoPanelShown?this.updateInfoPanel(E):this.showInfoPanel(E)});let Z=[];i.skill_name,J(i.children,s,T*60,0,0,0,this)}},()=>{console.log("Unable to load required font!")})},methods:{showInfoPanel(n){if(!this.isSkillInfoPanelShown){screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",document.getElementById("sidepanel-backdrop").style.display="block",this.isSkillInfoPanelShown=!0;var f=document.getElementById("skillHeading"),c=document.createTextNode(n.name);f.appendChild(c);var a=document.getElementById("skillDescription"),m=document.createTextNode(n.description);a.appendChild(m),n.isMastered=="1"&&(document.getElementById("skillIsMastered").checked=!0);var v=document.getElementById("skillLink");v.setAttribute("href","/skills/"+n.id)}},updateInfoPanel(n){if(this.isSkillInfoPanelShown){var f=document.getElementById("skillHeading");f.innerHTML="";var c=document.createTextNode(n.name);f.appendChild(c);var a=document.getElementById("skillDescription");a.innerHTML="";var m=document.createTextNode(n.description);a.appendChild(m),n.isMastered=="1"?document.getElementById("skillIsMastered").checked=!0:document.getElementById("skillIsMastered").checked=!1;var v=document.getElementById("skillLink");v.setAttribute("href","/skills/"+n.id)}}}},Pe=n=>(ge("data-v-c99b6f87"),n=n(),xe(),n),Me={class:"flex-container skill-tree-container"},Ne={id:"wrapper"},Te={id:"skilltree"},De=Pe(()=>F("div",{id:"sidepanel-backdrop"},null,-1));function Fe(n,f,c,a,m,v){const W=ke("SkillPanel");return O(),le("div",Me,[F("div",Ne,[F("div",Te,[se(W)]),De])])}const Be=ye(be,[["render",Fe],["__scopeId","data-v-c99b6f87"]]);const Ee=F("div",{id:"purple-banner"},null,-1),Ce=F("span",null,"Loading...",-1),Le={__name:"SkillTreeStudentView",setup(n){return(f,c)=>(O(),le(Se,null,[Ee,(O(),ve(Ie,null,{default:te(()=>[se(Be)]),fallback:te(()=>[Ce]),_:1}))],64))}};export{Le as default};
