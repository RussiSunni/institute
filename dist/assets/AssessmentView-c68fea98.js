import{_ as f,o as n,c as o,d as t,g as w,l as p,i as k,b as h,t as d,F as _,k as b,e as S,D as A,a as y,p as g,f as v}from"./main-cadc5ca7.js";import{u as M}from"./UserSkillsStore-23fcee12.js";import{u as Q}from"./SettingsStore-0fae0ae8.js";const x={data(){return{skillId:this.$route.params.id}},setup(){},mounted:function(){$("#summernote").summernote({placeholder:"write down your answer here",tabsize:2,height:120,toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],maximumImageFileSize:2048*1024,callbacks:{onImageUploadError:function(e){alert("Max image size is 2MB.")}}})},methods:{getAnswer(){return $("#summernote").summernote("code")},clearAnswer(){$("#summernote").summernote("code","")},setAnswer(e){$("#summernote").summernote("code",e)}}},I={class:"container mt-3"},N=t("div",{class:"row"},[t("div",{class:"mb-3"},[t("textarea",{id:"summernote",name:"answerdata"})])],-1),T=[N];function L(e,s,i,u,l,r){return n(),o("div",I,T)}const z=f(x,[["render",L]]);const C={setup(){const e=w(),s=M(),i=Q(),u=p();return{userDetailsStore:e,userSkillsStore:s,settingsStore:i,skillsStore:u}},data(){return{loading:!0,skillId:this.$route.params.id,skill:{},mcQuestions:[],essayQuestions:[],questions:[],question:{},questionNumber:0,score:0,assessmentId:null,numMCQuestions:0,numEssayQuestions:0,totalNumOfQuestions:0,isAllQuestionsAnswered:!1,passModal:!1,failedModal:!1,waitForMarkModal:!1}},mounted:function(){$(".summernote").summernote({placeholder:"this is the summer note",tabsize:2,height:120,toolbar:[["style",["style"]],["font",["bold","underline","clear"]],["color",["color"]],["para",["ul","ol","paragraph"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview","help"]]],maximumImageFileSize:2048*1024,callbacks:{onImageUploadError:function(e){alert("Max image size is 2MB.")}}})},async created(){this.settingsStore.quizMaxQuestions==null&&await this.settingsStore.getSettings();let e;for(let s=0;s<this.skillsStore.skillsList.length;s++)this.skillsStore.skillsList[s].id==this.skillId&&(e=this.skillsStore.skillsList[s].type,this.skill=this.skillsStore.skillsList[s]);if(e!="super")await this.fetchMCQuestions(this.skillId);else{let s=[];for(let i=0;i<this.skillsStore.skillsList.length;i++)this.skillsStore.skillsList[i].parent==this.skillId&&this.skillsStore.skillsList[i].type=="sub"&&s.push(this.skillsStore.skillsList[i]);for(let i=0;i<s.length;i++)await this.fetchMCQuestions(s[i].id)}},components:{EssayAnswer:z},methods:{async fetchMCQuestions(e){fetch("/questions/"+e+"/multiple-choice").then(function(s){return s.json()}).then(s=>{this.mcQuestions=this.mcQuestions.concat(s)}).then(()=>{for(let i=0;i<this.mcQuestions.length;i++)this.mcQuestions[i].userAnswer=null,this.mcQuestions[i].questionType="mc";for(let i=0;i<this.mcQuestions.length;i++){var s=[];s.push({option:this.mcQuestions[i].correct_answer,index:1}),s.push({option:this.mcQuestions[i].incorrect_answer_1,index:2}),s.push({option:this.mcQuestions[i].incorrect_answer_2,index:3}),s.push({option:this.mcQuestions[i].incorrect_answer_3,index:4}),s.push({option:this.mcQuestions[i].incorrect_answer_4,index:5}),s=s.sort((u,l)=>.5-Math.random()),this.mcQuestions[i].answerOptions=s}}).then(()=>{this.fetchEssayQuestions(e)})},async fetchEssayQuestions(e){fetch("/questions/"+e+"/essay").then(function(s){return s.json()}).then(s=>{this.essayQuestions=this.essayQuestions.concat(s)}).then(()=>{for(let s=0;s<this.essayQuestions.length;s++)this.essayQuestions[s].userAnswer=null,this.essayQuestions[s].questionType="essay"}).then(()=>{this.questions=this.essayQuestions.concat(this.mcQuestions),this.questions=this.questions.sort((s,i)=>.5-Math.random()),this.questions.length>this.settingsStore.quizMaxQuestions&&(this.questions.length=this.settingsStore.quizMaxQuestions),this.question=this.questions[0],this.totalNumOfQuestions=this.questions.length}).then(()=>{this.loading=!1})},Next(){if(this.question.questionType=="essay"){const e=this.$refs.essayAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=e,this.$refs.essayAnswer.clearAnswer()}this.questionNumber++,this.question=this.questions[this.questionNumber],this.question.questionType=="essay"&&this.question.userAnswer&&this.$refs.essayAnswer.setAnswer(this.question.userAnswer)},Previous(){if(this.question.questionType=="essay"){const e=this.$refs.essayAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=e}this.questionNumber--,this.question=this.questions[this.questionNumber],this.question.questionType=="essay"&&this.$refs.essayAnswer.setAnswer(this.question.userAnswer)},Submit(){if(this.question.questionType=="essay"){const s=this.$refs.essayAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=s}for(let s=0;s<this.questions.length;s++)this.questions[s].questionType=="mc"?(this.numMCQuestions++,this.questions[s].userAnswer==1&&this.score++):this.numEssayQuestions++;if(this.numEssayQuestions===0)this.score/this.numMCQuestions*100>=90?(this.MakeMastered(this.skill),this.passModal=!0):this.failedModal=!0;else{const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({totalScore:this.totalNumOfQuestions,currentScore:this.score,numUnmarkedQuestions:this.numEssayQuestions})};var e="/assessments/"+this.userDetailsStore.userId+"/"+this.skillId;const i=()=>{this.waitForMarkModal=!0};fetch(e,s).then(function(u){return u.json()}).then(u=>{this.assessmentId=u.id,fetch("/unmarked-answers/delete/"+this.assessmentId,{method:"DELETE"}).then(()=>{for(let r=0;r<this.questions.length;r++)if(this.questions[r].questionType=="essay"){const c={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:this.questions[r].userAnswer,questionId:this.questions[r].id})};var l="/unmarked-answers/add/"+this.assessmentId;fetch(l,c).then(function(a){i()})}})})}},async MakeMastered(e){await this.userSkillsStore.MakeMastered(this.userDetailsStore.userId,e)},UserAnswer(){for(let e=0;e<this.questions.length;e++)if(this.questions[e].userAnswer==null){this.isAllQuestionsAnswered=!1;return}else this.isAllQuestionsAnswered=!0},TestPass(){this.MakeMastered(this.skill)}}},m=e=>(g("data-v-a66c5542"),e=e(),v(),e),E={key:0},D={key:1},F={key:0,class:"container mt-5 mb-3 p-3 pt-2 mb-3",id:"question-container"},P={class:"row"},V={class:"col d-flex my-2 gap-2 align-items-lg-center"},B={id:"question-number-div"},U={id:"question-content"},j={key:0},O={class:"form-check my-3"},H={class:"control control-checkbox"},J={class:"my-auto mx-2 me-4"},K=["value"],Y=m(()=>t("div",{class:"control_indicator"},null,-1)),G={key:1},R={class:"form-group"},W={class:"mt-3 d-flex justify-content-end"},X={key:1,id:"question-content"},Z={key:2},ss={id:"myModal",class:"modal"},es={class:"modal-content"},ts=m(()=>t("div",{class:"d-flex align-content-center"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"50",height:"50",fill:"green"},[t("path",{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z"})]),t("div",{class:"my-auto ms-2"}," Well done! You have now mastered this skill. ")],-1)),is={class:"d-flex flex-row-reverse"},ns={key:3},os={id:"myModal",class:"modal"},ls={class:"modal-content"},rs=m(()=>t("div",{class:"d-flex align-content-center"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"red",width:"50",height:"50"},[t("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24V264c0 13.3-10.7 24-24 24s-24-10.7-24-24V152c0-13.3 10.7-24 24-24zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})]),t("div",{class:"my-auto ms-2"}," You Failed This Time, Try Again Later ! ")],-1)),us={class:"d-flex flex-row-reverse"},as={key:4},hs={id:"myModal",class:"modal"},cs={class:"modal-content"},ds=m(()=>t("p",null," There is at least one question that needs to be marked manually. Please check whether you passed later. ",-1)),ms={class:"d-flex flex-row-reverse"};function _s(e,s,i,u,l,r){const c=k("EssayAnswer");return n(),o(_,null,[l.loading==!0?(n(),o("div",E,"Loading...")):h("",!0),l.loading==!1?(n(),o("div",D,[l.questions.length>0?(n(),o("div",F,[t("div",P,[t("div",V,[t("div",B,d(this.questionNumber+1),1),t("div",U,d(l.question.question),1)]),this.question.questionType=="mc"?(n(),o("div",j,[(n(!0),o(_,null,b(this.question.answerOptions,(a,xs)=>(n(),o("div",O,[t("label",H,[t("span",J,d(a.option),1),S(t("input",{type:"radio",name:"nodeType",value:a.index,"onUpdate:modelValue":s[0]||(s[0]=q=>l.questions[this.questionNumber].userAnswer=q)},null,8,K),[[A,l.questions[this.questionNumber].userAnswer]]),Y])]))),256))])):this.question.questionType=="essay"?(n(),o("div",G,[t("div",R,[y(c,{ref:"essayAnswer"},null,512)])])):h("",!0)]),t("div",W,[this.questionNumber>0?(n(),o("button",{key:0,onClick:s[1]||(s[1]=a=>r.Previous()),class:"btn red-btn me-2"}," Previous ")):h("",!0),this.questionNumber!=l.questions.length-1?(n(),o("button",{key:1,onClick:s[2]||(s[2]=a=>r.Next()),class:"btn green-btn"}," Next ")):h("",!0),this.questionNumber==l.questions.length-1?(n(),o("button",{key:2,onClick:s[3]||(s[3]=a=>r.Submit()),class:"btn green-btn"}," Submit ")):h("",!0)])])):(n(),o("div",X," There is no quiz for this skill yet. Please check again soon. "))])):h("",!0),l.passModal?(n(),o("div",Z,[t("div",ss,[t("div",es,[ts,t("div",is,[t("button",{type:"button",class:"btn green-btn",onClick:s[4]||(s[4]=a=>this.$router.push("/skills/"+this.skillId))}," Great! ")])])])])):h("",!0),l.failedModal?(n(),o("div",ns,[t("div",os,[t("div",ls,[rs,t("div",us,[t("button",{type:"button",class:"btn red-btn",onClick:s[5]||(s[5]=a=>this.$router.push("/skills/"+this.skillId))}," OK ")])])])])):h("",!0),l.waitForMarkModal?(n(),o("div",as,[t("div",hs,[t("div",cs,[ds,t("div",ms,[t("button",{type:"button",class:"btn green-btn",onClick:s[6]||(s[6]=a=>this.$router.push("/"))}," OK ")])])])])):h("",!0)],64)}const fs=f(C,[["render",_s],["__scopeId","data-v-a66c5542"]]),ps="/images/skill-avatar/recurso.png";const ks={setup(){return{skillsStore:p()}},data(){return{skillId:this.$route.params.id,skill:{name:null,image:null,firstAncestorId:null,levelInHierarchy:null}}},async mounted(){this.skillsStore.skillsList.length==0&&await this.skillsStore.getSkillsList();for(let e=0;e<this.skillsStore.skillsList.length;e++)this.skillId==this.skillsStore.skillsList[e].id&&(this.skill.name=this.skillsStore.skillsList[e].name,this.skill.image=this.skillsStore.skillsList[e].image,this.skill.firstAncestorId=this.skillsStore.skillsList[e].first_ancestor,this.skill.levelInHierarchy=this.skillsStore.skillsList[e].hierarchy_level)},components:{Assessment:fs}},ys=e=>(g("data-v-7e21eeff"),e=e(),v(),e),gs={id:"banner"},vs=["src"],qs={class:"container mt-3"},ws={class:"d-flex"},bs=["src"],Ss={key:1,src:ps,alt:"default skill icon"},As={class:"ms-3"},Ms=ys(()=>t("div",{class:"mt-4 mb-4"},[t("hr",{class:"border border-2 opacity-100 w-75",id:"assessment-horizontal-line"})],-1));function Qs(e,s,i,u,l,r){const c=k("Assessment");return n(),o(_,null,[t("div",gs,[t("img",{src:"/images/banners/skills-banner.png",class:"img-fluid"},null,8,vs)]),t("div",qs,[t("div",ws,[this.skill.image?(n(),o("img",{key:0,src:this.skill.image},null,8,bs)):(n(),o("img",Ss)),t("h1",As,d(this.skill.name)+" Quiz",1)]),Ms,y(c)])],64)}const Ts=f(ks,[["render",Qs],["__scopeId","data-v-7e21eeff"]]);export{Ts as default};
