import{d as J,_ as H,o as b,c as I,F as V,r as q,a as S,w as W,v as Z,t as Q,b as G,p as X,e as Y,u as ee,P as te,S as f,G as ie,T as D,f as R,g as B,h as le,C as U,i as se,j,k as ne}from"./main-9e0353b4.js";import{u as re}from"./SkillTreeStore-b6b113bd.js";import{S as ae,h as oe}from"./fontfaceobserver.standalone-868a580a.js";const de=J("skillTags",{state:()=>({skillTagsList:[]}),actions:{async getSkillTagsList(){const t=await(await fetch("/skill-tags/list")).json();this.skillTagsList=t}}});const he={setup(){},data(){return{levels:[{id:"grade_school",name:"Grade school"},{id:"middle_school",name:"Middle school"},{id:"high_school",name:"High school"},{id:"college",name:"College"},{id:"phd",name:"PhD"}],checkedFilters:[],isFilterApplied:!1}},async created(){},async mounted(){},methods:{applyFilter:function(e){this.isFilterApplied=!0,this.$parent.filterSkills(e)}}},K=e=>(X("data-v-b4ceaabf"),e=e(),Y(),e),ce={id:"filters"},fe=K(()=>S("h1",{id:"filterMainHeader",class:"mb-2"},"My Skill Tree",-1)),ue={key:0},pe=K(()=>S("p",{class:"mb-2"},"Choose which level to filter out",-1)),me={class:"form-check"},ge=["value","onChange"],ke={class:"form-check-label",for:"flexCheckDefault"};function _e(e,t,s,o,h,r){return b(),I("div",ce,[fe,h.isFilterApplied==!1?(b(),I("div",ue,[pe,(b(!0),I(V,null,q(h.levels,d=>(b(),I("div",null,[S("div",me,[W(S("input",{class:"form-check-input",type:"radio",value:d.id,id:"flexCheckDefault","onUpdate:modelValue":t[0]||(t[0]=p=>h.checkedFilters=p),onChange:p=>r.applyFilter(d.id)},null,40,ge),[[Z,h.checkedFilters]]),S("label",ke,Q(d.name),1)])]))),256))])):G("",!0)])}const ye=H(he,[["render",_e],["__scopeId","data-v-b4ceaabf"]]);function Se(e){var t=0,s=e.children,o=s&&s.length;if(!o)t=1;else for(;--o>=0;)t+=s[o].value;e.value=t}function we(){return this.eachAfter(Se)}function ve(e,t){let s=-1;for(const o of this)e.call(t,o,++s,this);return this}function xe(e,t){for(var s=this,o=[s],h,r,d=-1;s=o.pop();)if(e.call(t,s,++d,this),h=s.children)for(r=h.length-1;r>=0;--r)o.push(h[r]);return this}function be(e,t){for(var s=this,o=[s],h=[],r,d,p,c=-1;s=o.pop();)if(h.push(s),r=s.children)for(d=0,p=r.length;d<p;++d)o.push(r[d]);for(;s=h.pop();)e.call(t,s,++c,this);return this}function Ie(e,t){let s=-1;for(const o of this)if(e.call(t,o,++s,this))return o}function Ae(e){return this.eachAfter(function(t){for(var s=+e(t.data)||0,o=t.children,h=o&&o.length;--h>=0;)s+=o[h].value;t.value=s})}function Te(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function Ce(e){for(var t=this,s=ze(t,e),o=[t];t!==s;)t=t.parent,o.push(t);for(var h=o.length;e!==s;)o.splice(h,0,e),e=e.parent;return o}function ze(e,t){if(e===t)return e;var s=e.ancestors(),o=t.ancestors(),h=null;for(e=s.pop(),t=o.pop();e===t;)h=e,e=s.pop(),t=o.pop();return h}function Ne(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Pe(){return Array.from(this)}function $e(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Be(){var e=this,t=[];return e.each(function(s){s!==e&&t.push({source:s.parent,target:s})}),t}function*Me(){var e=this,t,s=[e],o,h,r;do for(t=s.reverse(),s=[];e=t.pop();)if(yield e,o=e.children)for(h=0,r=o.length;h<r;++h)s.push(o[h]);while(s.length)}function M(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Ee)):t===void 0&&(t=Le);for(var s=new z(e),o,h=[s],r,d,p,c;o=h.pop();)if((d=t(o.data))&&(c=(d=Array.from(d)).length))for(o.children=d,p=c-1;p>=0;--p)h.push(r=d[p]=new z(d[p])),r.parent=o,r.depth=o.depth+1;return s.eachBefore(Re)}function Fe(){return M(this).eachBefore(De)}function Le(e){return e.children}function Ee(e){return Array.isArray(e)?e[1]:null}function De(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Re(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function z(e){this.data=e,this.depth=this.height=0,this.parent=null}z.prototype=M.prototype={constructor:z,count:we,each:ve,eachAfter:be,eachBefore:xe,find:Ie,sum:Ae,sort:Te,path:Ce,ancestors:Ne,descendants:Pe,leaves:$e,links:Be,copy:Fe,[Symbol.iterator]:Me};function Ue(e,t){return e.parent===t.parent?1:2}function P(e){var t=e.children;return t?t[0]:e.t}function $(e){var t=e.children;return t?t[t.length-1]:e.t}function je(e,t,s){var o=s/(t.i-e.i);t.c-=o,t.s+=s,e.c+=o,t.z+=s,t.m+=s}function He(e){for(var t=0,s=0,o=e.children,h=o.length,r;--h>=0;)r=o[h],r.z+=t,r.m+=t,t+=r.s+(s+=r.c)}function Ve(e,t,s){return e.a.parent===t.parent?e.a:s}function N(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}N.prototype=Object.create(z.prototype);function We(e){for(var t=new N(e,0),s,o=[t],h,r,d,p;s=o.pop();)if(r=s._.children)for(s.children=new Array(p=r.length),d=p-1;d>=0;--d)o.push(h=s.children[d]=new N(r[d],d)),h.parent=s;return(t.parent=new N(null,0)).children=[t],t}function Xe(){var e=Ue,t=1,s=1,o=null;function h(n){var u=We(n);if(u.eachAfter(r),u.parent.m=-u.z,u.eachBefore(d),o)n.eachBefore(c);else{var a=n,i=n,m=n;n.eachBefore(function(k){k.x<a.x&&(a=k),k.x>i.x&&(i=k),k.depth>m.depth&&(m=k)});var l=a===i?1:e(a,i)/2,g=l-a.x,v=t/(i.x+l+g),x=s/(m.depth||1);n.eachBefore(function(k){k.x=(k.x+g)*v,k.y=k.depth*x})}return n}function r(n){var u=n.children,a=n.parent.children,i=n.i?a[n.i-1]:null;if(u){He(n);var m=(u[0].z+u[u.length-1].z)/2;i?(n.z=i.z+e(n._,i._),n.m=n.z-m):n.z=m}else i&&(n.z=i.z+e(n._,i._));n.parent.A=p(n,i,n.parent.A||a[0])}function d(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function p(n,u,a){if(u){for(var i=n,m=n,l=u,g=i.parent.children[0],v=i.m,x=m.m,k=l.m,A=g.m,y;l=$(l),i=P(i),l&&i;)g=P(g),m=$(m),m.a=n,y=l.z+k-i.z-v+e(l._,i._),y>0&&(je(Ve(l,n,a),n,y),v+=y,x+=y),k+=l.m,v+=i.m,A+=g.m,x+=m.m;l&&!$(m)&&(m.t=l,m.m+=k-x),i&&!P(g)&&(g.t=i,g.m+=v-A,a=n)}return a}function c(n){n.x*=t,n.y=n.depth*s}return h.separation=function(n){return arguments.length?(e=n,h):e},h.size=function(n){return arguments.length?(o=!1,t=+n[0],s=+n[1],h):o?null:[t,s]},h.nodeSize=function(n){return arguments.length?(o=!0,t=+n[0],s=+n[1],h):o?[t,s]:null},h}function C(e,t,s){this.k=e,this.x=t,this.y=s}C.prototype={constructor:C,scale:function(e){return e===1?this:new C(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new C(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};C.prototype;const Ye={setup(){const e=ee(),t=re(),s=de();return{userDetailsStore:e,skillTreeStore:t,skillTagsStore:s}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,regularLockedUnmasteredNodeSprite:null,radius:0,width:null,height:null,radiusMultiplier:256,firstLevelNodeSize:100,regularNodeSize:50,subSkillRadius:50,skill:{id:null,children:[],isMastered:null,isUnlocked:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:ye,SkillPanel:ae},async mounted(){document.getElementById("reset-button").addEventListener("click",()=>{this.resetTree()}),this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills(),this.width=window.innerWidth,this.height=window.innerHeight,this.radius=Math.min(this.width,this.height)/2,document.querySelector("#skilltree").appendChild(this.$pixiApp.view);const e=new oe({screenWidth:this.width,screenHeight:this.height,worldWidth:this.width,worldHeight:this.height,events:this.$pixiApp.renderer.events});this.$pixiApp.stage.addChild(e),e.center=new te(0,0),e.drag().pinch().wheel().decelerate().clampZoom({minScale:.001,maxScale:10});const t=f.from("center-node.png");this.skill={name:"SKILLS",sprite:t,children:this.skillTreeStore.userSkills},this.getAlgorithm()},methods:{getAlgorithm(){var e=[];e=JSON.parse(JSON.stringify(this.skill.children));function t(a){for(var i=a.length;i--;)a[i].type=="sub"&&a.splice(i,1),typeof a[i]<"u"&&a[i].children&&Array.isArray(a[i].children)&&a[i].children.length>0&&t(a[i].children)}t(e);var s={name:null,children:e};const h=Xe().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((a,i)=>(a.parent==i.parent,1/a.depth))(M(s));var r=[];function d(a,i){for(let m=0;m<a.length;m++)a[m].type!="sub"&&r.push(a[m]),d(a[m].children)}d(e);let p=h.descendants().sort((a,i)=>a.data.id-i.data.id);for(let a=0;a<r.length;a++)r[a].x=p[a+1].x,r[a].y=p[a+1].y;console.log(p);for(var c=0;c<r.length;c++)if(r[c].children=[],r[c].parent!=null&&r[c].parent!=0){var n=r[c].parent;for(let a=0;a<r.length;a++)r[a].id==n&&r[a].children.push(r[c])}let u=[];for(var c=0;c<r.length;c++)(r[c].parent==null||r[c].parent==0)&&u.push(r[c]);this.skill.children=u,this.drawChart(h)},drawChart(e){for(let c=0;c<e.links().length;c++){const n=new ie;n.lineStyle(2,16777215,1);var t=Math.cos(e.links()[c].source.x)*e.links()[c].source.y,s=Math.sin(e.links()[c].source.x)*e.links()[c].source.y;n.moveTo(t,s);var o=Math.cos(e.links()[c].target.x)*e.links()[c].target.y,h=Math.sin(e.links()[c].target.x)*e.links()[c].target.y;n.lineTo(o,h),this.$pixiApp.stage.children[0].addChild(n),this.stageContents.push(n)}const r=this.skill.sprite;r.x=e.x,r.y=e.y,r.anchor.set(.5),this.isRecentered==!1?r.scale.set(.5):r.scale.set(1),this.$pixiApp.stage.children[0].addChild(r),this.stageContents.push(r);let d=new D(this.skill.name,{fontFamily:"Poppins900",fontSize:40,fill:0,align:"center"});d.anchor.set(.5),d.x=e.x,d.y=e.y,d.scale.x=.2,d.scale.y=.2,this.$pixiApp.stage.children[0].addChild(d),this.stageContents.push(d);function p(c,n,u,a){u++;for(let[m,l]of n.entries()){let g=new U;g.x=Math.cos(l.x)*l.y,g.y=Math.sin(l.x)*l.y;var i=new f;l.level=="grade_school"?l.is_mastered?i=f.from("images/skill-tree-nodes/grade-school-mastered.png"):l.is_accessible?i=f.from("images/skill-tree-nodes/grade-school-unlocked.png"):i=f.from("images/skill-tree-nodes/grade-school-locked.png"):l.level=="middle_school"?l.is_mastered?i=f.from("images/skill-tree-nodes/middle-school-mastered.png"):l.is_accessible?i=f.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=f.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="high_school"?l.is_mastered?i=f.from("images/skill-tree-nodes/high-school-mastered.png"):l.is_accessible?i=f.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=f.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="college"?l.is_mastered?i=f.from("images/skill-tree-nodes/college-mastered.png"):l.is_accessible?i=f.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=f.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="phd"?l.is_mastered?i=f.from("images/skill-tree-nodes/phd-mastered.png"):l.is_accessible?i=f.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=f.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="domain"&&(i=f.from("images/skill-tree-nodes/domain.png"));let v=0,x=0;for(let _=0;_<l.children.length;_++)l.children[_].type!="sub"?v++:x++;u==1?(i.width=a.firstLevelNodeSize,i.height=a.firstLevelNodeSize):(i.width=a.regularNodeSize,i.height=a.regularNodeSize),i.anchor.set(.5),g.addChild(i);let k=40;const A=l.skill_name.split(" ");for(let _=0;_<A.length;_++)A[_].length>9&&(k=30);l.skill_name=l.skill_name.replace(/(.*?\s)/g,`$1
`);let y=new D(l.skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:k,fill:16777215,align:"center"});y.anchor.set(.5),y.scale.x=.2,y.scale.y=.2,g.addChild(y),i.eventMode="static",y.eventMode="static",i.cursor="pointer",y.cursor="pointer",y.on("pointerdown",_=>{var w={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:g,name:l.skill_name,description:l.description,tagIDs:[],sprite:i};if(a.skill=w,!a.isSkillInfoPanelShown){let T=function(){a.recenterTree()};a.skill=w,a.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",T)}}),i.on("pointerdown",_=>{var w={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:g,name:l.skill_name,description:l.description,tagIDs:[],sprite:i};if(a.skill=w,!a.isSkillInfoPanelShown){let T=function(){a.recenterTree()};a.skill=w,a.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",T)}}),a.$pixiApp.stage.children[0].addChild(g),a.stageContents.push(g);for(let _=0;_<l.children.length;_++)if(l.children[_].type=="sub"){let w=new U,T=360/x,O=_-v,F=T*O*Math.PI/180,L,E;L=a.subSkillRadius*Math.cos(F),E=a.subSkillRadius*Math.sin(F),w.x=L,w.y=E;var i=new f;l.level=="grade_school"?l.is_mastered?i=f.from("images/skill-tree-nodes/grade-school-small-mastered.png"):l.is_accessible?i=f.from("images/skill-tree-nodes/grade-school-small-unlocked.png"):i=f.from("images/skill-tree-nodes/grade-school-small-locked.png"):l.level=="middle_school"?l.is_mastered?i=f.from("images/skill-tree-nodes/middle-school-small-mastered.png"):l.is_accessible?i=f.from("images/skill-tree-nodes/middle-school-small-unlocked.png"):i=f.from("images/skill-tree-nodes/middle-school-small-locked.png"):l.level=="high_school"?l.is_mastered?i=f.from("images/skill-tree-nodes/high-school-small-mastered.png"):l.is_accessible?i=f.from("images/skill-tree-nodes/high-school-small-unlocked.png"):i=f.from("images/skill-tree-nodes/high-school-small-locked.png"):l.level=="college"?l.is_mastered?i=f.from("images/skill-tree-nodes/college-smal-mastered.png"):l.is_accessible?i=f.from("images/skill-tree-nodes/college-small-unlocked.png"):i=f.from("images/skill-tree-nodes/college-small-locked.png"):l.level=="phd"&&(l.is_mastered?i=f.from("images/skill-tree-nodes/phd-small-mastered.png"):l.is_accessible?i=f.from("images/skill-tree-nodes/phd-small-unlocked.png"):i=f.from("images/skill-tree-nodes/phd-small-locked.png")),i.width=15,i.height=15,i.anchor.set(.5),w.addChild(i),g.addChild(w)}l.children&&Array.isArray(l.children)&&l.children.length>0&&p(c,l.children,u,a)}}p(e.children,this.skill.children,0,this)},recenterTree(){this.isRecentered=!0,this.radiusMultiplier=1;for(let e=0;e<this.stageContents.length;e++)this.stageContents[e].destroy();this.hideInfoPanel(),this.getAlgorithm()},resetTree(){this.isRecentered=!1,this.radiusMultiplier=4,this.$pixiApp.stage.children[0].removeChildren();const e=f.from("center-node.png");this.skill={name:"SKILLS",sprite:e,children:this.skillTreeStore.userSkills},this.getAlgorithm()},showInfoPanel(){this.isSkillInfoPanelShown||(screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",document.getElementById("sidepanel-backdrop").style.display="block",this.isSkillInfoPanelShown=!0,document.getElementById("skillDescription"),document.getElementById("skillLink"))},hideInfoPanel(){this.isSkillInfoPanelShown&&(screen.width>800?document.getElementById("skillInfoPanel").style.width="0px":document.getElementById("skillInfoPanel").style.height="0px",document.getElementById("sidepanel-backdrop").style.display="none",this.isSkillInfoPanelShown=!1)},async filterSkills(e){var t=[];function s(n,u){for(let a=0;a<n.length;a++)t.push(n[a]),s(n[a].children)}s(this.skill.children);var o=0;for(let n=0;n<t.length;n++){let u=t[n];h(u,u.parent,e),t[n].parent=o}function h(n,u,a,i){for(let m=0;m<t.length;m++)if(t[m].id==u){let l=t[m];l.level==a?(o=l.parent,h(n,o,a)):o=l.id}}let r=[];for(var d=0;d<t.length;d++)t[d].level!=e&&r.push(t[d]);for(var d=0;d<r.length;d++)if(r[d].children=[],r[d].parent!=null&&r[d].parent!=0){var p=r[d].parent;for(let u=0;u<r.length;u++)r[u].id==p&&r[u].children.push(r[d])}let c=[];for(var d=0;d<r.length;d++)(r[d].parent==null||r[d].parent==0)&&c.push(r[d]);this.skill.children=c;for(let n=0;n<this.stageContents.length;n++)this.stageContents[n].destroy();this.applyFilter()},applyFilter(){this.$pixiApp.stage.children[0].removeChildren();const e=f.from("center-node.png");this.skill={name:"SKILLS",sprite:e,children:this.skill.children},this.getAlgorithm()}}},Ke=e=>(X("data-v-17205d45"),e=e(),Y(),e),Oe={class:"flex-container skill-tree-container"},Je={id:"reset-button",class:"btn btn-info"},qe={id:"wrapper"},Ze={id:"skilltree"},Qe=Ke(()=>S("div",{id:"sidepanel-backdrop"},null,-1));function Ge(e,t,s,o,h,r){const d=R("SkillTreeFilter"),p=R("SkillPanel");return b(),I("div",Oe,[B(d,{id:"filter"}),W(S("button",Je,"Reset",512),[[le,h.isRecentered]]),S("div",qe,[S("div",Ze,[B(p,{skill:h.skill},null,8,["skill"])]),Qe])])}const et=H(Ye,[["render",Ge],["__scopeId","data-v-17205d45"]]);const tt=S("div",{id:"purple-banner"},null,-1),it=S("span",null,"Loading...",-1),at={__name:"SkillTreeView",setup(e){return(t,s)=>(b(),I(V,null,[tt,(b(),se(ne,null,{default:j(()=>[B(et)]),fallback:j(()=>[it]),_:1}))],64))}};export{at as default};
