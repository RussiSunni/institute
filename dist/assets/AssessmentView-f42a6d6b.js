import{_ as M,o as n,c as o,b as t,w as p,x as v,K as L,a as c,F as w,y as k,l as F,D as V,u as $,r as y,h as S,i as C,m as x,C as g,t as m,p as R,e as z,f as E,d as Q}from"./main-17189971.js";import{u as U}from"./SettingsStore-4cc748ef.js";import{u as j}from"./AssessmentsStore-9f25a8aa.js";import{F as D}from"./FlagModals-fc186034.js";const B={data(){return{skillId:this.$route.params.id,essayAnswer:""}},setup(){},methods:{getAnswer(){return this.essayAnswer},clearAnswer(){this.essayAnswer=""},setAnswer(i){this.essayAnswer=i}}},O={class:"container mt-3"},W={class:"row"},Y={class:"mb-3"};function H(i,e,r,l,s,u){return n(),o("div",O,[t("div",W,[t("div",Y,[p(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=h=>s.essayAnswer=h),class:"form-control",id:"exampleFormControlTextarea1",rows:"3"},null,512),[[v,s.essayAnswer]])])])])}const J=M(B,[["render",H]]);const K={data(){return{skillId:this.$route.params.id,imageAnswer:[],answerType:"link"}},props:["numImagesRequired"],setup(){},mounted(){},methods:{getAnswer(){return this.imageAnswer},clearAnswer(){this.imageAnswer=[]},setAnswer(i){this.imageAnswer=i},onFileChange(i){var e=i.target.files||i.dataTransfer.files;if(e.length>0)for(var r=0;r<e.length;r++){var l=new FileReader;l.readAsDataURL(e[r])}if(e.length)for(let s=0;s<e.length;s++){if(console.log(e[s].size),e[s].size>7e5){alert("image is too big");return}this.createImage(e[s],s)}},createImage(i,e){var r=new Image,l=new FileReader,s=this;l.onload=u=>{s.image=u.target.result,this.imageAnswer.push(u.target.result),r.src=u.target.result,console.log(this.imageAnswer)},l.readAsDataURL(i)},removeImages:function(i){this.imageAnswer=[],console.log(this.imageAnswer)}}},G={class:"mb-3"},X={key:0},Z=t("label",{for:"upload"},"upload",-1),ss=t("br",null,null,-1),es=t("label",{for:"link"},"link",-1),ts={class:"main-content-container container-fluid"},is={class:"row"},ns={class:"col-lg-4"},os={key:0,class:"mb-3 row"},rs=t("p",{style:{"font-size":"14px"}},[t("em",null,"Maximum file size 700kb")],-1),ls={key:1},as=["onUpdate:modelValue"],us={class:"preview"},cs=["src"];function ds(i,e,r,l,s,u){return n(),o("div",G,[t("div",null,[r.numImagesRequired==1?(n(),o("p",X,[p(t("input",{type:"radio",id:"upload",value:"upload","onUpdate:modelValue":e[0]||(e[0]=h=>s.answerType=h)},null,512),[[L,s.answerType]]),Z,ss,p(t("input",{type:"radio",id:"link",value:"link","onUpdate:modelValue":e[1]||(e[1]=h=>s.answerType=h)},null,512),[[L,s.answerType]]),es])):c("",!0)]),t("div",ts,[t("div",is,[t("div",ns,[s.answerType=="upload"?(n(),o("div",os,[t("input",{type:"file",id:"file-input",accept:"image/jpeg, image/png, image/jpg, image/webp",onChange:e[2]||(e[2]=(...h)=>u.onFileChange&&u.onFileChange(...h))},null,32),rs])):(n(),o("div",ls,[(n(!0),o(w,null,k(r.numImagesRequired,(h,a)=>p((n(),o("input",{class:"form-control mb-2","onUpdate:modelValue":d=>s.imageAnswer[a]=d,placeholder:"add image link"},null,8,as)),[[v,s.imageAnswer[a]]])),256))])),(n(!0),o(w,null,k(s.imageAnswer.length,(h,a)=>(n(),o("div",us,[t("img",{src:s.imageAnswer[a]},null,8,cs)]))),256))])]),s.imageAnswer.length>0?(n(),o("button",{key:0,class:"btn red-btn mt-3",onClick:e[3]||(e[3]=(...h)=>u.removeImages&&u.removeImages(...h))}," Start again ")):c("",!0)])])}const hs=M(K,[["render",ds]]);const ms={setup(){const i=F(),e=V(),r=$();return{userDetailsStore:i,userSkillsStore:e,skillTreeStore:r}},data(){return{skillId:this.$route.params.id,question:{question:"",correctAnswer:"",incorrectAnswer1:"",incorrectAnswer2:"",incorrectAnswer3:"",incorrectAnswer4:"",question:"",explanation:""},validate:{validated:!1,question:!1,correctAnswer:!1,incorrectAnswer1:!1,incorrectAnswer2:!1,incorrectAnswer3:!1,incorrectAnswer4:!1,explanation:!1},studentId:null,reshake:!1,questionAddedModal:!1,questionSubmitted:!1,submittedMess:!1}},async mounted(){},methods:{Submit(){if(this.studentId=this.userDetailsStore.userId,this.validate.validated=!1,(this.question.question===""||this.question.question===null)&&(this.validate.question=!0,this.validate.validated=!0),(this.question.correctAnswer===""||this.question.correctAnswer===null)&&(this.validate.correctAnswer=!0,this.validate.validated=!0),(this.question.incorrectAnswer1===""||this.question.incorrectAnswer1===null)&&(this.validate.incorrectAnswer1=!0,this.validate.validated=!0),(this.question.incorrectAnswer2===""||this.question.incorrectAnswer2===null)&&(this.validate.incorrectAnswer2=!0,this.validate.validated=!0),(this.question.incorrectAnswer3===""||this.question.incorrectAnswer3===null)&&(this.validate.incorrectAnswer3=!0,this.validate.validated=!0),(this.question.incorrectAnswer4===""||this.question.incorrectAnswer4===null)&&(this.validate.incorrectAnswer4=!0,this.validate.validated=!0),(this.question.explanation===""||this.question.explanation===null)&&(this.validate.explanation=!0,this.validate.validated=!0),this.validate.validated){this.reshake=!0;return}const i={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:this.question.question,correct_answer:this.question.correctAnswer,incorrect_answer_1:this.question.incorrectAnswer1,incorrect_answer_2:this.question.incorrectAnswer2,incorrect_answer_3:this.question.incorrectAnswer3,incorrect_answer_4:this.question.incorrectAnswer4,explanation:this.question.explanation,skill_id:this.skillId,student_id:this.studentId})};var e="/questions/student-mc-questions/add";fetch(e,i).then(()=>{this.questionAddedModal=!0,this.questionSubmitted=!0,window.scrollTo(0,0)})},showSubmittedMess(){this.submittedMess=!0,setTimeout(()=>{this.submittedMess=!1},2e3)},skipAddingQuestion(){this.questionSubmitted=!0,window.scrollTo(0,0)}}},_s={class:"student-add-result pb-3 w-100"},fs={class:"main-content-container container-fluid"},gs={class:"row p-0"},ps={key:1,id:"form-container",class:"col p-4"},ws={key:0,class:"d-flex flex-column"},vs=t("div",{id:"congrats-tile"}," Well done, you have passed! ",-1),ys=t("p",null," Would you like to add your own question on this subject? ",-1),qs=[vs,ys],ks={key:1,class:"d-flex flex-column shake"},bs=t("div",{id:"congrats-tile"}," Thank you for submitting your question. ",-1),As=[bs],xs={class:"mb-3"},Ss=t("label",{for:"last_name",class:"form-label"},"Question",-1),Ms={class:"mb-3"},Is=t("label",{class:"form-label"},"Correct answer",-1),Ts={class:"mb-3"},Qs=t("label",{class:"form-label"},"Wrong answer 1",-1),Cs={class:"mb-3"},Ns=t("label",{class:"form-label"},"Wrong answer 2",-1),Ls={class:"mb-3"},Fs=t("label",{class:"form-label"},"Wrong answer 3",-1),Rs={class:"mb-3"},zs=t("label",{class:"form-label"},"Wrong answer 4",-1),Vs={class:"mb-3"},$s=t("label",{class:"form-label"},"Explanation",-1),Es={class:"d-flex justify-content-end gap-4"},Ds={key:2,class:"form-validate shake"},Ps={key:0},Us={id:"myModal",class:"modal"},js={class:"modal-content"},Bs=t("div",{class:"d-flex align-content-center"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"50",height:"50",fill:"green"},[t("path",{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z"})]),t("div",{class:"my-auto ms-2"}," Your question have been submitted ")],-1),Os={class:"d-flex flex-row-reverse"};function Ws(i,e,r,l,s,u){const h=y("RouterLink");return n(),o(w,null,[t("div",_s,[t("div",fs,[t("div",gs,[s.questionSubmitted?(n(),S(h,{key:0,class:"btn btn-light purple-btn",style:{width:"136px"},to:"/skills"},{default:C(()=>[x(" Back to skills ")]),_:1})):c("",!0),s.questionSubmitted?c("",!0):(n(),o("div",ps,[s.questionSubmitted?c("",!0):(n(),o("div",ws,qs)),s.questionSubmitted?(n(),o("div",ks,As)):c("",!0),t("div",xs,[Ss,p(t("textarea",{"onUpdate:modelValue":e[0]||(e[0]=a=>s.question.question=a),rows:"1",class:"form-control"},`\r
                        `,512),[[v,s.question.question]]),s.validate.question&&(s.question.question===""||s.question.question===null)?(n(),o("div",{key:0,class:g(["form-validate",{shake:s.reshake}]),onAnimationend:e[1]||(e[1]=a=>s.reshake=!1)}," please enter a question content ! ",34)):c("",!0)]),t("div",Ms,[Is,p(t("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>s.question.correctAnswer=a),type:"text",class:"form-control"},null,512),[[v,s.question.correctAnswer]]),s.validate.correctAnswer&&(s.question.correctAnswer===""||s.question.correctAnswer===null)?(n(),o("div",{key:0,class:g(["form-validate",{shake:s.reshake}]),onAnimationend:e[3]||(e[3]=a=>s.reshake=!1)}," please enter a correct answer ! ",34)):c("",!0)]),t("div",Ts,[Qs,p(t("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>s.question.incorrectAnswer1=a),type:"text",class:"form-control"},null,512),[[v,s.question.incorrectAnswer1]]),s.validate.incorrectAnswer1&&(s.question.incorrectAnswer1===""||s.question.incorrectAnswer1===null)?(n(),o("div",{key:0,class:g(["form-validate",{shake:s.reshake}]),onAnimationend:e[5]||(e[5]=a=>s.reshake=!1)}," please enter incorrect answer 1 ! ",34)):c("",!0)]),t("div",Cs,[Ns,p(t("input",{"onUpdate:modelValue":e[6]||(e[6]=a=>s.question.incorrectAnswer2=a),type:"text",class:"form-control"},null,512),[[v,s.question.incorrectAnswer2]]),s.validate.incorrectAnswer2&&(s.question.incorrectAnswer2===""||s.question.incorrectAnswer2===null)?(n(),o("div",{key:0,class:g(["form-validate",{shake:s.reshake}]),onAnimationend:e[7]||(e[7]=a=>s.reshake=!1)}," please enter incorrect answer 2 ! ",34)):c("",!0)]),t("div",Ls,[Fs,p(t("input",{"onUpdate:modelValue":e[8]||(e[8]=a=>s.question.incorrectAnswer3=a),type:"text",class:"form-control"},null,512),[[v,s.question.incorrectAnswer3]]),s.validate.incorrectAnswer3&&(s.question.incorrectAnswer3===""||s.question.incorrectAnswer3===null)?(n(),o("div",{key:0,class:g(["form-validate",{shake:s.reshake}]),onAnimationend:e[9]||(e[9]=a=>s.reshake=!1)}," please enter incorrect answer 3 ! ",34)):c("",!0)]),t("div",Rs,[zs,p(t("input",{"onUpdate:modelValue":e[10]||(e[10]=a=>s.question.incorrectAnswer4=a),type:"text",class:"form-control"},null,512),[[v,s.question.incorrectAnswer4]]),s.validate.incorrectAnswer4&&(s.question.incorrectAnswer4===""||s.question.incorrectAnswer4===null)?(n(),o("div",{key:0,class:g(["form-validate  ",{shake:s.reshake}]),onAnimationend:e[11]||(e[11]=a=>s.reshake=!1)}," please enter incorrect answer 4 ! ",34)):c("",!0)]),t("div",Vs,[$s,p(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=a=>s.question.explanation=a),class:"form-control",rows:"3"},null,512),[[v,s.question.explanation]]),s.validate.explanation&&(s.question.explanation===""||s.question.explanation===null)?(n(),o("div",{key:0,class:g(["form-validate ",{shake:s.reshake}]),onAnimationend:e[13]||(e[13]=a=>s.reshake=!1)}," please enter a explanation ! ",34)):c("",!0)]),t("div",Es,[t("button",{class:"btn btn-light",onClick:e[14]||(e[14]=(...a)=>u.skipAddingQuestion&&u.skipAddingQuestion(...a))}," Skip "),t("button",{class:"btn purple-btn",onClick:e[15]||(e[15]=a=>s.questionSubmitted?u.showSubmittedMess():u.Submit())}," Submit ")]),s.submittedMess?(n(),o("div",Ds," You already submitted a question !! ")):c("",!0)]))])])]),s.questionAddedModal?(n(),o("div",Ps,[t("div",Us,[t("div",js,[Bs,t("div",Os,[t("button",{type:"button",class:"btn green-btn",onClick:e[16]||(e[16]=a=>s.questionAddedModal=!1)}," ok "),s.questionSubmitted?(n(),S(h,{key:0,class:"btn btn-light purple-btn mx-2",to:"/skills"},{default:C(()=>[x(" Back to skills ")]),_:1})):c("",!0)])])])])):c("",!0)],64)}const P=M(ms,[["render",Ws]]);const Ys={setup(){return{userDetailsStore:F()}},components:{StudentAddMCQuestion:P,FlagModals:D},data(){return{assessmentResult:"",finishDate:"",finishTime:"",parent:"",score:0,totalScore:1,scorePercent:0,questions:[],essayQuestionsLength:0,correctIndex:[],passModal:!1,failsModal:!1,waitForMarkModal:!1,questionToFlagId:0,questionToFlagType:"",showFlaggingModal:!1}},props:["skill","isManualEssayMarking"],mounted(){switch(this.assessmentResult=this.$parent.assessmentStatus,this.assessmentResult){case"pass":this.passModal=!0;break;case"fails":this.failsModal=!0;break;case"wait for essay answers to be mark":this.waitForMarkModal=!0;break}this.finishDate=this.$parent.finishTime.toLocaleString(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric"}),this.finishTime=this.$parent.finishTime.toLocaleTimeString(),this.score=this.$parent.score,this.isManualEssayMarking==1?this.totalScore=this.$parent.numMCQuestions:this.totalScore=this.$parent.questions.length,this.totalScore!==0&&(this.scorePercent=Math.floor(this.score/this.totalScore*100)),this.isManualEssayMarking==1?(this.questions=this.$parent.questions.filter(i=>i.questionType==="mc"),this.essayQuestionsLength=this.$parent.questions.length-this.questions.length):this.questions=this.$parent.questions,this.correctIndex=[1]},methods:{setQuestionForFlagging(i,e){this.questionToFlagId=i,this.questionToFlagType=e,this.showFlaggingModal=!0}}},f=i=>(R("data-v-ee14c537"),i=i(),z(),i),Hs={class:"container mt-3 pb-3"},Js=f(()=>t("div",{class:"page-tile"},"Assessment Result",-1)),Ks={class:"d-flex flex-md-row flex-column gap-3"},Gs={class:"assessment-info"},Xs=f(()=>t("span",{class:"info-label"},"Result:",-1)),Zs={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 512",fill:"red",height:"14",width:"14",class:"status-icon"},se=f(()=>t("path",{d:"M64 64c0-17.7-14.3-32-32-32S0 46.3 0 64V320c0 17.7 14.3 32 32 32s32-14.3 32-32V64zM32 480a40 40 0 1 0 0-80 40 40 0 1 0 0 80z"},null,-1)),ee=[se],te={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",fill:"green",height:"14",width:"14",class:"mb-1"},ie=f(()=>t("path",{d:"M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"},null,-1)),ne=[ie],oe=f(()=>t("span",{class:"info-label"},"Finish Date: ",-1)),re={class:"info-value"},le={id:"finish-time"},ae={class:"hover-cursor","b-on-hover":"",title:"you need to score above 80% to pass the assessment"},ue=f(()=>t("span",{class:"info-label"},"Score: ",-1)),ce={class:"info-value"},de=f(()=>t("span",null,"*",-1)),he={key:0,class:"essay-warning"},me={class:"mc-question-result"},_e=["onClick"],fe={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",style:{height:"22px",opacity:"0.5"}},ge=f(()=>t("path",{fill:"#8f7bd6",d:"M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"},null,-1)),pe=[ge],we={class:"question"},ve={class:"d-flex flex-column"},ye={class:"form-check my-3"},qe={class:"control control-checkbox"},ke={key:0,class:"correct-indicate"},be={key:1,class:"user-answer-indicate"},Ae={key:2,class:"correct-indicate"},xe=["value","disabled"],Se={class:"control_indicator"},Me={key:0,class:"checked"},Ie={key:1},Te=f(()=>t("span",{class:"explain-label"},"Your answer:",-1)),Qe={class:"explain-text"},Ce={key:2},Ne=f(()=>t("span",{class:"explain-label"},"Your answer:",-1)),Le=["src"],Fe={key:3,class:"explain-answer"},Re=f(()=>t("div",{class:"explain-label"},"Explanation:",-1)),ze={class:"explain-text"},Ve={key:0},$e={id:"myModal",class:"modal"},Ee={class:"modal-content"},De=f(()=>t("div",{class:"d-flex align-content-center"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",width:"50",height:"50",fill:"green"},[t("path",{d:"M256 48a208 208 0 1 1 0 416 208 208 0 1 1 0-416zm0 464A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM369 209c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-111 111-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l64 64c9.4 9.4 24.6 9.4 33.9 0L369 209z"})]),t("div",{class:"my-auto ms-2"}," Well done! You passed and have now mastered the skill! ")],-1)),Pe={class:"d-flex flex-row-reverse"},Ue={key:1},je={id:"myModal",class:"modal"},Be={class:"modal-content"},Oe=f(()=>t("div",{class:"d-flex align-content-center"},[t("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",fill:"red",width:"50",height:"50"},[t("path",{d:"M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24V264c0 13.3-10.7 24-24 24s-24-10.7-24-24V152c0-13.3 10.7-24 24-24zM224 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"})]),t("div",{class:"my-auto ms-2"}," You failed this time, try again later! ")],-1)),We={class:"d-flex flex-row-reverse"},Ye={key:2},He={id:"myModal",class:"modal"},Je={class:"modal-content"},Ke=f(()=>t("div",null," There is at least one question that needs to be marked by your instructor. Please check whether you passed later. ",-1)),Ge={class:"d-flex flex-row-reverse"};function Xe(i,e,r,l,s,u){const h=y("StudentAddMCQuestion"),a=y("FlagModals");return n(),o(w,null,[t("div",Hs,[Js,t("div",Ks,[t("div",Gs,[t("div",null,[Xs,t("span",{class:g(s.assessmentResult=="pass"?"student-pass":"student-fail")},[x(m(s.assessmentResult)+" ",1),s.assessmentResult==="failed"?(n(),o("svg",Zs,ee)):c("",!0),s.assessmentResult==="pass"?(n(),o("svg",te,ne)):c("",!0)],2)]),t("div",null,[oe,t("span",re,[x(m(s.finishDate)+" ",1),t("span",le," at "+m(s.finishTime),1)])]),t("div",ae,[ue,t("span",ce,m(s.score)+" out "+m(s.totalScore),1),x(" ( "+m(s.scorePercent)+"%) ",1),de]),r.isManualEssayMarking==1&&s.essayQuestionsLength!=0?(n(),o("div",he," There are "+m(s.essayQuestionsLength)+" answers that needed to be mark by your instructor ",1)):c("",!0)]),s.assessmentResult==="pass"?(n(),S(h,{key:0})):c("",!0)]),(n(!0),o(w,null,k(s.questions,d=>(n(),o("div",me,[d.questionType=="mc"?(n(),o("div",{key:0,"b-tooltip.hover":"",title:"flag this question for review",onClick:_=>u.setQuestionForFlagging(d.id,"mc_question"),class:"flagging-icon",style:{height:"50px"}},[(n(),o("svg",fe,pe))],8,_e)):c("",!0),t("div",{class:g(d.userAnswer===1||d.isCorrect==!0?"correct-label":"wrong-label")},m(d.userAnswer===1||d.isCorrect==!0?"Correct !!":"Incorrect !!"),3),t("div",we,m(d.question),1),t("div",ve,[d.questionType=="mc"?(n(!0),o(w,{key:0},k(d.answerOptions,(_,b)=>(n(),o("div",ye,[t("label",qe,[t("div",{class:g(["my-auto mx-2 me-4 answer-option ",_.index==1?" correct-answer":d.userAnswer==_.index?"user-answer":" incorrect-answer"])},[x(m(_.option)+" ",1),_.index==1&&d.userAnswer!==1?(n(),o("span",ke," (correct answer)")):c("",!0),_.index!==1&&d.userAnswer==_.index?(n(),o("span",be," (your answer)")):c("",!0),_.index==1&&d.userAnswer==1?(n(),o("span",Ae," (you are correct !)")):c("",!0)],2),t("input",{type:"radio",name:"nodeType",value:_.index,disabled:_.index!=1},null,8,xe),t("div",Se,[_.index==1?(n(),o("div",Me)):c("",!0)])])]))),256)):d.questionType=="essay"?(n(),o("div",Ie,[Te,t("div",Qe,m(d.userAnswer),1)])):d.questionType=="image"?(n(),o("div",Ce,[Ne,(n(!0),o(w,null,k(d.userAnswer.length,(_,b)=>(n(),o("img",{src:d.userAnswer[b],width:"80"},null,8,Le))),256))])):c("",!0),d.questionType=="mc"||d.isCorrect==!1?(n(),o("div",Fe,[Re,t("div",ze,m(d.explanation),1)])):c("",!0)])]))),256))]),s.passModal?(n(),o("div",Ve,[t("div",$e,[t("div",Ee,[De,t("div",Pe,[t("button",{type:"button",class:"btn green-btn",onClick:e[0]||(e[0]=d=>s.passModal=!1)}," Great! ")])])])])):c("",!0),s.failsModal?(n(),o("div",Ue,[t("div",je,[t("div",Be,[Oe,t("div",We,[t("button",{type:"button",class:"btn red-btn",onClick:e[1]||(e[1]=d=>s.failsModal=!1)}," OK ")])])])])):c("",!0),s.waitForMarkModal?(n(),o("div",Ye,[t("div",He,[t("div",Je,[Ke,t("div",Ge,[t("button",{type:"button",class:"btn green-btn",onClick:e[2]||(e[2]=d=>s.waitForMarkModal=!1)}," OK ")])])])])):c("",!0),s.showFlaggingModal?(n(),S(a,{key:3,userId:l.userDetailsStore.userId,contentType:s.questionToFlagType,contentId:s.questionToFlagId},null,8,["userId","contentType","contentId"])):c("",!0)],64)}const Ze=M(Ys,[["render",Xe],["__scopeId","data-v-ee14c537"]]);const st={setup(){const i=F(),e=U(),r=E(),l=j(),s=V(),u=$();return{userDetailsStore:i,settingsStore:e,skillsStore:r,assessmentsStore:l,userSkillsStore:s,skillTreeStore:u}},data(){return{loading:!0,skillId:this.$route.params.id,skill:{},mcQuestions:[],mcQuestionsAnswer:[],essayQuestions:[],imageQuestions:[],questions:[],question:{},questionNumber:0,score:0,assessmentId:null,numMCQuestions:0,numEssayQuestions:0,numImageQuestions:0,totalNumOfQuestions:0,isAllQuestionsAnswered:!1,waitForMarkModal:!1,oldAssessment:void 0,updatedAssessment:!1,showFlaggingModal:!1,flagContentType:"",isQuizPassed:!1,answerHoveredIndex:1/0,showResult:!1,assessmentStatus:"",haveEssayQuestion:!1,finishTime:null,needToSelectInstructor:!1,aiLoading:!1,numOfImagesRequired:1}},async created(){this.settingsStore.quizMaxQuestions==null&&await this.settingsStore.getSettings(),await this.assessmentsStore.getAssessments();const i=this.assessmentsStore.assessments,e=await this.userDetailsStore.getUserDetails();let r;for(let l=0;l<this.skillsStore.skillsList.length;l++)this.skillsStore.skillsList[l].id==this.skillId&&(r=this.skillsStore.skillsList[l].type,this.skill=this.skillsStore.skillsList[l]);if(this.oldAssessment=i.find(l=>l.student_id===e.userId&&l.skill_id===this.skill.id),this.oldAssessment!==void 0&&(this.updatedAssessment=!0),r!="super")await this.fetchMCQuestions(this.skillId);else{let l=[];for(let s=0;s<this.skillsStore.skillsList.length;s++)this.skillsStore.skillsList[s].parent==this.skillId&&this.skillsStore.skillsList[s].type=="sub"&&l.push(this.skillsStore.skillsList[s]);for(let s=0;s<l.length;s++)await this.fetchMCQuestions(l[s].id)}},components:{EssayAnswer:J,ImageAnswer:hs,StudentAddMCQuestion:P,AssessmentResult:Ze,FlagModals:D},methods:{async fetchMCQuestions(i){fetch("/questions/"+i+"/multiple-choice").then(function(e){return e.json()}).then(e=>{this.mcQuestions=this.mcQuestions.concat(e)}).then(()=>{for(let r=0;r<this.mcQuestions.length;r++)this.mcQuestions[r].userAnswer=null,this.mcQuestions[r].questionType="mc";for(let r=0;r<this.mcQuestions.length;r++){var e=[];e.push({option:this.mcQuestions[r].correct_answer,index:1}),e.push({option:this.mcQuestions[r].incorrect_answer_1,index:2}),e.push({option:this.mcQuestions[r].incorrect_answer_2,index:3}),e.push({option:this.mcQuestions[r].incorrect_answer_3,index:4}),e.push({option:this.mcQuestions[r].incorrect_answer_4,index:5}),e=e.sort((l,s)=>.5-Math.random());for(let l=0;l<e.length;l++)e[l].option.toUpperCase()=="all of the above".toUpperCase()&&function(u,h,a){var d=u[h];u.splice(h,1),u.splice(a,0,d)}(e,l,4);this.mcQuestions[r].answerOptions=e}}).then(()=>{this.fetchEssayQuestions(i)})},async fetchEssayQuestions(i){fetch("/questions/"+i+"/essay").then(function(e){return e.json()}).then(e=>{e.length>0&&!this.userDetailsStore.instructor.id&&this.settingsStore.isManualEssayMarking==1&&(this.needToSelectInstructor=!0),this.essayQuestions=this.essayQuestions.concat(e)}).then(()=>{for(let e=0;e<this.essayQuestions.length;e++)this.essayQuestions[e].userAnswer=null,this.essayQuestions[e].questionType="essay"}).then(()=>{this.questions=this.essayQuestions.concat(this.mcQuestions)}).then(()=>{this.fetchImageQuestions(i)})},async fetchImageQuestions(i){fetch("/questions/"+i+"/image").then(function(e){return e.json()}).then(e=>{e.length>0&&!this.userDetailsStore.instructor.id&&this.settingsStore.isManualEssayMarking==1&&(this.needToSelectInstructor=!0),this.imageQuestions=this.imageQuestions.concat(e)}).then(()=>{for(let e=0;e<this.imageQuestions.length;e++)this.imageQuestions[e].userAnswer=null,this.imageQuestions[e].questionType="image"}).then(()=>{this.questions=this.imageQuestions.concat(this.questions),this.questions=this.questions.sort((e,r)=>.5-Math.random()),this.questions.length>this.settingsStore.quizMaxQuestions&&(this.questions.length=this.settingsStore.quizMaxQuestions),this.question=this.questions[0],this.question.questionType=="image"&&(this.numOfImagesRequired=this.question.num_images_required),this.totalNumOfQuestions=this.questions.length}).then(()=>{this.loading=!1})},Next(){if(this.questions[this.questionNumber].questionType=="essay"){const i=this.$refs.essayAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i,this.$refs.essayAnswer.clearAnswer()}else if(this.questions[this.questionNumber].questionType=="image"){const i=this.$refs.imageAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i,this.$refs.imageAnswer.clearAnswer()}this.questionNumber++,this.questions[this.questionNumber].questionType=="essay"?this.questions[this.questionNumber].userAnswer&&this.$refs.essayAnswer.setAnswer(this.questions[this.questionNumber].userAnswer):this.questions[this.questionNumber].questionType=="image"&&(this.questions[this.questionNumber].userAnswer&&this.$refs.imageAnswer.setAnswer(this.questions[this.questionNumber].userAnswer),this.numOfImagesRequired=this.questions[this.questionNumber].num_images_required)},Previous(){if(this.questions[this.questionNumber].questionType=="essay"){const i=this.$refs.essayAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i}else if(this.questions[this.questionNumber].questionType=="image"){const i=this.$refs.imageAnswer.getAnswer();this.questions[this.questionNumber].userAnswer=i}this.questionNumber--,this.questions[this.questionNumber].questionType=="essay"?this.$refs.essayAnswer.setAnswer(this.questions[this.questionNumber].userAnswer):this.questions[this.questionNumber].questionType=="image"&&(this.$refs.imageAnswer.setAnswer(this.questions[this.questionNumber].userAnswer),this.numOfImagesRequired=this.questions[this.questionNumber].num_images_required)},async Submit(){if(this.finishTime=new Date,this.questions[this.questionNumber].questionType=="essay"){let e;e=this.$refs.essayAnswer.getAnswer(),this.questions[this.questionNumber].userAnswer=e}else if(this.questions[this.questionNumber].questionType=="image"){let e;e=this.$refs.imageAnswer.getAnswer(),this.questions[this.questionNumber].userAnswer=e}for(let e=0;e<this.questions.length;e++)this.questions[e].questionType=="mc"?(this.numMCQuestions++,this.questions[e].userAnswer==1&&this.score++):this.questions[e].questionType=="essay"?this.numEssayQuestions++:this.numImageQuestions++;if(this.numEssayQuestions===0&&this.numImageQuestions===0)this.score/this.numMCQuestions*100>=this.settingsStore.passMark?(this.MakeMastered(this.skill),this.isQuizPassed=!0,this.assessmentStatus="pass",this.showResult=!0):(this.isQuizPassed=!0,this.assessmentStatus="fails",this.showResult=!0);else if(this.settingsStore.isManualEssayMarking==1){let e="POST";this.oldAssessment!==void 0&&(e="PUT");let r=this.numEssayQuestions+this.numImageQuestions;const l={method:e,headers:{"Content-Type":"application/json"},body:JSON.stringify({totalScore:this.totalNumOfQuestions,currentScore:this.score,numUnmarkedQuestions:r})};var i="/assessments/"+this.userDetailsStore.userId+"/"+this.skillId;const s=()=>{this.isQuizPassed=!0,this.showResult=!0,this.assessmentStatus="please wait for answers to be marked"};fetch(i,l).then(function(u){return u.json()}).then(u=>{this.assessmentId=u.id,fetch("/unmarked-answers/delete/"+this.assessmentId,{method:"DELETE"}).then(()=>{for(let a=0;a<this.questions.length;a++)if(this.questions[a].questionType=="essay"){const d={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:this.questions[a].userAnswer,questionId:this.questions[a].id})};var h="/unmarked-answers/add/essay/"+this.assessmentId;fetch(h,d).then(function(_){s()})}else if(this.questions[a].questionType=="image"){const d={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:this.questions[a].userAnswer,questionId:this.questions[a].id})};var h="/unmarked-answers/add/image/"+this.assessmentId;fetch(h,d).then(function(b){s()})}})})}else{for(let e=0;e<this.questions.length;e++)if(this.questions[e].questionType=="essay"){let r=this.questions[e].question,l=this.questions[e].userAnswer;await this.AIMarkEssayQuestion(r,l,e)}else if(this.questions[e].questionType=="image"){let r=this.questions[e].question,l=this.questions[e].userAnswer;await this.AIMarkImageQuestion(r,l,e)}this.score/this.questions.length*100>=this.settingsStore.passMark?(this.MakeMastered(this.skill),this.isQuizPassed=!0,this.assessmentStatus="pass",this.showResult=!0):(this.isQuizPassed=!0,this.assessmentStatus="fails",this.showResult=!0)}},async AIMarkEssayQuestion(i,e,r){this.aiLoading=!0;const l={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:i,answer:e,level:this.skill.level})};await fetch("/questions/mark-essay-question",l).then(function(u){return u.json()}).then(u=>{u.isCorrect==!0?(this.score++,this.questions[r].isCorrect=!0):(this.questions[r].explanation=u.explanation,this.questions[r].isCorrect=!1)}).finally(()=>{this.aiLoading=!1})},async AIMarkImageQuestion(i,e,r){this.aiLoading=!0;const l={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:i,answer:e,level:this.skill.level})};await fetch("/questions/mark-image-question",l).then(function(u){return u.json()}).then(u=>{u.isCorrect==!0?(this.score++,this.questions[r].isCorrect=!0):(this.questions[r].explanation=u.explanation,this.questions[r].isCorrect=!1)}).finally(()=>{this.aiLoading=!1})},UserAnswer(){for(let i=0;i<this.questions.length;i++)if(this.questions[i].userAnswer==null){this.isAllQuestionsAnswered=!1;return}else this.isAllQuestionsAnswered=!0},TestPass(){this.isQuizPassed=!0},handleClickFlagIcon(){this.questions[this.questionNumber].questionType==="mc"?this.flagContentType="mc_question":this.flagContentType="essay_question",this.showFlaggingModal=!0},async MakeMastered(i){await this.userSkillsStore.MakeMastered(this.userDetailsStore.userId,i),await this.skillTreeStore.getUserSkills()}}},I=i=>(R("data-v-807e674d"),i=i(),z(),i),et={key:0},tt={key:1,class:"loading-animation d-flex justify-content-center align-items-center py-4"},it=I(()=>t("span",{class:"loader"},null,-1)),nt=[it],ot={key:2},rt={key:0},lt={id:"myModal",class:"modal"},at={class:"modal-content"},ut=I(()=>t("div",{class:"mb-2"}," You are taking a new quiz for this skill while your old one is still waiting to be marked. Please note that your old answers will be replaced. ",-1)),ct={class:"d-flex flex-row-reverse"},dt={class:"pb-2 pb-md-0"},ht={key:0,class:"container mt-5 mb-3 p-3 pt-2 mb-3",id:"question-container"},mt={class:"row"},_t={key:0},ft={class:"col d-flex my-2 gap-2 justify-content-between flex-column flex-md-row"},gt={class:"d-flex align-items-lg-center"},pt={id:"question-number-div"},wt={id:"question-content"},vt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",style:{height:"22px",opacity:"0.5"}},yt=I(()=>t("path",{fill:"#8f7bd6",d:"M64 32C64 14.3 49.7 0 32 0S0 14.3 0 32V64 368 480c0 17.7 14.3 32 32 32s32-14.3 32-32V352l64.3-16.1c41.1-10.3 84.6-5.5 122.5 13.4c44.2 22.1 95.5 24.8 141.7 7.4l34.7-13c12.5-4.7 20.8-16.6 20.8-30V66.1c0-23-24.2-38-44.8-27.7l-9.6 4.8c-46.3 23.2-100.8 23.2-147.1 0c-35.1-17.6-75.4-22-113.5-12.5L64 48V32z"},null,-1)),qt=[yt],kt={key:0},bt={class:"form-check my-3"},At={class:"control control-checkbox"},xt=["name","value","onUpdate:modelValue"],St=["onMouseover"],Mt={class:"form-group"},It={class:"form-group"},Tt={class:"mt-3 d-flex justify-content-end"},Qt={key:1,id:"question-content"},Ct={key:5,class:"modal"},Nt={class:"modal-content"},Lt=I(()=>t("div",{class:""},[t("p",{class:"text-center"}," Please choose an instructor before taking these quizzes. ")],-1)),Ft={class:"d-flex flex-column-reverse flex-md-row justify-content-center gap-2"},Rt=I(()=>t("span",null,"Back",-1)),zt=I(()=>t("span",null,"Select Instructor",-1));function Vt(i,e,r,l,s,u){const h=y("EssayAnswer"),a=y("ImageAnswer"),d=y("AssessmentResult"),_=y("FlagModals"),b=y("RouterLink");return n(),o(w,null,[s.loading==!0?(n(),o("div",et,"Loading...")):c("",!0),s.aiLoading?(n(),o("div",tt,nt)):c("",!0),s.loading==!1&&s.isQuizPassed==!1&&!s.needToSelectInstructor&&!s.aiLoading?(n(),o("div",ot,[s.updatedAssessment?(n(),o("div",rt,[t("div",lt,[t("div",at,[ut,t("div",ct,[t("button",{type:"button",class:"btn green-btn",onClick:e[0]||(e[0]=q=>s.updatedAssessment=!1)}," OK ")])])])])):c("",!0),t("div",dt,[s.questions.length>0?(n(),o("div",ht,[(n(!0),o(w,null,k(s.questions,(q,T)=>(n(),o("div",mt,[T==s.questionNumber?(n(),o("div",_t,[t("div",ft,[t("div",gt,[t("div",pt,m(T+1),1),t("div",wt,m(q.question),1)]),t("div",{"b-tooltip.hover":"",title:"flag this question for review",onClick:e[1]||(e[1]=(...A)=>u.handleClickFlagIcon&&u.handleClickFlagIcon(...A)),class:"flagging-icon",style:{height:"50px"}},[(n(),o("svg",vt,qt))])]),q.questionType=="mc"?(n(),o("div",kt,[(n(!0),o(w,null,k(q.answerOptions,(A,Xt)=>(n(),o("div",bt,[t("label",At,[t("div",{class:g(s.answerHoveredIndex==A.index?"my-auto mx-2 me-4 answer-option checkbox-hovered":"my-auto mx-2 me-4 answer-option")},m(A.option),3),p(t("input",{type:"radio",name:T+"answer",value:A.index,"onUpdate:modelValue":N=>s.questions[T].userAnswer=N},null,8,xt),[[L,s.questions[T].userAnswer]]),t("div",{class:"control_indicator",onMouseover:N=>s.answerHoveredIndex=A.index,onMouseleave:e[2]||(e[2]=N=>s.answerHoveredIndex=1/0)},null,40,St)])]))),256))])):c("",!0)])):c("",!0)]))),256)),t("div",{class:g(`${s.questions[s.questionNumber].questionType=="essay"?"d-block":"d-none"}`)},[t("div",Mt,[Q(h,{ref:"essayAnswer"},null,512)])],2),t("div",{class:g(`${s.questions[s.questionNumber].questionType=="image"?"d-block":"d-none"}`)},[t("div",It,[Q(a,{numImagesRequired:s.numOfImagesRequired,ref:"imageAnswer"},null,8,["numImagesRequired"])])],2),t("div",Tt,[s.questionNumber>0?(n(),o("button",{key:0,onClick:e[3]||(e[3]=q=>u.Previous()),class:"btn red-btn me-2"}," Previous ")):c("",!0),s.questionNumber<s.questions.length-1?(n(),o("button",{key:1,onClick:e[4]||(e[4]=q=>u.Next()),class:"btn green-btn"}," Next ")):c("",!0),s.questionNumber>=s.questions.length-1?(n(),o("button",{key:2,onClick:e[5]||(e[5]=q=>u.Submit()),class:"btn green-btn"}," Submit ")):c("",!0)])])):(n(),o("div",Qt," There is no quiz for this skill yet. Please check again soon. "))])])):c("",!0),s.showResult?(n(),S(d,{key:3,skill:s.skill,isManualEssayMarking:l.settingsStore.isManualEssayMarking},null,8,["skill","isManualEssayMarking"])):c("",!0),s.showFlaggingModal?(n(),S(_,{key:4,userId:l.userDetailsStore.userId,contentId:s.questions[s.questionNumber].id,contentType:s.flagContentType},null,8,["userId","contentId","contentType"])):c("",!0),s.needToSelectInstructor?(n(),o("div",Ct,[t("div",Nt,[Lt,t("div",Ft,[Q(b,{to:`/skills/${s.skillId}`,type:"button",class:"btn green-btn w-100 w-md-50"},{default:C(()=>[Rt]),_:1},8,["to"]),Q(b,{to:"/profile/edit",type:"button",class:"btn green-btn w-100 w-md-50"},{default:C(()=>[zt]),_:1})])])])):c("",!0)],64)}const $t=M(st,[["render",Vt],["__scopeId","data-v-807e674d"]]),Et="/images/skill-avatar/recurso.png";const Dt={setup(){return{skillsStore:E()}},data(){return{skillId:this.$route.params.id,skill:{name:null,image:null,firstAncestorId:null,levelInHierarchy:null}}},async mounted(){this.skillsStore.skillsList.length==0&&await this.skillsStore.getSkillsList();for(let i=0;i<this.skillsStore.skillsList.length;i++)this.skillId==this.skillsStore.skillsList[i].id&&(this.skill.name=this.skillsStore.skillsList[i].name,this.skill.image=this.skillsStore.skillsList[i].image,this.skill.firstAncestorId=this.skillsStore.skillsList[i].first_ancestor,this.skill.levelInHierarchy=this.skillsStore.skillsList[i].hierarchy_level)},components:{Assessment:$t}},Pt=i=>(R("data-v-0924da32"),i=i(),z(),i),Ut={id:"banner"},jt=["src"],Bt={class:"container mt-3"},Ot={class:"d-flex justify-content-md-between justify-content-center"},Wt={class:"d-flex flex-column flex-md-row"},Yt=["src"],Ht={key:1,id:"skill-icon",src:Et,alt:"default skill icon"},Jt={id:"assessment-skill-name",class:"ms-3 d-flex justify-content-end"},Kt=Pt(()=>t("div",{class:"mt-4 mb-4"},[t("hr",{class:"border border-2 opacity-100 w-md-75 w-100",id:"assessment-horizontal-line"})],-1));function Gt(i,e,r,l,s,u){const h=y("Assessment");return n(),o(w,null,[t("div",Ut,[t("img",{src:"/images/banners/skills-banner.png",class:"img-fluid"},null,8,jt)]),t("div",Bt,[t("div",Ot,[t("div",Wt,[this.skill.image?(n(),o("img",{key:0,src:this.skill.image},null,8,Yt)):(n(),o("img",Ht)),t("div",Jt,m(this.skill.name)+" Quiz ",1)])]),Kt,Q(h)])],64)}const ii=M(Dt,[["render",Gt],["__scopeId","data-v-0924da32"]]);export{ii as default};
