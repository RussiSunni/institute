import{_ as k,u as f,k as p,o as u,c as l,a as i,t as r,w as h,B as m,l as y,n as c,F as q,h as b,g as _}from"./main-8ae89ab6.js";import{u as v}from"./UserSkillsStore-56ce92f5.js";import{u as w}from"./SkillsStore-6dca402b.js";import"./SkillTreeStore-0e0ce35a.js";const A={setup(){const e=f(),s=v();return{userDetailsStore:e,userSkillsStore:s}},data(){return{skillId:this.$route.params.id,mcQuestions:[],essayQuestions:[],questions:[],question:{},questionNumber:0,score:0,assessmentId:null,numMCQuestions:0,numEssayQuestions:0,totalNumOfQuestions:0,isAllQuestionsAnswered:!1}},async created(){await this.fetchMCQuestions(),await this.fetchEssayQuestions()},methods:{fetchMCQuestions(){fetch("/questions/"+this.skillId+"/multiple-choice").then(function(e){return e.json()}).then(e=>this.mcQuestions=e).then(()=>{for(let e=0;e<this.mcQuestions.length;e++)this.mcQuestions[e].userAnswer=null,this.mcQuestions[e].questionType="mc"})},fetchEssayQuestions(){fetch("/questions/"+this.skillId+"/essay").then(function(e){return e.json()}).then(e=>this.essayQuestions=e).then(()=>{for(let e=0;e<this.essayQuestions.length;e++)this.essayQuestions[e].userAnswer=null,this.essayQuestions[e].questionType="essay"}).then(()=>{this.questions=this.essayQuestions.concat(this.mcQuestions),this.questions=this.questions.sort((e,s)=>.5-Math.random()),this.question=this.questions[0],this.totalNumOfQuestions=this.questions.length})},Next(){this.questionNumber++,this.question=this.questions[this.questionNumber]},Previous(){this.questionNumber--,this.question=this.questions[this.questionNumber]},Submit(){for(let s=0;s<this.questions.length;s++)this.questions[s].questionType=="mc"?(this.numMCQuestions++,this.questions[s].userAnswer==this.questions[s].correct_answer&&this.score++):this.numEssayQuestions++;if(this.essayQuestions.length==0)this.score/this.numMCQuestions*100>=90?(this.MakeMastered(this.skillId),alert("Well done! You have now mastered this skill.")):alert("You failed");else{alert("There is at least one question that needs to be marked manually. Please check whether you passed later.");const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({totalScore:this.totalNumOfQuestions,currentScore:this.score,numUnmarkedQuestions:this.numEssayQuestions})};var e="/assessments/"+this.userDetailsStore.userId+"/"+this.skillId;fetch(e,s).then(function(a){return a.json()}).then(a=>{this.assessmentId=a.id,fetch("/unmarked-answers/delete/"+this.assessmentId,{method:"DELETE"}).then(()=>{for(let t=0;t<this.questions.length;t++)if(this.questions[t].questionType=="essay"){const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:this.questions[t].userAnswer,questionId:this.questions[t].id})};var d="/unmarked-answers/add/"+this.assessmentId;fetch(d,o).then(function(n){p.push({name:"post-login"})})}})})}this.$router.push("/skill-tree")},async MakeMastered(e){await this.userSkillsStore.MakeMastered(this.userDetailsStore.userId,e)},UserAnswer(){for(let e=0;e<this.questions.length;e++)if(this.questions[e].userAnswer==null){this.isAllQuestionsAnswered=!1;return}else this.isAllQuestionsAnswered=!0},TestPass(){this.MakeMastered(this.skillId)}}},g={key:0,class:"container mt-3 mb-3"},S={class:"row mt-3"},N={key:0},Q={class:"form-check"},I={class:"form-check-label"},T={class:"form-check"},M={class:"form-check-label"},U={class:"form-check"},C={class:"form-check-label"},x={class:"form-check"},P={class:"form-check-label"},V={class:"form-check"},E={class:"form-check-label"},L={key:1},O={class:"form-group"},D={class:"mt-3 d-flex justify-content-end"},j={key:1};function B(e,s,a,d,t,o){return u(),l(q,null,[i("button",{onClick:s[0]||(s[0]=n=>o.TestPass()),class:"btn green-btn me-2"},"Test Pass"),this.questions.length>0?(u(),l("div",g,[i("div",S,[i("h3",null,"Question "+r(this.questionNumber+1)+": "+r(t.question.question),1),this.question.questionType=="mc"?(u(),l("div",N,[i("div",Q,[h(i("input",{onInput:s[1]||(s[1]=n=>o.UserAnswer()),class:"form-check-input",type:"radio",value:"1","onUpdate:modelValue":s[2]||(s[2]=n=>t.questions[this.questionNumber].userAnswer=n)},null,544),[[m,t.questions[this.questionNumber].userAnswer]]),i("label",I,r(t.question.answer_1),1)]),i("div",T,[h(i("input",{onInput:s[3]||(s[3]=n=>o.UserAnswer()),class:"form-check-input",type:"radio",value:"2","onUpdate:modelValue":s[4]||(s[4]=n=>t.questions[this.questionNumber].userAnswer=n)},null,544),[[m,t.questions[this.questionNumber].userAnswer]]),i("label",M,r(t.question.answer_2),1)]),i("div",U,[h(i("input",{onInput:s[5]||(s[5]=n=>o.UserAnswer()),class:"form-check-input",type:"radio",value:"3","onUpdate:modelValue":s[6]||(s[6]=n=>t.questions[this.questionNumber].userAnswer=n)},null,544),[[m,t.questions[this.questionNumber].userAnswer]]),i("label",C,r(t.question.answer_3),1)]),i("div",x,[h(i("input",{onInput:s[7]||(s[7]=n=>o.UserAnswer()),class:"form-check-input",type:"radio",value:"4","onUpdate:modelValue":s[8]||(s[8]=n=>t.questions[this.questionNumber].userAnswer=n)},null,544),[[m,t.questions[this.questionNumber].userAnswer]]),i("label",P,r(t.question.answer_4),1)]),i("div",V,[h(i("input",{onInput:s[9]||(s[9]=n=>o.UserAnswer()),class:"form-check-input",type:"radio",value:"5","onUpdate:modelValue":s[10]||(s[10]=n=>t.questions[this.questionNumber].userAnswer=n)},null,544),[[m,t.questions[this.questionNumber].userAnswer]]),i("label",E,r(t.question.answer_5),1)])])):this.question.questionType=="essay"?(u(),l("div",L,[i("div",O,[h(i("textarea",{onInput:s[11]||(s[11]=n=>o.UserAnswer()),class:"form-control","onUpdate:modelValue":s[12]||(s[12]=n=>t.questions[this.questionNumber].userAnswer=n),rows:"3"},null,544),[[y,t.questions[this.questionNumber].userAnswer]])])])):c("",!0)]),i("div",D,[this.questionNumber>0?(u(),l("button",{key:0,onClick:s[13]||(s[13]=n=>o.Previous()),class:"btn green-btn me-2"},"Previous")):c("",!0),this.questionNumber!=t.questions.length-1?(u(),l("button",{key:1,onClick:s[14]||(s[14]=n=>o.Next()),class:"btn green-btn"},"Next")):c("",!0),this.questionNumber==t.questions.length-1?(u(),l("button",{key:2,onClick:s[15]||(s[15]=n=>o.Submit()),class:"btn green-btn"},"Submit")):c("",!0)])])):(u(),l("div",j,"There is no quiz for this skill yet. Please check again soon."))],64)}const H=k(A,[["render",B],["__scopeId","data-v-8a6f2540"]]),z={setup(){return{skillsStore:w()}},data(){return{skillId:this.$route.params.id,skill:{name:null,image:null,firstAncestorId:null,levelInHierarchy:null}}},async mounted(){this.skillsStore.skillsList.length==0&&await this.skillsStore.getSkillsList();for(let e=0;e<this.skillsStore.skillsList.length;e++)this.skillId==this.skillsStore.skillsList[e].id&&(this.skill.name=this.skillsStore.skillsList[e].name,this.skill.image=this.skillsStore.skillsList[e].image,this.skill.firstAncestorId=this.skillsStore.skillsList[e].first_ancestor,this.skill.levelInHierarchy=this.skillsStore.skillsList[e].hierarchy_level)},components:{Assessment:H}},F={id:"banner"},J=["src"],Y={class:"container mt-3"},R={class:"d-flex"},W=["src"],G={class:"ms-3"};function K(e,s,a,d,t,o){const n=b("Assessment");return u(),l(q,null,[i("div",F,[i("img",{src:"/images/banners/skills/"+this.skill.firstAncestorId+"/"+this.skill.levelInHierarchy+".png",class:"img-fluid"},null,8,J)]),i("div",Y,[i("div",R,[i("img",{src:this.skill.image},null,8,W),i("h1",G,r(this.skill.name)+" Quiz",1)]),_(n)])],64)}const es=k(z,[["render",K]]);export{es as default};
