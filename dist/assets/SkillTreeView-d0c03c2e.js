import{d as ee,_ as Y,o as v,c as F,a as y,w as E,v as U,F as j,r as te,t as ne,p as O,b as J,u as se,e as R,f as P,g as ie,h as V,S as re}from"./main-f00749c9.js";import{u as le}from"./SkillTreeStore-ff1aec4d.js";import{u as ae}from"./TagsStore-faa71f5f.js";import{S as oe,A as ce,h as de,P as he,a as h,G as H,T as W,C as X}from"./fontfaceobserver.standalone-fafe274f.js";const ue=ee("skillTags",{state:()=>({skillTagsList:[]}),actions:{async getSkillTagsList(){const t=await(await fetch("/skill-tags/list")).json();this.skillTagsList=t}}});const fe={setup(){return{tagsStore:ae()}},data(){return{filters:[],checkedFilters:[]}},async created(){},async mounted(){await this.tagsStore.getTagsList()},methods:{applyFilter:function(){this.$parent.applyFilter(this.checkedFilters)}}},K=e=>(O("data-v-9934bafa"),e=e(),J(),e),ge={id:"filters"},me=K(()=>y("h1",{id:"filterMainHeader",class:"mb-2"},"My Skills Tree",-1)),pe={class:"form-check"},ke=K(()=>y("label",{class:"form-check-label",for:"flexCheckDefault"}," Mastered and available skills ",-1)),_e={class:"form-check"},ye=["value"],Se={class:"form-check-label",for:"flexCheckDefault"};function we(e,t,n,i,o,d){return v(),F("div",ge,[me,y("div",pe,[E(y("input",{class:"form-check-input",type:"checkbox",value:0,id:"flexCheckDefault","onUpdate:modelValue":t[0]||(t[0]=a=>o.checkedFilters=a),onChange:t[1]||(t[1]=a=>d.applyFilter())},null,544),[[U,o.checkedFilters]]),ke]),(v(!0),F(j,null,te(this.tagsStore.tagsList,a=>(v(),F("div",null,[y("div",_e,[E(y("input",{class:"form-check-input",type:"checkbox",value:a.id,id:"flexCheckDefault","onUpdate:modelValue":t[2]||(t[2]=c=>o.checkedFilters=c),onChange:t[3]||(t[3]=c=>d.applyFilter())},null,40,ye),[[U,o.checkedFilters]]),y("label",Se,ne(a.name),1)])]))),256))])}const xe=Y(fe,[["render",we],["__scopeId","data-v-9934bafa"]]);function be(e){var t=0,n=e.children,i=n&&n.length;if(!i)t=1;else for(;--i>=0;)t+=n[i].value;e.value=t}function Te(){return this.eachAfter(be)}function ve(e,t){let n=-1;for(const i of this)e.call(t,i,++n,this);return this}function Ce(e,t){for(var n=this,i=[n],o,d,a=-1;n=i.pop();)if(e.call(t,n,++a,this),o=n.children)for(d=o.length-1;d>=0;--d)i.push(o[d]);return this}function Ie(e,t){for(var n=this,i=[n],o=[],d,a,c,x=-1;n=i.pop();)if(o.push(n),d=n.children)for(a=0,c=d.length;a<c;++a)i.push(d[a]);for(;n=o.pop();)e.call(t,n,++x,this);return this}function Ae(e,t){let n=-1;for(const i of this)if(e.call(t,i,++n,this))return i}function Fe(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,i=t.children,o=i&&i.length;--o>=0;)n+=i[o].value;t.value=n})}function Me(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function ze(e){for(var t=this,n=Be(t,e),i=[t];t!==n;)t=t.parent,i.push(t);for(var o=i.length;e!==n;)i.splice(o,0,e),e=e.parent;return i}function Be(e,t){if(e===t)return e;var n=e.ancestors(),i=t.ancestors(),o=null;for(e=n.pop(),t=i.pop();e===t;)o=e,e=n.pop(),t=i.pop();return o}function Ne(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function Pe(){return Array.from(this)}function De(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function $e(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*Le(){var e=this,t,n=[e],i,o,d;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,i=e.children)for(o=0,d=i.length;o<d;++o)n.push(i[o]);while(n.length)}function D(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Re)):t===void 0&&(t=Ue);for(var n=new M(e),i,o=[n],d,a,c,x;i=o.pop();)if((a=t(i.data))&&(x=(a=Array.from(a)).length))for(i.children=a,c=x-1;c>=0;--c)o.push(d=a[c]=new M(a[c])),d.parent=i,d.depth=i.depth+1;return n.eachBefore(He)}function Ee(){return D(this).eachBefore(Ve)}function Ue(e){return e.children}function Re(e){return Array.isArray(e)?e[1]:null}function Ve(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function He(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function M(e){this.data=e,this.depth=this.height=0,this.parent=null}M.prototype=D.prototype={constructor:M,count:Te,each:ve,eachAfter:Ie,eachBefore:Ce,find:Ae,sum:Fe,sort:Me,path:ze,ancestors:Ne,descendants:Pe,leaves:De,links:$e,copy:Ee,[Symbol.iterator]:Le};function We(e,t){return e.parent===t.parent?1:2}function B(e){var t=e.children;return t?t[0]:e.t}function N(e){var t=e.children;return t?t[t.length-1]:e.t}function Xe(e,t,n){var i=n/(t.i-e.i);t.c-=i,t.s+=n,e.c+=i,t.z+=n,t.m+=n}function Ye(e){for(var t=0,n=0,i=e.children,o=i.length,d;--o>=0;)d=i[o],d.z+=t,d.m+=t,t+=d.s+(n+=d.c)}function je(e,t,n){return e.a.parent===t.parent?e.a:n}function z(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}z.prototype=Object.create(M.prototype);function Oe(e){for(var t=new z(e,0),n,i=[t],o,d,a,c;n=i.pop();)if(d=n._.children)for(n.children=new Array(c=d.length),a=c-1;a>=0;--a)i.push(o=n.children[a]=new z(d[a],a)),o.parent=n;return(t.parent=new z(null,0)).children=[t],t}function Je(){var e=We,t=1,n=1,i=null;function o(r){var g=Oe(r);if(g.eachAfter(d),g.parent.m=-g.z,g.eachBefore(a),i)r.eachBefore(x);else{var u=r,l=r,m=r;r.eachBefore(function(p){p.x<u.x&&(u=p),p.x>l.x&&(l=p),p.depth>m.depth&&(m=p)});var _=u===l?1:e(u,l)/2,s=_-u.x,k=t/(l.x+_+s),b=n/(m.depth||1);r.eachBefore(function(p){p.x=(p.x+s)*k,p.y=p.depth*b})}return r}function d(r){var g=r.children,u=r.parent.children,l=r.i?u[r.i-1]:null;if(g){Ye(r);var m=(g[0].z+g[g.length-1].z)/2;l?(r.z=l.z+e(r._,l._),r.m=r.z-m):r.z=m}else l&&(r.z=l.z+e(r._,l._));r.parent.A=c(r,l,r.parent.A||u[0])}function a(r){r._.x=r.z+r.parent.m,r.m+=r.parent.m}function c(r,g,u){if(g){for(var l=r,m=r,_=g,s=l.parent.children[0],k=l.m,b=m.m,p=_.m,S=s.m,T;_=N(_),l=B(l),_&&l;)s=B(s),m=N(m),m.a=r,T=_.z+p-l.z-k+e(_._,l._),T>0&&(Xe(je(_,r,u),r,T),k+=T,b+=T),p+=_.m,k+=l.m,S+=s.m,b+=m.m;_&&!N(m)&&(m.t=_,m.m+=p-b),l&&!B(s)&&(s.t=l,s.m+=k-S,u=r)}return u}function x(r){r.x*=t,r.y=r.depth*n}return o.separation=function(r){return arguments.length?(e=r,o):e},o.size=function(r){return arguments.length?(i=!1,t=+r[0],n=+r[1],o):i?null:[t,n]},o.nodeSize=function(r){return arguments.length?(i=!0,t=+r[0],n=+r[1],o):i?[t,n]:null},o}function A(e,t,n){this.k=e,this.x=t,this.y=n}A.prototype={constructor:A,scale:function(e){return e===1?this:new A(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new A(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};A.prototype;const Ke={setup(){const e=se(),t=le(),n=ue();return{userDetailsStore:e,skillTreeStore:t,skillTagsStore:n}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,regularLockedUnmasteredNodeSprite:null,radius:0,radiusMultiplier:6,skill:{id:null,children:[],isMastered:null,isUnlocked:null,color:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:xe,SkillPanel:oe},async mounted(){this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills();const e=window.innerWidth,t=window.innerHeight;this.radius=Math.min(e,t)/2;var n=new ce({width:e,height:t,resolution:2,transparent:!0,antialias:!0,autoDensity:!0,autoStart:!0});document.querySelector("#skilltree").appendChild(n.view);const i=new de({screenWidth:e,screenHeight:t,worldWidth:e,worldHeight:t,events:n.renderer.events});this.viewport=i,n.stage.addChild(i),i.center=new he(0,0),i.drag().pinch().wheel().decelerate().clampZoom({minScale:.2,maxScale:5});const o=h.from("center-node.png");this.skill={name:"SKILLS",sprite:o,children:this.skillTreeStore.userSkills},this.getAlgorithm(i),document.getElementById("reset-button").addEventListener("click",()=>{this.resetTree(i)})},methods:{getAlgorithm(e){var t=[];t=JSON.parse(JSON.stringify(this.skill.children));function n(a){for(var c=a.length;c--;)a[c].type=="sub"&&a.splice(c,1),typeof a[c]<"u"&&a[c].children&&Array.isArray(a[c].children)&&a[c].children.length>0&&n(a[c].children)}n(t);var i={name:null,children:t};const d=Je().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((a,c)=>(a.parent==c.parent?1:4)/a.depth)(D(i));this.drawChart(d,e)},drawChart(e,t){for(let r=0;r<e.links().length;r++){const g=new H;g.lineStyle(2,16777215,1);var n=Math.cos(e.links()[r].source.x)*e.links()[r].source.y,i=Math.sin(e.links()[r].source.x)*e.links()[r].source.y;g.moveTo(n,i);var o=Math.cos(e.links()[r].target.x)*e.links()[r].target.y,d=Math.sin(e.links()[r].target.x)*e.links()[r].target.y;g.lineTo(o,d),t.addChild(g),this.stageContents.push(g)}const a=this.skill.sprite;a.x=e.x,a.y=e.y,a.anchor.set(.5),this.isRecentered==!1?a.scale.set(.1):a.scale.set(.5),t.addChild(a),this.stageContents.push(a);let c=new W(this.skill.name,{fontFamily:"Poppins900",fontSize:40,fill:0,align:"center"});c.anchor.set(.5),c.x=e.x,c.y=e.y,c.scale.x=.1,c.scale.y=.1,t.addChild(c),this.stageContents.push(c);function x(r,g,u){g++;for(let[_,s]of r.entries()){for(let f=0;f<e.descendants().length;f++)e.descendants()[f].data.id==s.id&&(s.x=e.descendants()[f].x,s.y=e.descendants()[f].y);let k=new X;k.x=Math.cos(s.x)*s.y,k.y=Math.sin(s.x)*s.y;var l=new h;g==1?(s.is_mastered=="1"?s.first_ancestor=="1"?l=h.from("images/skill-tree-nodes/spoken-language-domain-large-mastered.png"):s.first_ancestor=="2"?l=h.from("images/skill-tree-nodes/written-language-domain-large-mastered.png"):s.first_ancestor=="3"?l=h.from("images/skill-tree-nodes/math-domain-large-mastered.png"):s.first_ancestor=="4"?l=h.from("images/skill-tree-nodes/science-domain-large-mastered.png"):s.first_ancestor=="5"?l=h.from("images/skill-tree-nodes/history-domain-large-mastered.png"):s.first_ancestor=="6"&&(l=h.from("images/skill-tree-nodes/life-domain-large-mastered.png")):s.is_accessible=="1"?s.first_ancestor=="1"?l=h.from("images/skill-tree-nodes/spoken-language-domain-large-unlocked.png"):s.first_ancestor=="2"?l=h.from("images/skill-tree-nodes/written-language-domain-large-unlocked.png"):s.first_ancestor=="3"?l=h.from("images/skill-tree-nodes/math-domain-large-unlocked.png"):s.first_ancestor=="4"?l=h.from("images/skill-tree-nodes/science-domain-large-unlocked.png"):s.first_ancestor=="5"?l=h.from("images/skill-tree-nodes/history-domain-large-unlocked.png"):s.first_ancestor=="6"&&(l=h.from("images/skill-tree-nodes/life-domain-large-unlocked.png")):l=h.from("images/skill-tree-nodes/all-regular-locked-unmastered.png"),l.width=30,l.height=30):(l=h.from("images/skill-tree-nodes/all-regular-locked-unmastered.png"),s.is_mastered=="1"?s.first_ancestor=="1"?l=h.from("images/skill-tree-nodes/spoken-language-domain-regular-mastered.png"):s.first_ancestor=="2"?l=h.from("images/skill-tree-nodes/written-language-domain-regular-mastered.png"):s.first_ancestor=="3"?l=h.from("images/skill-tree-nodes/math-domain-regular-mastered.png"):s.first_ancestor=="4"?l=h.from("images/skill-tree-nodes/science-domain-regular-mastered.png"):s.first_ancestor=="5"?l=h.from("images/skill-tree-nodes/history-domain-regular-mastered.png"):s.first_ancestor=="6"&&(l=h.from("images/skill-tree-nodes/life-domain-regular-mastered.png")):s.is_accessible=="1"&&(s.first_ancestor=="1"?l=h.from("images/skill-tree-nodes/spoken-language-domain-regular-mastered.png"):s.first_ancestor=="2"?l=h.from("images/skill-tree-nodes/written-language-domain-regular-mastered.png"):s.first_ancestor=="3"?l=h.from("images/skill-tree-nodes/math-domain-regular-mastered.png"):s.first_ancestor=="4"?l=h.from("images/skill-tree-nodes/science-domain-regular-mastered.png"):s.first_ancestor=="5"?l=h.from("images/skill-tree-nodes/history-domain-regular-mastered.png"):s.first_ancestor=="6"&&(l=h.from("images/skill-tree-nodes/life-domain-regular-mastered.png"))),l.width=20,l.height=20),l.anchor.set(.5),k.addChild(l);let b=40;const p=s.skill_name.split(" ");for(let f=0;f<p.length;f++)p[f].length>9&&(b=37);s.skill_name=s.skill_name.replace(/(.*?\s)/g,`$1
`);let S=new W(s.skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:b,fill:16777215,align:"center"});S.anchor.set(.5),S.scale.x=.1,S.scale.y=.1,k.addChild(S),l.eventMode="static",S.eventMode="static",l.cursor="pointer",S.cursor="pointer",S.on("pointerdown",f=>{var w={id:s.id,children:s.children,isMastered:s.is_mastered,isUnlocked:s.is_accessible,color:m,container:k,name:s.skill_name,description:s.description,tagIDs:[],sprite:l};if(u.skill=w,!u.isSkillInfoPanelShown){let C=function(){u.recenterTree(t)};u.skill=w,u.showInfoPanel(t),document.getElementById("recenterTree").addEventListener("click",C)}}),l.on("pointerdown",f=>{var w={id:s.id,children:s.children,isMastered:s.is_mastered,isUnlocked:s.is_accessible,color:m,container:k,name:s.skill_name,description:s.description,tagIDs:[],sprite:l};if(u.skill=w,!u.isSkillInfoPanelShown){let C=function(){u.recenterTree(t)};u.skill=w,u.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",C)}}),t.addChild(k),u.stageContents.push(k);let T=0,$=0;for(let f=0;f<s.children.length;f++)s.children[f].type!="sub"?T++:$++;for(let f=0;f<s.children.length;f++)if(s.children[f].type=="sub"){let w=new X,C=360/$,Z=f-T,L=C*Z*Math.PI/180,Q=25*Math.cos(L),G=25*Math.sin(L);w.x=Q,w.y=G;const I=new H;var m;s.children[f].is_mastered=="1"?m="0x"+s.children[f].mastered_color:s.children[f].is_accessible=="1"?(I.lineStyle(1,"0x"+s.children[f].mastered_color,1),m="0x"+s.children[f].unlocked_color):m="0xD9D9D9",I.beginFill(m),I.drawCircle(0,0,5),I.endFill(),w.addChild(I),k.addChild(w)}s.children&&Array.isArray(s.children)&&s.children.length>0&&x(s.children,g,u)}}x(this.skill.children,0,this)},recenterTree(e){this.isRecentered=!0,this.radiusMultiplier=1;for(let t=0;t<this.stageContents.length;t++)this.stageContents[t].destroy();this.getAlgorithm(e)},resetTree(e){this.isRecentered=!1,this.radiusMultiplier=6,console.log(e),e.parent.removeChildren();const t=h.from("center-node.png");this.skill={name:"SKILLS",sprite:t,children:this.skillTreeStore.userSkills},this.getAlgorithm(e)},showInfoPanel(){this.isSkillInfoPanelShown||(screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",document.getElementById("sidepanel-backdrop").style.display="block",this.isSkillInfoPanelShown=!0,document.getElementById("skillDescription"),document.getElementById("skillLink"))}}},q=e=>(O("data-v-f743bd67"),e=e(),J(),e),qe={class:"flex-container skill-tree-container"},Ze=q(()=>y("button",{id:"reset-button",class:"btn btn-info"},"Reset",-1)),Qe={id:"wrapper"},Ge={id:"skilltree"},et=q(()=>y("div",{id:"sidepanel-backdrop"},null,-1));function tt(e,t,n,i,o,d){const a=R("SkillTreeFilter"),c=R("SkillPanel");return v(),F("div",qe,[P(a,{id:"filter"}),Ze,y("div",Qe,[y("div",Ge,[P(c,{skill:o.skill},null,8,["skill"])]),et])])}const nt=Y(Ke,[["render",tt],["__scopeId","data-v-f743bd67"]]);const st=y("div",{id:"purple-banner"},null,-1),it=y("span",null,"Loading...",-1),dt={__name:"SkillTreeView",setup(e){return(t,n)=>(v(),F(j,null,[st,(v(),ie(re,null,{default:V(()=>[P(nt)]),fallback:V(()=>[it]),_:1}))],64))}};export{dt as default};
