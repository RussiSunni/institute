import{_ as F,u as z,P as R,S as t,G as D,T as A,r as M,o as w,c as B,a as b,w as U,v as V,b as v,C as L,p as j,d as H,e as K,f as $,g as W,F as J}from"./main-d6aac19c.js";import{u as O}from"./SkillTreeStore-11b24846.js";import{u as q,S as Z,t as Q,h as X}from"./transform-ec5f1b20.js";import{S as Y,h as G}from"./fontfaceobserver.standalone-f5b26f33.js";const ee={setup(){const i=z(),a=O(),f=q();return{userDetailsStore:i,skillTreeStore:a,skillTagsStore:f}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,regularLockedUnmasteredNodeSprite:null,radius:0,width:null,height:null,radiusMultiplier:256,firstLevelNodeSize:500,secondLevelNodeSize:100,regularNodeSize:50,subSkillRadius:50,skill:{id:null,children:[],isMastered:null,isUnlocked:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:Z,SkillPanel:Y},async mounted(){document.getElementById("reset-button").addEventListener("click",()=>{this.resetTree()}),this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills(),this.width=window.innerWidth,this.height=window.innerHeight,this.radius=Math.min(this.width,this.height)/2,document.querySelector("#skilltree").appendChild(this.$pixiApp.view);const i=new G({screenWidth:this.width,screenHeight:this.height,worldWidth:this.width,worldHeight:this.height,events:this.$pixiApp.renderer.events});this.$pixiApp.stage.addChild(i),i.center=new R(0,0),i.drag().pinch().wheel().decelerate().clampZoom({minScale:.001,maxScale:10});const a=t.from("center-node.png");this.skill={name:"SKILLS",sprite:a,children:this.skillTreeStore.userSkills},this.getAlgorithm()},methods:{getAlgorithm(){var i=[];i=JSON.parse(JSON.stringify(this.skill.children));function a(e){for(var h=e.length;h--;)e[h].type=="sub"&&e.splice(h,1),typeof e[h]<"u"&&e[h].children&&Array.isArray(e[h].children)&&e[h].children.length>0&&a(e[h].children)}a(i);var f={name:null,children:i};const k=Q().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((e,h)=>(e.parent==h.parent,1/e.depth))(X(f));var s=[];function r(e,h){for(let l=0;l<e.length;l++)e[l].type!="sub"&&s.push(e[l]),r(e[l].children)}r(i);let g=k.descendants().sort((e,h)=>e.data.id-h.data.id);for(let e=0;e<s.length;e++)for(let h=0;h<g.length;h++)s[e].id==g[h].data.id&&(s[e].x=g[h].x,s[e].y=g[h].y);for(var d=0;d<s.length;d++)if(s[d].children=[],s[d].parent!=null&&s[d].parent!=0){var o=s[d].parent;for(let e=0;e<s.length;e++)s[e].id==o&&s[e].children.push(s[d])}let n=[];for(var d=0;d<s.length;d++)(s[d].parent==null||s[d].parent==0)&&n.push(s[d]);this.skill.children=n,this.drawChart(k)},drawChart(i){for(let d=0;d<i.links().length;d++){const o=new D;o.lineStyle(2,16777215,1);var a=Math.cos(i.links()[d].source.x)*i.links()[d].source.y,f=Math.sin(i.links()[d].source.x)*i.links()[d].source.y;o.moveTo(a,f);var u=Math.cos(i.links()[d].target.x)*i.links()[d].target.y,k=Math.sin(i.links()[d].target.x)*i.links()[d].target.y;o.lineTo(u,k),this.$pixiApp.stage.children[0].addChild(o),this.stageContents.push(o)}const s=this.skill.sprite;s.x=i.x,s.y=i.y,s.anchor.set(.5),this.isRecentered==!1?s.scale.set(.5):s.scale.set(1),this.$pixiApp.stage.children[0].addChild(s),this.stageContents.push(s);let r=new A(this.skill.name,{fontFamily:"Poppins900",fontSize:200,fill:0,align:"center"});r.anchor.set(.5),r.x=i.x,r.y=i.y,r.scale.x=.2,r.scale.y=.2,this.$pixiApp.stage.children[0].addChild(r),this.stageContents.push(r);function g(d,o,n){o++;for(let[h,l]of d.entries()){let m=new L;m.x=Math.cos(l.x)*l.y,m.y=Math.sin(l.x)*l.y;var e=new t;l.level=="grade_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/grade-school-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/grade-school-unlocked.png"):e=t.from("images/skill-tree-nodes/grade-school-locked.png"):l.level=="middle_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/middle-school-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="high_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/high-school-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="college"?l.is_mastered?e=t.from("images/skill-tree-nodes/college-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="phd"?l.is_mastered?e=t.from("images/skill-tree-nodes/phd-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="domain"&&(e=t.from("images/skill-tree-nodes/domain.png"));let I=0,T=0;for(let c=0;c<l.children.length;c++)l.children[c].type!="sub"?I++:T++;console.log(l),o==1?(e.width=n.firstLevelNodeSize,e.height=n.firstLevelNodeSize):o==2?(e.width=n.secondLevelNodeSize,e.height=n.secondLevelNodeSize):(e.width=n.regularNodeSize,e.height=n.regularNodeSize),e.anchor.set(.5),m.addChild(e);let S;o==1?S=300:o==2?S=100:S=50;const x=l.skill_name.split(" ");for(let c=0;c<x.length;c++)x[c].length>9&&(o==1?S=250:o==2?S=90:S=40);l.skill_name=l.skill_name.replace(/(.*?\s)/g,`$1
`);let _=new A(l.skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:S,fill:16777215,align:"center"});_.anchor.set(.5),_.scale.x=.2,_.scale.y=.2,m.addChild(_),e.eventMode="static",_.eventMode="static",e.cursor="pointer",_.cursor="pointer",_.on("pointerdown",c=>{var p={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:m,name:l.skill_name,description:l.description,tagIDs:[],sprite:e};if(n.skill=p,!n.isSkillInfoPanelShown){let y=function(){n.recenterTree()};n.skill=p,n.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",y)}}),e.on("pointerdown",c=>{var p={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:m,name:l.skill_name,description:l.description,tagIDs:[],sprite:e};if(n.skill=p,!n.isSkillInfoPanelShown){let y=function(){n.recenterTree()};n.skill=p,n.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",y)}}),n.$pixiApp.stage.children[0].addChild(m),n.stageContents.push(m);for(let c=0;c<l.children.length;c++)if(l.children[c].type=="sub"){let p=new L,y=360/T,E=c-I,P=y*E*Math.PI/180,C,N;C=n.subSkillRadius*Math.cos(P),N=n.subSkillRadius*Math.sin(P),p.x=C,p.y=N;var e=new t;l.level=="grade_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/grade-school-small-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/grade-school-small-unlocked.png"):e=t.from("images/skill-tree-nodes/grade-school-small-locked.png"):l.level=="middle_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/middle-school-small-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-small-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-small-locked.png"):l.level=="high_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/high-school-small-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/high-school-small-unlocked.png"):e=t.from("images/skill-tree-nodes/high-school-small-locked.png"):l.level=="college"?l.is_mastered?e=t.from("images/skill-tree-nodes/college-smal-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/college-small-unlocked.png"):e=t.from("images/skill-tree-nodes/college-small-locked.png"):l.level=="phd"&&(l.is_mastered?e=t.from("images/skill-tree-nodes/phd-small-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/phd-small-unlocked.png"):e=t.from("images/skill-tree-nodes/phd-small-locked.png")),e.width=15,e.height=15,e.anchor.set(.5),p.addChild(e),m.addChild(p)}l.children&&Array.isArray(l.children)&&l.children.length>0&&g(l.children,o,n)}}g(this.skill.children,0,this)},recenterTree(){this.isRecentered=!0,this.radiusMultiplier=1;for(let i=0;i<this.stageContents.length;i++)this.stageContents[i].destroy();this.hideInfoPanel(),this.getAlgorithm()},resetTree(){this.isRecentered=!1,this.radiusMultiplier=4,this.$pixiApp.stage.children[0].removeChildren();const i=t.from("center-node.png");this.skill={name:"SKILLS",sprite:i,children:this.skillTreeStore.userSkills},this.getAlgorithm()},showInfoPanel(){this.isSkillInfoPanelShown||(screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",document.getElementById("sidepanel-backdrop").style.display="block",this.isSkillInfoPanelShown=!0,document.getElementById("skillDescription"),document.getElementById("skillLink"))},hideInfoPanel(){this.isSkillInfoPanelShown&&(screen.width>800?document.getElementById("skillInfoPanel").style.width="0px":document.getElementById("skillInfoPanel").style.height="0px",document.getElementById("sidepanel-backdrop").style.display="none",this.isSkillInfoPanelShown=!1)},async filterSkills(i){var a=[];function f(o,n){for(let e=0;e<o.length;e++)a.push(o[e]),f(o[e].children)}f(this.skill.children);var u=0;for(let o=0;o<a.length;o++){let n=a[o];k(n,n.parent,i),a[o].parent=u}function k(o,n,e,h){for(let l=0;l<a.length;l++)if(a[l].id==n){let m=a[l];m.level==e?(u=m.parent,k(o,u,e)):u=m.id}}let s=[];for(var r=0;r<a.length;r++)a[r].level!=i&&s.push(a[r]);for(var r=0;r<s.length;r++)if(s[r].children=[],s[r].parent!=null&&s[r].parent!=0){var g=s[r].parent;for(let n=0;n<s.length;n++)s[n].id==g&&s[n].children.push(s[r])}let d=[];for(var r=0;r<s.length;r++)(s[r].parent==null||s[r].parent==0)&&d.push(s[r]);this.skill.children=d;for(let o=0;o<this.stageContents.length;o++)this.stageContents[o].destroy();this.applyFilter()},applyFilter(){this.$pixiApp.stage.children[0].removeChildren();const i=t.from("center-node.png");this.skill={name:"SKILLS",sprite:i,children:this.skill.children},this.getAlgorithm()}}},le=i=>(j("data-v-3bb35471"),i=i(),H(),i),se={class:"flex-container skill-tree-container"},ie={id:"reset-button",class:"btn btn-info"},te={id:"wrapper"},ne={id:"skilltree"},re=le(()=>v("div",{id:"sidepanel-backdrop"},null,-1));function oe(i,a,f,u,k,s){const r=M("SkillTreeFilter"),g=M("SkillPanel");return w(),B("div",se,[b(r,{id:"filter"}),U(v("button",ie,"Reset",512),[[V,k.isRecentered]]),v("div",te,[v("div",ne,[b(g,{skill:k.skill},null,8,["skill"])]),re])])}const de=F(ee,[["render",oe],["__scopeId","data-v-3bb35471"]]);const ae=v("div",{id:"purple-banner"},null,-1),he=v("span",null,"Loading...",-1),pe={__name:"SkillTreeView",setup(i){return(a,f)=>(w(),B(J,null,[ae,(w(),K(W,null,{default:$(()=>[b(de)]),fallback:$(()=>[he]),_:1}))],64))}};export{pe as default};
