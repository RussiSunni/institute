import{_ as v,u as w,S as x,r as b,o as g,c as k,b as d,a as y,p as T,d as I,e as M,f as _,g as P,F as R}from"./main-d5a9e164.js";import{u as $}from"./SkillTreeStore-f6a96295.js";import{u as j,S as L}from"./SkillTreeFilter-6e2d7f69.js";import{S as z}from"./SkillPanel-06c3a9db.js";import"./fontfaceobserver.standalone-8358d40e.js";import"./transform-9f729428.js";import{l as N,z as A,s as B}from"./zoom-d4b7039c.js";import{h as U}from"./index-0536990b.js";import{t as O}from"./tree-6e85cfa8.js";import{c as F}from"./create-94a19cff.js";const D={setup(){const r=w(),s=$(),n=j();return{userDetailsStore:r,skillTreeStore:s,skillTagsStore:n}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,width:null,height:null,radiusMultiplier:1,firstLevelNodeSize:100,regularNodeSize:50,subSkillRadius:50,skill:{id:null,children:[],isMastered:null,isUnlocked:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:L,SkillPanel:z},async mounted(){this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills(),this.width=3e4,this.height=3e4,this.radius=Math.min(this.width,this.height)/2;const r=x.from("center-node.png");this.skill={name:"SKILLS",sprite:r,children:this.skillTreeStore.userSkills},this.getAlgorithm()},methods:{getAlgorithm(){var r=[];r=JSON.parse(JSON.stringify(this.skill.children));function s(e){for(var t=e.length;t--;){if(e[t].type=="super"&&e[t].position!="end"){var m=[],f=[];for(let l=0;l<e[t].children.length;l++)e[t].children[l].type=="sub"?m.push(e[t].children[l]):f.push(e[t].children[l]);var S={skill_name:e[t].skill_name,type:"super",position:"end",children:m};e[t].children=[],e[t].children.push(S);for(let l=0;l<f.length;l++)e[t].children.push(f[l])}typeof e[t]<"u"&&e[t].children&&Array.isArray(e[t].children)&&e[t].children.length>0&&s(e[t].children)}}s(r);var n={name:null,children:r};const o=O().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((e,t)=>(e.parent==t.parent,1/e.depth))(U(n)),c=this.width*.5,u=this.height*.5,i=F("svg").attr("id","radialTree").attr("width",this.width).attr("height",this.height).attr("viewBox",[-c,-u,this.width,this.height]).attr("style","width: 100%; height: auto; font: 10px sans-serif;"),a=i.append("g");a.append("g").attr("fill","none").attr("stroke","#000").attr("stroke-opacity",1).selectAll().data(o.links()).join("path").attr("d",N().angle(e=>e.x).radius(e=>e.y)).attr("stroke-width",function(e){return e.target.data.is_mastered==1?8:2}).style("stroke-dasharray",function(e){if(e.source.data.type=="super"&&e.target.data.position=="end"||e.target.data.type=="sub")return 5}),a.append("g").selectAll().data(o.descendants()).join("circle").attr("transform",e=>`rotate(${e.x*180/Math.PI-90}) translate(${e.y},0)`).attr("fill",function(e){if(e.depth==0)return"lightgreen";if(e.data.type=="domain")return"orange";if(e.data.level=="grade_school")return"yellow";if(e.data.level=="middle_school")return"lightblue";if(e.data.level=="high_school")return"green";if(e.data.level=="college")return"red";if(e.data.level=="phd")return"purple"}).attr("r",function(e){return e.depth==0?50:e.data.type=="domain"?20:5}),a.append("g").attr("stroke-linejoin","round").attr("stroke-width",3).selectAll().data(o.descendants()).join("text").attr("transform",e=>`rotate(${e.x*180/Math.PI-90}) translate(${e.y},0) rotate(${e.x>=Math.PI?180:0})`).attr("dy","0.31em").attr("x",e=>e.x<Math.PI==!e.children?6:-6).attr("text-anchor",e=>e.x<Math.PI==!e.children?"start":"end").attr("paint-order","stroke").attr("stroke","white").attr("fill","currentColor").style("font-weight",function(e){return e.data.type=="super"?"700":"400"}).style("font-style",function(e){if(e.data.type=="sub")return"italic"}).text(function(e){return e.data.position=="end"?"":e.data.skill_name}),i.call(A().extent([[0,0],[this.width,this.height]]).scaleExtent([1e-4,20]).on("zoom",h));function h({transform:e}){a.attr("transform",e)}document.querySelector("#skilltree").append(i.node())},printPDF(){var r=document.getElementById("radialTree"),s=B(r),n=s.node(),p=new XMLSerializer,o=p.serializeToString(n),c={svg:o,treeType:"radial"},u=JSON.stringify(c),i=new XMLHttpRequest;i.responseType="arraybuffer",i.open("POST","/skilltree/print-pdf",!0),i.setRequestHeader("Content-type","application/json;charset=UTF-8"),i.setRequestHeader("Accept","application/json, text/plain, */*"),i.send(u),i.onload=function(){if(this.readyState==4&&this.status==200){let h=new Blob([i.response],{type:"application/pdf"});const e=window.URL.createObjectURL(h);var a=document.createElement("a");document.body.appendChild(a),a.style="display: none",a.href=e,a.download="My-Skill-Tree.pdf",a.click(),window.URL.revokeObjectURL(e)}}}}},q=r=>(T("data-v-7badce74"),r=r(),I(),r),E={class:"flex-container skill-tree-container"},V={id:"wrapper"},H={id:"skilltree"},J=q(()=>d("div",{id:"sidepanel-backdrop"},null,-1));function X(r,s,n,p,o,c){const u=b("SkillPanel");return g(),k("div",E,[d("button",{id:"print-btn",class:"btn btn-info",onClick:s[0]||(s[0]=i=>c.printPDF())}," Print "),d("div",V,[d("div",H,[y(u,{skill:o.skill},null,8,["skill"])]),J])])}const K=v(D,[["render",X],["__scopeId","data-v-7badce74"]]);const W=d("div",{id:"purple-banner"},null,-1),G=d("span",null,"Loading...",-1),le={__name:"RadialTidyTreeView",setup(r){return(s,n)=>(g(),k(R,null,[W,(g(),M(P,null,{default:_(()=>[y(K)]),fallback:_(()=>[G]),_:1}))],64))}};export{le as default};
