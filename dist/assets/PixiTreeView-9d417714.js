import{j,_ as B,o as y,c as w,F as E,r as H,a as k,w as z,k as K,t as W,d as q,p as D,b as R,u as J,l as O,S as Z,m as Q,P as X,n as t,q as Y,s as G,G as ee,T as A,e as M,h as I,x as le,C as L,f as se,g as F,y as ie}from"./main-541fbbc7.js";import"./fontfaceobserver.standalone-8b875372.js";const te=j("skillTags",{state:()=>({skillTagsList:[]}),actions:{async getSkillTagsList(){const d=await(await fetch("/skill-tags/list")).json();this.skillTagsList=d}}});const ne={setup(){},data(){return{levels:[{id:"grade_school",name:"Grade school"},{id:"middle_school",name:"Middle school"},{id:"high_school",name:"High school"},{id:"college",name:"College"},{id:"phd",name:"PhD"}],checkedFilters:[],isFilterApplied:!1}},async created(){},async mounted(){},methods:{applyFilter:function(s){this.isFilterApplied=!0,this.$parent.filterSkills(s)}}},U=s=>(D("data-v-b4ceaabf"),s=s(),R(),s),re={id:"filters"},oe=U(()=>k("h1",{id:"filterMainHeader",class:"mb-2"},"My Skill Tree",-1)),ae={key:0},de=U(()=>k("p",{class:"mb-2"},"Choose which level to filter out",-1)),ce={class:"form-check"},he=["value","onChange"],fe={class:"form-check-label",for:"flexCheckDefault"};function me(s,d,p,_,h,i){return y(),w("div",re,[oe,h.isFilterApplied==!1?(y(),w("div",ae,[de,(y(!0),w(E,null,H(h.levels,n=>(y(),w("div",null,[k("div",ce,[z(k("input",{class:"form-check-input",type:"radio",value:n.id,id:"flexCheckDefault","onUpdate:modelValue":d[0]||(d[0]=f=>h.checkedFilters=f),onChange:f=>i.applyFilter(n.id)},null,40,he),[[K,h.checkedFilters]]),k("label",fe,W(n.name),1)])]))),256))])):q("",!0)])}const ge=B(ne,[["render",me],["__scopeId","data-v-b4ceaabf"]]);const pe={setup(){const s=J(),d=O(),p=te();return{userDetailsStore:s,skillTreeStore:d,skillTagsStore:p}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,regularLockedUnmasteredNodeSprite:null,radius:0,width:null,height:null,radiusMultiplier:256,firstLevelNodeSize:500,secondLevelNodeSize:100,regularNodeSize:50,subSkillRadius:50,skill:{id:null,children:[],isMastered:null,isUnlocked:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:ge,SkillPanel:Z},async mounted(){document.getElementById("reset-button").addEventListener("click",()=>{this.resetTree()}),this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills(),this.width=window.innerWidth,this.height=window.innerHeight,this.radius=Math.min(this.width,this.height)/2,document.querySelector("#skilltree").appendChild(this.$pixiApp.view);const s=new Q({screenWidth:this.width,screenHeight:this.height,worldWidth:this.width,worldHeight:this.height,events:this.$pixiApp.renderer.events});this.$pixiApp.stage.addChild(s),s.center=new X(0,0),s.drag({wheelScroll:2,factor:2}).pinch({percent:2,factor:2}).wheel().decelerate().clampZoom({minScale:.001,maxScale:10});const d=t.from("center-node.png");this.skill={name:"SKILLS",sprite:d,children:this.skillTreeStore.userSkills},this.getAlgorithm()},methods:{getAlgorithm(){var s=[];s=JSON.parse(JSON.stringify(this.skill.children));function d(e){for(var c=e.length;c--;)e[c].type=="sub"&&e.splice(c,1),typeof e[c]<"u"&&e[c].children&&Array.isArray(e[c].children)&&e[c].children.length>0&&d(e[c].children)}d(s);var p={name:null,children:s};const h=Y().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((e,c)=>(e.parent==c.parent,1/e.depth))(G(p));var i=[];function n(e,c){for(let l=0;l<e.length;l++)e[l].type!="sub"&&i.push(e[l]),n(e[l].children)}n(s);let f=h.descendants().sort((e,c)=>e.data.id-c.data.id);for(let e=0;e<i.length;e++)for(let c=0;c<f.length;c++)i[e].id==f[c].data.id&&(i[e].x=f[c].x,i[e].y=f[c].y);for(var a=0;a<i.length;a++)if(i[a].children=[],i[a].parent!=null&&i[a].parent!=0){var o=i[a].parent;for(let e=0;e<i.length;e++)i[e].id==o&&i[e].children.push(i[a])}let r=[];for(var a=0;a<i.length;a++)(i[a].parent==null||i[a].parent==0)&&r.push(i[a]);this.skill.children=r,this.drawChart(h)},drawChart(s){for(let a=0;a<s.links().length;a++){const o=new ee;s.links()[a].target.data.is_mastered=="1"?o.lineStyle(16,16777215,1):o.lineStyle(2,16777215,1);var d=Math.cos(s.links()[a].source.x)*s.links()[a].source.y,p=Math.sin(s.links()[a].source.x)*s.links()[a].source.y;o.moveTo(d,p);var _=Math.cos(s.links()[a].target.x)*s.links()[a].target.y,h=Math.sin(s.links()[a].target.x)*s.links()[a].target.y;o.lineTo(_,h),this.$pixiApp.stage.children[0].addChild(o),this.stageContents.push(o)}const i=this.skill.sprite;i.x=s.x,i.y=s.y,i.anchor.set(.5),this.isRecentered==!1?i.scale.set(.5):i.scale.set(1),this.$pixiApp.stage.children[0].addChild(i),this.stageContents.push(i);let n=new A(this.skill.name,{fontFamily:"Poppins900",fontSize:200,fill:0,align:"center"});n.anchor.set(.5),n.x=s.x,n.y=s.y,n.scale.x=.2,n.scale.y=.2,this.$pixiApp.stage.children[0].addChild(n),this.stageContents.push(n);function f(a,o,r){o++;for(let[c,l]of a.entries()){let g=new L;g.x=Math.cos(l.x)*l.y,g.y=Math.sin(l.x)*l.y;var e=new t;l.level=="grade_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/grade-school-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/grade-school-unlocked.png"):e=t.from("images/skill-tree-nodes/grade-school-locked.png"):l.level=="middle_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/middle-school-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="high_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/high-school-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="college"?l.is_mastered?e=t.from("images/skill-tree-nodes/college-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="phd"?l.is_mastered?e=t.from("images/skill-tree-nodes/phd-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="domain"&&(e=t.from("images/skill-tree-nodes/domain.png"));let x=0,T=0;for(let m=0;m<l.children.length;m++)l.children[m].type!="sub"?x++:T++;o==1?(e.width=r.firstLevelNodeSize,e.height=r.firstLevelNodeSize):o==2?(e.width=r.secondLevelNodeSize,e.height=r.secondLevelNodeSize):(e.width=r.regularNodeSize,e.height=r.regularNodeSize),e.anchor.set(.5),g.addChild(e);let S;o==1?S=300:o==2?S=100:S=50;const C=l.skill_name.split(" ");for(let m=0;m<C.length;m++)C[m].length>9&&(o==1?S=250:o==2?S=90:S=40);l.skill_name=l.skill_name.replace(/(.*?\s)/g,`$1
`);let v=new A(l.skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:S,fill:16777215,align:"center"});v.anchor.set(.5),v.scale.x=.2,v.scale.y=.2,g.addChild(v),e.eventMode="static",v.eventMode="static",e.cursor="pointer",v.cursor="pointer",v.on("pointerdown",m=>{var u={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:g,name:l.skill_name,description:l.description,tagIDs:[],sprite:e};if(r.skill=u,!r.isSkillInfoPanelShown){let b=function(){r.recenterTree()};r.skill=u,r.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",b)}}),e.on("pointerdown",m=>{var u={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:g,name:l.skill_name,description:l.description,tagIDs:[],sprite:e};if(r.skill=u,!r.isSkillInfoPanelShown){let b=function(){r.recenterTree()};r.skill=u,r.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",b)}}),r.$pixiApp.stage.children[0].addChild(g),r.stageContents.push(g);for(let m=0;m<l.children.length;m++)if(l.children[m].type=="sub"){let u=new L,b=360/T,V=m-x,P=b*V*Math.PI/180,N,$;N=r.subSkillRadius*Math.cos(P),$=r.subSkillRadius*Math.sin(P),u.x=N,u.y=$;var e=new t;l.level=="grade_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/grade-school-small-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/grade-school-small-unlocked.png"):e=t.from("images/skill-tree-nodes/grade-school-small-locked.png"):l.level=="middle_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/middle-school-small-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/middle-school-small-unlocked.png"):e=t.from("images/skill-tree-nodes/middle-school-small-locked.png"):l.level=="high_school"?l.is_mastered?e=t.from("images/skill-tree-nodes/high-school-small-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/high-school-small-unlocked.png"):e=t.from("images/skill-tree-nodes/high-school-small-locked.png"):l.level=="college"?l.is_mastered?e=t.from("images/skill-tree-nodes/college-smal-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/college-small-unlocked.png"):e=t.from("images/skill-tree-nodes/college-small-locked.png"):l.level=="phd"&&(l.is_mastered?e=t.from("images/skill-tree-nodes/phd-small-mastered.png"):l.is_accessible?e=t.from("images/skill-tree-nodes/phd-small-unlocked.png"):e=t.from("images/skill-tree-nodes/phd-small-locked.png")),e.width=15,e.height=15,e.anchor.set(.5),u.addChild(e),g.addChild(u)}l.children&&Array.isArray(l.children)&&l.children.length>0&&f(l.children,o,r)}}f(this.skill.children,0,this)},recenterTree(){this.isRecentered=!0,this.radiusMultiplier=1;for(let s=0;s<this.stageContents.length;s++)this.stageContents[s].destroy();this.hideInfoPanel(),this.getAlgorithm()},resetTree(){this.isRecentered=!1,this.radiusMultiplier=4,this.$pixiApp.stage.children[0].removeChildren();const s=t.from("center-node.png");this.skill={name:"SKILLS",sprite:s,children:this.skillTreeStore.userSkills},this.getAlgorithm()},showInfoPanel(){this.isSkillInfoPanelShown||(screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",document.getElementById("sidepanel-backdrop").style.display="block",this.isSkillInfoPanelShown=!0,document.getElementById("skillDescription"),document.getElementById("skillLink"))},hideInfoPanel(){this.isSkillInfoPanelShown&&(screen.width>800?document.getElementById("skillInfoPanel").style.width="0px":document.getElementById("skillInfoPanel").style.height="0px",document.getElementById("sidepanel-backdrop").style.display="none",this.isSkillInfoPanelShown=!1)},async filterSkills(s){var d=[];function p(o,r){for(let e=0;e<o.length;e++)d.push(o[e]),p(o[e].children)}p(this.skill.children);var _=0;for(let o=0;o<d.length;o++){let r=d[o];h(r,r.parent,s),d[o].parent=_}function h(o,r,e,c){for(let l=0;l<d.length;l++)if(d[l].id==r){let g=d[l];g.level==e?(_=g.parent,h(o,_,e)):_=g.id}}let i=[];for(var n=0;n<d.length;n++)d[n].level!=s&&i.push(d[n]);for(var n=0;n<i.length;n++)if(i[n].children=[],i[n].parent!=null&&i[n].parent!=0){var f=i[n].parent;for(let r=0;r<i.length;r++)i[r].id==f&&i[r].children.push(i[n])}let a=[];for(var n=0;n<i.length;n++)(i[n].parent==null||i[n].parent==0)&&a.push(i[n]);this.skill.children=a;for(let o=0;o<this.stageContents.length;o++)this.stageContents[o].destroy();this.applyFilter()},applyFilter(){this.$pixiApp.stage.children[0].removeChildren();const s=t.from("center-node.png");this.skill={name:"SKILLS",sprite:s,children:this.skill.children},this.getAlgorithm()}}},ke=s=>(D("data-v-64672635"),s=s(),R(),s),ue={class:"flex-container skill-tree-container"},_e={id:"reset-button",class:"btn btn-info"},Se={id:"wrapper"},ve={id:"skilltree"},ye=ke(()=>k("div",{id:"sidepanel-backdrop"},null,-1));function we(s,d,p,_,h,i){const n=M("SkillTreeFilter"),f=M("SkillPanel");return y(),w("div",ue,[I(n,{id:"filter"}),z(k("button",_e," Reset ",512),[[le,h.isRecentered]]),k("div",Se,[k("div",ve,[I(f,{skill:h.skill},null,8,["skill"])]),ye])])}const be=B(pe,[["render",we],["__scopeId","data-v-64672635"]]);const Ie=k("div",{id:"purple-banner"},null,-1),xe=k("span",null,"Loading...",-1),Ne={__name:"PixiTreeView",setup(s){return(d,p)=>(y(),w(E,null,[Ie,(y(),se(ie,null,{default:F(()=>[I(be)]),fallback:F(()=>[xe]),_:1}))],64))}};export{Ne as default};
