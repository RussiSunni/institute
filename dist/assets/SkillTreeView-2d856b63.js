import{d as K,_ as H,o as v,c as C,a as S,w as F,v as D,F as V,r as q,t as Z,p as W,b as j,u as Q,P as G,S as d,G as ee,T as E,e as L,f as $,g as se,C as U,h as ie,i as R,j as te}from"./main-f3d80ee5.js";import{u as le}from"./SkillTreeStore-c7542baa.js";import{S as ne,h as re}from"./fontfaceobserver.standalone-290a1d5c.js";const oe=K("skillTags",{state:()=>({skillTagsList:[]}),actions:{async getSkillTagsList(){const s=await(await fetch("/skill-tags/list")).json();this.skillTagsList=s}}});const ae={setup(){},data(){return{levels:[{id:"grade_school",name:"Grade school"},{id:"middle_school",name:"Middle school"},{id:"high_school",name:"High school"},{id:"college",name:"College"},{id:"phd",name:"PhD"}],checkedFilters:[]}},async created(){},async mounted(){},methods:{applyFilter:function(e){this.$parent.applyFilter(e)}}},X=e=>(W("data-v-6650a14f"),e=e(),j(),e),ce={id:"filters"},de=X(()=>S("h1",{id:"filterMainHeader",class:"mb-2"},"My Skill Tree",-1)),he={class:"form-check"},ue=X(()=>S("label",{class:"form-check-label",for:"flexCheckDefault"}," Mastered and available skills ",-1)),fe={class:"form-check"},pe=["value","onChange"],me={class:"form-check-label",for:"flexCheckDefault"};function ge(e,s,t,r,c,o){return v(),C("div",ce,[de,S("div",he,[F(S("input",{class:"form-check-input",type:"checkbox",value:0,id:"flexCheckDefault","onUpdate:modelValue":s[0]||(s[0]=a=>c.checkedFilters=a),onChange:s[1]||(s[1]=a=>o.applyFilter())},null,544),[[D,c.checkedFilters]]),ue]),(v(!0),C(V,null,q(c.levels,a=>(v(),C("div",null,[S("div",fe,[F(S("input",{class:"form-check-input",type:"checkbox",value:a.id,id:"flexCheckDefault","onUpdate:modelValue":s[2]||(s[2]=m=>c.checkedFilters=m),onChange:m=>o.applyFilter(a.id)},null,40,pe),[[D,c.checkedFilters]]),S("label",me,Z(a.name),1)])]))),256))])}const ke=H(ae,[["render",ge],["__scopeId","data-v-6650a14f"]]);function _e(e){var s=0,t=e.children,r=t&&t.length;if(!r)s=1;else for(;--r>=0;)s+=t[r].value;e.value=s}function ye(){return this.eachAfter(_e)}function Se(e,s){let t=-1;for(const r of this)e.call(s,r,++t,this);return this}function we(e,s){for(var t=this,r=[t],c,o,a=-1;t=r.pop();)if(e.call(s,t,++a,this),c=t.children)for(o=c.length-1;o>=0;--o)r.push(c[o]);return this}function xe(e,s){for(var t=this,r=[t],c=[],o,a,m,g=-1;t=r.pop();)if(c.push(t),o=t.children)for(a=0,m=o.length;a<m;++a)r.push(o[a]);for(;t=c.pop();)e.call(s,t,++g,this);return this}function ve(e,s){let t=-1;for(const r of this)if(e.call(s,r,++t,this))return r}function be(e){return this.eachAfter(function(s){for(var t=+e(s.data)||0,r=s.children,c=r&&r.length;--c>=0;)t+=r[c].value;s.value=t})}function Ie(e){return this.eachBefore(function(s){s.children&&s.children.sort(e)})}function Te(e){for(var s=this,t=Ce(s,e),r=[s];s!==t;)s=s.parent,r.push(s);for(var c=r.length;e!==t;)r.splice(c,0,e),e=e.parent;return r}function Ce(e,s){if(e===s)return e;var t=e.ancestors(),r=s.ancestors(),c=null;for(e=t.pop(),s=r.pop();e===s;)c=e,e=t.pop(),s=r.pop();return c}function Ae(){for(var e=this,s=[e];e=e.parent;)s.push(e);return s}function Me(){return Array.from(this)}function Pe(){var e=[];return this.eachBefore(function(s){s.children||e.push(s)}),e}function Be(){var e=this,s=[];return e.each(function(t){t!==e&&s.push({source:t.parent,target:t})}),s}function*Fe(){var e=this,s,t=[e],r,c,o;do for(s=t.reverse(),t=[];e=s.pop();)if(yield e,r=e.children)for(c=0,o=r.length;c<o;++c)t.push(r[c]);while(t.length)}function z(e,s){e instanceof Map?(e=[void 0,e],s===void 0&&(s=Ne)):s===void 0&&(s=ze);for(var t=new A(e),r,c=[t],o,a,m,g;r=c.pop();)if((a=s(r.data))&&(g=(a=Array.from(a)).length))for(r.children=a,m=g-1;m>=0;--m)c.push(o=a[m]=new A(a[m])),o.parent=r,o.depth=r.depth+1;return t.eachBefore(Ee)}function $e(){return z(this).eachBefore(De)}function ze(e){return e.children}function Ne(e){return Array.isArray(e)?e[1]:null}function De(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Ee(e){var s=0;do e.height=s;while((e=e.parent)&&e.height<++s)}function A(e){this.data=e,this.depth=this.height=0,this.parent=null}A.prototype=z.prototype={constructor:A,count:ye,each:Se,eachAfter:xe,eachBefore:we,find:ve,sum:be,sort:Ie,path:Te,ancestors:Ae,descendants:Me,leaves:Pe,links:Be,copy:$e,[Symbol.iterator]:Fe};function Le(e,s){return e.parent===s.parent?1:2}function P(e){var s=e.children;return s?s[0]:e.t}function B(e){var s=e.children;return s?s[s.length-1]:e.t}function Ue(e,s,t){var r=t/(s.i-e.i);s.c-=r,s.s+=t,e.c+=r,s.z+=t,s.m+=t}function Re(e){for(var s=0,t=0,r=e.children,c=r.length,o;--c>=0;)o=r[c],o.z+=s,o.m+=s,s+=o.s+(t+=o.c)}function He(e,s,t){return e.a.parent===s.parent?e.a:t}function M(e,s){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=s}M.prototype=Object.create(A.prototype);function Ve(e){for(var s=new M(e,0),t,r=[s],c,o,a,m;t=r.pop();)if(o=t._.children)for(t.children=new Array(m=o.length),a=m-1;a>=0;--a)r.push(c=t.children[a]=new M(o[a],a)),c.parent=t;return(s.parent=new M(null,0)).children=[s],s}function We(){var e=Le,s=1,t=1,r=null;function c(l){var h=Ve(l);if(h.eachAfter(o),h.parent.m=-h.z,h.eachBefore(a),r)l.eachBefore(g);else{var n=l,f=l,i=l;l.eachBefore(function(k){k.x<n.x&&(n=k),k.x>f.x&&(f=k),k.depth>i.depth&&(i=k)});var p=n===f?1:e(n,f)/2,_=p-n.x,x=s/(f.x+p+_),y=t/(i.depth||1);l.eachBefore(function(k){k.x=(k.x+_)*x,k.y=k.depth*y})}return l}function o(l){var h=l.children,n=l.parent.children,f=l.i?n[l.i-1]:null;if(h){Re(l);var i=(h[0].z+h[h.length-1].z)/2;f?(l.z=f.z+e(l._,f._),l.m=l.z-i):l.z=i}else f&&(l.z=f.z+e(l._,f._));l.parent.A=m(l,f,l.parent.A||n[0])}function a(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function m(l,h,n){if(h){for(var f=l,i=l,p=h,_=f.parent.children[0],x=f.m,y=i.m,k=p.m,b=_.m,u;p=B(p),f=P(f),p&&f;)_=P(_),i=B(i),i.a=l,u=p.z+k-f.z-x+e(p._,f._),u>0&&(Ue(He(p,l,n),l,u),x+=u,y+=u),k+=p.m,x+=f.m,b+=_.m,y+=i.m;p&&!B(i)&&(i.t=p,i.m+=k-y),f&&!P(_)&&(_.t=f,_.m+=x-b,n=l)}return n}function g(l){l.x*=s,l.y=l.depth*t}return c.separation=function(l){return arguments.length?(e=l,c):e},c.size=function(l){return arguments.length?(r=!1,s=+l[0],t=+l[1],c):r?null:[s,t]},c.nodeSize=function(l){return arguments.length?(r=!0,s=+l[0],t=+l[1],c):r?[s,t]:null},c}function T(e,s,t){this.k=e,this.x=s,this.y=t}T.prototype={constructor:T,scale:function(e){return e===1?this:new T(this.k*e,this.x,this.y)},translate:function(e,s){return e===0&s===0?this:new T(this.k,this.x+this.k*e,this.y+this.k*s)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};T.prototype;const je={setup(){const e=Q(),s=le(),t=oe();return{userDetailsStore:e,skillTreeStore:s,skillTagsStore:t}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,regularLockedUnmasteredNodeSprite:null,radius:0,width:null,height:null,radiusMultiplier:4,skill:{id:null,children:[],isMastered:null,isUnlocked:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:ke,SkillPanel:ne},async mounted(){document.getElementById("reset-button").addEventListener("click",()=>{this.resetTree()}),this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills(),this.width=window.innerWidth,this.height=window.innerHeight,this.radius=Math.min(this.width,this.height)/2,document.querySelector("#skilltree").appendChild(this.$pixiApp.view);const e=new re({screenWidth:this.width,screenHeight:this.height,worldWidth:this.width,worldHeight:this.height,events:this.$pixiApp.renderer.events});this.$pixiApp.stage.addChild(e),e.center=new G(0,0),e.drag().pinch().wheel().decelerate().clampZoom({minScale:.2,maxScale:5});const s=d.from("center-node.png");this.skill={name:"SKILLS",sprite:s,children:this.skillTreeStore.userSkills},this.getAlgorithm()},methods:{getAlgorithm(){var e=[];e=JSON.parse(JSON.stringify(this.skill.children));function s(o){for(var a=o.length;a--;)o[a].type=="sub"&&o.splice(a,1),typeof o[a]<"u"&&o[a].children&&Array.isArray(o[a].children)&&o[a].children.length>0&&s(o[a].children)}s(e);var t={name:null,children:e};const c=We().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((o,a)=>(o.parent==a.parent?1:2)/o.depth)(z(t));this.drawChart(c)},drawChart(e){for(let g=0;g<e.links().length;g++){const l=new ee;l.lineStyle(2,16777215,1);var s=Math.cos(e.links()[g].source.x)*e.links()[g].source.y,t=Math.sin(e.links()[g].source.x)*e.links()[g].source.y;l.moveTo(s,t);var r=Math.cos(e.links()[g].target.x)*e.links()[g].target.y,c=Math.sin(e.links()[g].target.x)*e.links()[g].target.y;l.lineTo(r,c),this.$pixiApp.stage.children[0].addChild(l),this.stageContents.push(l)}const o=this.skill.sprite;o.x=e.x,o.y=e.y,o.anchor.set(.5),this.isRecentered==!1?o.scale.set(.1):o.scale.set(.25),this.$pixiApp.stage.children[0].addChild(o),this.stageContents.push(o);let a=new E(this.skill.name,{fontFamily:"Poppins900",fontSize:40,fill:0,align:"center"});a.anchor.set(.5),a.x=e.x,a.y=e.y,a.scale.x=.2,a.scale.y=.2,this.$pixiApp.stage.children[0].addChild(a),this.stageContents.push(a);function m(g,l,h){l++;for(let[f,i]of g.entries()){for(let u=0;u<e.descendants().length;u++)e.descendants()[u].data.id==i.id&&(i.x=e.descendants()[u].x,i.y=e.descendants()[u].y);let p=new U;p.x=Math.cos(i.x)*i.y,p.y=Math.sin(i.x)*i.y;var n=new d;i.level=="grade_school"?i.is_mastered?n=d.from("images/skill-tree-nodes/grade-school-mastered.png"):i.is_accessible?n=d.from("images/skill-tree-nodes/grade-school-unlocked.png"):n=d.from("images/skill-tree-nodes/grade-school-locked.png"):i.level=="middle_school"?i.is_mastered?n=d.from("images/skill-tree-nodes/middle-school-mastered.png"):i.is_accessible?n=d.from("images/skill-tree-nodes/middle-school-unlocked.png"):n=d.from("images/skill-tree-nodes/middle-school-locked.png"):i.level=="high_school"?i.is_mastered?n=d.from("images/skill-tree-nodes/high-school-mastered.png"):i.is_accessible?n=d.from("images/skill-tree-nodes/middle-school-unlocked.png"):n=d.from("images/skill-tree-nodes/middle-school-locked.png"):i.level=="college"?i.is_mastered?n=d.from("images/skill-tree-nodes/college-mastered.png"):i.is_accessible?n=d.from("images/skill-tree-nodes/middle-school-unlocked.png"):n=d.from("images/skill-tree-nodes/middle-school-locked.png"):i.level=="phd"?i.is_mastered?n=d.from("images/skill-tree-nodes/phd-mastered.png"):i.is_accessible?n=d.from("images/skill-tree-nodes/middle-school-unlocked.png"):n=d.from("images/skill-tree-nodes/middle-school-locked.png"):i.level=="domain"&&(n=d.from("images/skill-tree-nodes/domain.png")),n.width=30,n.height=30,n.anchor.set(.5),p.addChild(n);let _=40;const x=i.skill_name.split(" ");for(let u=0;u<x.length;u++)x[u].length>9&&(_=30);i.skill_name=i.skill_name.replace(/(.*?\s)/g,`$1
`);let y=new E(i.skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:_,fill:16777215,align:"center"});y.anchor.set(.5),y.scale.x=.1,y.scale.y=.1,p.addChild(y),n.eventMode="static",y.eventMode="static",n.cursor="pointer",y.cursor="pointer",y.on("pointerdown",u=>{var w={id:i.id,children:i.children,isMastered:i.is_mastered,isUnlocked:i.is_accessible,container:p,name:i.skill_name,description:i.description,tagIDs:[],sprite:n};if(h.skill=w,!h.isSkillInfoPanelShown){let I=function(){h.recenterTree()};h.skill=w,h.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",I)}}),n.on("pointerdown",u=>{var w={id:i.id,children:i.children,isMastered:i.is_mastered,isUnlocked:i.is_accessible,container:p,name:i.skill_name,description:i.description,tagIDs:[],sprite:n};if(h.skill=w,!h.isSkillInfoPanelShown){let I=function(){h.recenterTree()};h.skill=w,h.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",I)}}),h.$pixiApp.stage.children[0].addChild(p),h.stageContents.push(p);let k=0,b=0;for(let u=0;u<i.children.length;u++)i.children[u].type!="sub"?k++:b++;for(let u=0;u<i.children.length;u++)if(i.children[u].type=="sub"){let w=new U,I=360/b,Y=u-k,N=I*Y*Math.PI/180,O=25*Math.cos(N),J=25*Math.sin(N);w.x=O,w.y=J;var n=new d;i.level=="grade_school"?i.is_mastered?n=d.from("images/skill-tree-nodes/grade-school-small-mastered.png"):i.is_accessible?n=d.from("images/skill-tree-nodes/grade-school-small-unlocked.png"):n=d.from("images/skill-tree-nodes/grade-school-small-locked.png"):i.level=="middle_school"?i.is_mastered?n=d.from("images/skill-tree-nodes/middle-school-small-mastered.png"):i.is_accessible?n=d.from("images/skill-tree-nodes/middle-school-small-unlocked.png"):n=d.from("images/skill-tree-nodes/middle-school-small-locked.png"):i.level=="high_school"?i.is_mastered?n=d.from("images/skill-tree-nodes/high-school-small-mastered.png"):i.is_accessible?n=d.from("images/skill-tree-nodes/high-school-small-unlocked.png"):n=d.from("images/skill-tree-nodes/high-school-small-locked.png"):i.level=="college"?i.is_mastered?n=d.from("images/skill-tree-nodes/college-smal-mastered.png"):i.is_accessible?n=d.from("images/skill-tree-nodes/college-small-unlocked.png"):n=d.from("images/skill-tree-nodes/college-small-locked.png"):i.level=="phd"&&(i.is_mastered?n=d.from("images/skill-tree-nodes/phd-small-mastered.png"):i.is_accessible?n=d.from("images/skill-tree-nodes/phd-small-unlocked.png"):n=d.from("images/skill-tree-nodes/phd-small-locked.png")),n.width=10,n.height=10,n.anchor.set(.5),w.addChild(n),p.addChild(w)}i.children&&Array.isArray(i.children)&&i.children.length>0&&m(i.children,l,h)}}m(this.skill.children,0,this)},recenterTree(){this.isRecentered=!0,this.radiusMultiplier=1;for(let e=0;e<this.stageContents.length;e++)this.stageContents[e].destroy();this.hideInfoPanel(),this.getAlgorithm()},resetTree(){this.isRecentered=!1,this.radiusMultiplier=4,this.$pixiApp.stage.children[0].removeChildren();const e=d.from("center-node.png");this.skill={name:"SKILLS",sprite:e,children:this.skillTreeStore.userSkills},this.getAlgorithm()},showInfoPanel(){this.isSkillInfoPanelShown||(screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",document.getElementById("sidepanel-backdrop").style.display="block",this.isSkillInfoPanelShown=!0,document.getElementById("skillDescription"),document.getElementById("skillLink"))},hideInfoPanel(){this.isSkillInfoPanelShown&&(screen.width>800?document.getElementById("skillInfoPanel").style.width="0px":document.getElementById("skillInfoPanel").style.height="0px",document.getElementById("sidepanel-backdrop").style.display="none",this.isSkillInfoPanelShown=!1)},applyFilter(e){console.log(e),console.log(this.skill.children)}}},Xe=e=>(W("data-v-9738fb2a"),e=e(),j(),e),Ye={class:"flex-container skill-tree-container"},Oe={id:"reset-button",class:"btn btn-info"},Je={id:"wrapper"},Ke={id:"skilltree"},qe=Xe(()=>S("div",{id:"sidepanel-backdrop"},null,-1));function Ze(e,s,t,r,c,o){const a=L("SkillTreeFilter"),m=L("SkillPanel");return v(),C("div",Ye,[$(a,{id:"filter"}),F(S("button",Oe,"Reset",512),[[se,c.isRecentered]]),S("div",Je,[S("div",Ke,[$(m,{skill:c.skill},null,8,["skill"])]),qe])])}const Qe=H(je,[["render",Ze],["__scopeId","data-v-9738fb2a"]]);const Ge=S("div",{id:"purple-banner"},null,-1),es=S("span",null,"Loading...",-1),ns={__name:"SkillTreeView",setup(e){return(s,t)=>(v(),C(V,null,[Ge,(v(),ie(te,null,{default:R(()=>[$(Qe)]),fallback:R(()=>[es]),_:1}))],64))}};export{ns as default};
