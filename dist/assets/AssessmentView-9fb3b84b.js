import{_ as k,u as q,q as f,o as u,c as r,b as i,t as l,w as h,j as m,s as p,k as c,r as y,a as _,F as b}from"./main-8ebb6752.js";import{u as w}from"./UserSkillsStore-72f12616.js";import{u as v}from"./SkillsStore-604e010d.js";import"./SkillTreeStore-e92b9010.js";const A={setup(){const e=q(),s=w();return{userDetailsStore:e,userSkillsStore:s}},data(){return{skillId:this.$route.params.id,mcQuestions:[],essayQuestions:[],questions:[],question:{},questionNumber:0,score:0,assessmentId:null,numMCQuestions:0,numEssayQuestions:0,totalNumOfQuestions:0,isAllQuestionsAnswered:!1}},async created(){await this.fetchMCQuestions(),await this.fetchEssayQuestions()},methods:{fetchMCQuestions(){fetch("/questions/"+this.skillId+"/multiple-choice").then(function(e){return e.json()}).then(e=>this.mcQuestions=e).then(()=>{for(let e=0;e<this.mcQuestions.length;e++)this.mcQuestions[e].userAnswer=null,this.mcQuestions[e].questionType="mc"})},fetchEssayQuestions(){fetch("/questions/"+this.skillId+"/essay").then(function(e){return e.json()}).then(e=>this.essayQuestions=e).then(()=>{for(let e=0;e<this.essayQuestions.length;e++)this.essayQuestions[e].userAnswer=null,this.essayQuestions[e].questionType="essay"}).then(()=>{this.questions=this.essayQuestions.concat(this.mcQuestions),this.questions=this.questions.sort((e,s)=>.5-Math.random()),this.question=this.questions[0],this.totalNumOfQuestions=this.questions.length})},Next(){this.questionNumber++,this.question=this.questions[this.questionNumber]},Previous(){this.questionNumber--,this.question=this.questions[this.questionNumber]},Submit(){for(let s=0;s<this.questions.length;s++)this.questions[s].questionType=="mc"?(this.numMCQuestions++,this.questions[s].userAnswer==this.questions[s].correct_answer&&this.score++):this.numEssayQuestions++;if(this.essayQuestions.length==0)this.score/this.numMCQuestions*100>=90?(this.MakeMastered(this.skillId),alert("Well done! You have now mastered this skill.")):alert("You failed");else{alert("There is at least one question that needs to be marked manually. Please check whether you passed later.");const s={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({totalScore:this.totalNumOfQuestions,currentScore:this.score,numUnmarkedQuestions:this.numEssayQuestions})};var e="/assessments/"+this.userDetailsStore.userId+"/"+this.skillId;fetch(e,s).then(function(a){return a.json()}).then(a=>{this.assessmentId=a.id,fetch("/unmarked-answers/delete/"+this.assessmentId,{method:"DELETE"}).then(()=>{for(let t=0;t<this.questions.length;t++)if(this.questions[t].questionType=="essay"){const o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({answer:this.questions[t].userAnswer,questionId:this.questions[t].id})};var d="/unmarked-answers/add/"+this.assessmentId;fetch(d,o).then(function(n){f.push({name:"post-login"})})}})})}this.$router.push("/skill-tree")},async MakeMastered(e){await this.userSkillsStore.MakeMastered(this.userDetailsStore.userId,e)},UserAnswer(){for(let e=0;e<this.questions.length;e++)if(this.questions[e].userAnswer==null){this.isAllQuestionsAnswered=!1;return}else this.isAllQuestionsAnswered=!0},TestPass(){this.MakeMastered(this.skillId)}}},g={key:0,class:"container mt-3 mb-3"},S={class:"row mt-3"},N={key:0},Q={class:"form-check"},I={class:"form-check-label"},M={class:"form-check"},U={class:"form-check-label"},T={class:"form-check"},x={class:"form-check-label"},C={class:"form-check"},V={class:"form-check-label"},E={class:"form-check"},L={class:"form-check-label"},O={key:1},P={class:"form-group"},j={class:"mt-3 d-flex justify-content-end"},D={key:1};function B(e,s,a,d,t,o){return this.questions.length>0?(u(),r("div",g,[i("div",S,[i("h3",null,"Question "+l(this.questionNumber+1)+": "+l(t.question.question),1),this.question.questionType=="mc"?(u(),r("div",N,[i("div",Q,[h(i("input",{onInput:s[0]||(s[0]=n=>o.UserAnswer()),class:"form-check-input",type:"radio",value:"1","onUpdate:modelValue":s[1]||(s[1]=n=>t.questions[this.questionNumber].userAnswer=n)},null,544),[[m,t.questions[this.questionNumber].userAnswer]]),i("label",I,l(t.question.answer_1),1)]),i("div",M,[h(i("input",{onInput:s[2]||(s[2]=n=>o.UserAnswer()),class:"form-check-input",type:"radio",value:"2","onUpdate:modelValue":s[3]||(s[3]=n=>t.questions[this.questionNumber].userAnswer=n)},null,544),[[m,t.questions[this.questionNumber].userAnswer]]),i("label",U,l(t.question.answer_2),1)]),i("div",T,[h(i("input",{onInput:s[4]||(s[4]=n=>o.UserAnswer()),class:"form-check-input",type:"radio",value:"3","onUpdate:modelValue":s[5]||(s[5]=n=>t.questions[this.questionNumber].userAnswer=n)},null,544),[[m,t.questions[this.questionNumber].userAnswer]]),i("label",x,l(t.question.answer_3),1)]),i("div",C,[h(i("input",{onInput:s[6]||(s[6]=n=>o.UserAnswer()),class:"form-check-input",type:"radio",value:"4","onUpdate:modelValue":s[7]||(s[7]=n=>t.questions[this.questionNumber].userAnswer=n)},null,544),[[m,t.questions[this.questionNumber].userAnswer]]),i("label",V,l(t.question.answer_4),1)]),i("div",E,[h(i("input",{onInput:s[8]||(s[8]=n=>o.UserAnswer()),class:"form-check-input",type:"radio",value:"5","onUpdate:modelValue":s[9]||(s[9]=n=>t.questions[this.questionNumber].userAnswer=n)},null,544),[[m,t.questions[this.questionNumber].userAnswer]]),i("label",L,l(t.question.answer_5),1)])])):this.question.questionType=="essay"?(u(),r("div",O,[i("div",P,[h(i("textarea",{onInput:s[10]||(s[10]=n=>o.UserAnswer()),class:"form-control","onUpdate:modelValue":s[11]||(s[11]=n=>t.questions[this.questionNumber].userAnswer=n),rows:"3"},null,544),[[p,t.questions[this.questionNumber].userAnswer]])])])):c("",!0)]),i("div",j,[this.questionNumber>0?(u(),r("button",{key:0,onClick:s[12]||(s[12]=n=>o.Previous()),class:"btn green-btn me-2"},"Previous")):c("",!0),this.questionNumber!=t.questions.length-1?(u(),r("button",{key:1,onClick:s[13]||(s[13]=n=>o.Next()),class:"btn green-btn"},"Next")):c("",!0),this.questionNumber==t.questions.length-1?(u(),r("button",{key:2,onClick:s[14]||(s[14]=n=>o.Submit()),class:"btn green-btn"},"Submit")):c("",!0)])])):(u(),r("div",D,"There is no quiz for this skill yet. Please check again soon."))}const H=k(A,[["render",B],["__scopeId","data-v-121c75e5"]]),z={setup(){return{skillsStore:v()}},data(){return{skillId:this.$route.params.id,skill:{name:null,image:null,firstAncestorId:null,levelInHierarchy:null}}},async mounted(){this.skillsStore.skillsList.length==0&&await this.skillsStore.getSkillsList();for(let e=0;e<this.skillsStore.skillsList.length;e++)this.skillId==this.skillsStore.skillsList[e].id&&(this.skill.name=this.skillsStore.skillsList[e].name,this.skill.image=this.skillsStore.skillsList[e].image,this.skill.firstAncestorId=this.skillsStore.skillsList[e].first_ancestor,this.skill.levelInHierarchy=this.skillsStore.skillsList[e].hierarchy_level)},components:{Assessment:H}},F={id:"banner"},J=["src"],Y={class:"container mt-3"},R={class:"d-flex"},W=["src"],G={class:"ms-3"};function K(e,s,a,d,t,o){const n=y("Assessment");return u(),r(b,null,[i("div",F,[i("img",{src:"/images/banners/skills/"+this.skill.firstAncestorId+"/"+this.skill.levelInHierarchy+".png",class:"img-fluid"},null,8,J)]),i("div",Y,[i("div",R,[i("img",{src:this.skill.image},null,8,W),i("h1",G,l(this.skill.name)+" Quiz",1)]),_(n)])],64)}const es=k(z,[["render",K]]);export{es as default};
