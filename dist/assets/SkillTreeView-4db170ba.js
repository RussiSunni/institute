import{d as J,_ as H,o as b,c as I,F as V,r as q,a as S,w as W,v as Z,t as Q,b as G,p as X,e as Y,u as ee,P as ie,S as u,G as te,T as D,f as R,g as B,h as le,C as U,i as se,j,k as ne}from"./main-cfddcd83.js";import{u as re}from"./SkillTreeStore-d84cc5aa.js";import{S as ae,h as oe}from"./fontfaceobserver.standalone-166a87ba.js";const de=J("skillTags",{state:()=>({skillTagsList:[]}),actions:{async getSkillTagsList(){const i=await(await fetch("/skill-tags/list")).json();this.skillTagsList=i}}});const he={setup(){},data(){return{levels:[{id:"grade_school",name:"Grade school"},{id:"middle_school",name:"Middle school"},{id:"high_school",name:"High school"},{id:"college",name:"College"},{id:"phd",name:"PhD"}],checkedFilters:[],isFilterApplied:!1}},async created(){},async mounted(){},methods:{applyFilter:function(e){this.isFilterApplied=!0,this.$parent.filterSkills(e)}}},K=e=>(X("data-v-b4ceaabf"),e=e(),Y(),e),ce={id:"filters"},fe=K(()=>S("h1",{id:"filterMainHeader",class:"mb-2"},"My Skill Tree",-1)),ue={key:0},pe=K(()=>S("p",{class:"mb-2"},"Choose which level to filter out",-1)),me={class:"form-check"},ge=["value","onChange"],ke={class:"form-check-label",for:"flexCheckDefault"};function _e(e,i,s,a,h,r){return b(),I("div",ce,[fe,h.isFilterApplied==!1?(b(),I("div",ue,[pe,(b(!0),I(V,null,q(h.levels,o=>(b(),I("div",null,[S("div",me,[W(S("input",{class:"form-check-input",type:"radio",value:o.id,id:"flexCheckDefault","onUpdate:modelValue":i[0]||(i[0]=f=>h.checkedFilters=f),onChange:f=>r.applyFilter(o.id)},null,40,ge),[[Z,h.checkedFilters]]),S("label",ke,Q(o.name),1)])]))),256))])):G("",!0)])}const ye=H(he,[["render",_e],["__scopeId","data-v-b4ceaabf"]]);function Se(e){var i=0,s=e.children,a=s&&s.length;if(!a)i=1;else for(;--a>=0;)i+=s[a].value;e.value=i}function we(){return this.eachAfter(Se)}function ve(e,i){let s=-1;for(const a of this)e.call(i,a,++s,this);return this}function xe(e,i){for(var s=this,a=[s],h,r,o=-1;s=a.pop();)if(e.call(i,s,++o,this),h=s.children)for(r=h.length-1;r>=0;--r)a.push(h[r]);return this}function be(e,i){for(var s=this,a=[s],h=[],r,o,f,p=-1;s=a.pop();)if(h.push(s),r=s.children)for(o=0,f=r.length;o<f;++o)a.push(r[o]);for(;s=h.pop();)e.call(i,s,++p,this);return this}function Ie(e,i){let s=-1;for(const a of this)if(e.call(i,a,++s,this))return a}function Ae(e){return this.eachAfter(function(i){for(var s=+e(i.data)||0,a=i.children,h=a&&a.length;--h>=0;)s+=a[h].value;i.value=s})}function Te(e){return this.eachBefore(function(i){i.children&&i.children.sort(e)})}function Ce(e){for(var i=this,s=ze(i,e),a=[i];i!==s;)i=i.parent,a.push(i);for(var h=a.length;e!==s;)a.splice(h,0,e),e=e.parent;return a}function ze(e,i){if(e===i)return e;var s=e.ancestors(),a=i.ancestors(),h=null;for(e=s.pop(),i=a.pop();e===i;)h=e,e=s.pop(),i=a.pop();return h}function Ne(){for(var e=this,i=[e];e=e.parent;)i.push(e);return i}function Pe(){return Array.from(this)}function $e(){var e=[];return this.eachBefore(function(i){i.children||e.push(i)}),e}function Be(){var e=this,i=[];return e.each(function(s){s!==e&&i.push({source:s.parent,target:s})}),i}function*Me(){var e=this,i,s=[e],a,h,r;do for(i=s.reverse(),s=[];e=i.pop();)if(yield e,a=e.children)for(h=0,r=a.length;h<r;++h)s.push(a[h]);while(s.length)}function M(e,i){e instanceof Map?(e=[void 0,e],i===void 0&&(i=Ee)):i===void 0&&(i=Le);for(var s=new z(e),a,h=[s],r,o,f,p;a=h.pop();)if((o=i(a.data))&&(p=(o=Array.from(o)).length))for(a.children=o,f=p-1;f>=0;--f)h.push(r=o[f]=new z(o[f])),r.parent=a,r.depth=a.depth+1;return s.eachBefore(Re)}function Fe(){return M(this).eachBefore(De)}function Le(e){return e.children}function Ee(e){return Array.isArray(e)?e[1]:null}function De(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Re(e){var i=0;do e.height=i;while((e=e.parent)&&e.height<++i)}function z(e){this.data=e,this.depth=this.height=0,this.parent=null}z.prototype=M.prototype={constructor:z,count:we,each:ve,eachAfter:be,eachBefore:xe,find:Ie,sum:Ae,sort:Te,path:Ce,ancestors:Ne,descendants:Pe,leaves:$e,links:Be,copy:Fe,[Symbol.iterator]:Me};function Ue(e,i){return e.parent===i.parent?1:2}function P(e){var i=e.children;return i?i[0]:e.t}function $(e){var i=e.children;return i?i[i.length-1]:e.t}function je(e,i,s){var a=s/(i.i-e.i);i.c-=a,i.s+=s,e.c+=a,i.z+=s,i.m+=s}function He(e){for(var i=0,s=0,a=e.children,h=a.length,r;--h>=0;)r=a[h],r.z+=i,r.m+=i,i+=r.s+(s+=r.c)}function Ve(e,i,s){return e.a.parent===i.parent?e.a:s}function N(e,i){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=i}N.prototype=Object.create(z.prototype);function We(e){for(var i=new N(e,0),s,a=[i],h,r,o,f;s=a.pop();)if(r=s._.children)for(s.children=new Array(f=r.length),o=f-1;o>=0;--o)a.push(h=s.children[o]=new N(r[o],o)),h.parent=s;return(i.parent=new N(null,0)).children=[i],i}function Xe(){var e=Ue,i=1,s=1,a=null;function h(n){var d=We(n);if(d.eachAfter(r),d.parent.m=-d.z,d.eachBefore(o),a)n.eachBefore(p);else{var c=n,t=n,m=n;n.eachBefore(function(k){k.x<c.x&&(c=k),k.x>t.x&&(t=k),k.depth>m.depth&&(m=k)});var l=c===t?1:e(c,t)/2,g=l-c.x,v=i/(t.x+l+g),x=s/(m.depth||1);n.eachBefore(function(k){k.x=(k.x+g)*v,k.y=k.depth*x})}return n}function r(n){var d=n.children,c=n.parent.children,t=n.i?c[n.i-1]:null;if(d){He(n);var m=(d[0].z+d[d.length-1].z)/2;t?(n.z=t.z+e(n._,t._),n.m=n.z-m):n.z=m}else t&&(n.z=t.z+e(n._,t._));n.parent.A=f(n,t,n.parent.A||c[0])}function o(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function f(n,d,c){if(d){for(var t=n,m=n,l=d,g=t.parent.children[0],v=t.m,x=m.m,k=l.m,A=g.m,y;l=$(l),t=P(t),l&&t;)g=P(g),m=$(m),m.a=n,y=l.z+k-t.z-v+e(l._,t._),y>0&&(je(Ve(l,n,c),n,y),v+=y,x+=y),k+=l.m,v+=t.m,A+=g.m,x+=m.m;l&&!$(m)&&(m.t=l,m.m+=k-x),t&&!P(g)&&(g.t=t,g.m+=v-A,c=n)}return c}function p(n){n.x*=i,n.y=n.depth*s}return h.separation=function(n){return arguments.length?(e=n,h):e},h.size=function(n){return arguments.length?(a=!1,i=+n[0],s=+n[1],h):a?null:[i,s]},h.nodeSize=function(n){return arguments.length?(a=!0,i=+n[0],s=+n[1],h):a?[i,s]:null},h}function C(e,i,s){this.k=e,this.x=i,this.y=s}C.prototype={constructor:C,scale:function(e){return e===1?this:new C(this.k*e,this.x,this.y)},translate:function(e,i){return e===0&i===0?this:new C(this.k,this.x+this.k*e,this.y+this.k*i)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};C.prototype;const Ye={setup(){const e=ee(),i=re(),s=de();return{userDetailsStore:e,skillTreeStore:i,skillTagsStore:s}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,regularLockedUnmasteredNodeSprite:null,radius:0,width:null,height:null,radiusMultiplier:16,firstLevelNodeSize:100,regularNodeSize:50,subSkillRadius:50,skill:{id:null,children:[],isMastered:null,isUnlocked:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:ye,SkillPanel:ae},async mounted(){document.getElementById("reset-button").addEventListener("click",()=>{this.resetTree()}),this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills(),this.width=window.innerWidth,this.height=window.innerHeight,this.radius=Math.min(this.width,this.height)/2,document.querySelector("#skilltree").appendChild(this.$pixiApp.view);const e=new oe({screenWidth:this.width,screenHeight:this.height,worldWidth:this.width,worldHeight:this.height,events:this.$pixiApp.renderer.events});this.$pixiApp.stage.addChild(e),e.center=new ie(0,0),e.drag().pinch().wheel().decelerate().clampZoom({minScale:.05,maxScale:10});const i=u.from("center-node.png");this.skill={name:"SKILLS",sprite:i,children:this.skillTreeStore.userSkills},this.getAlgorithm()},methods:{getAlgorithm(){var e=[];e=JSON.parse(JSON.stringify(this.skill.children));function i(d){for(var c=d.length;c--;)d[c].type=="sub"&&d.splice(c,1),typeof d[c]<"u"&&d[c].children&&Array.isArray(d[c].children)&&d[c].children.length>0&&i(d[c].children)}i(e);var s={name:null,children:e};const h=Xe().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((d,c)=>(d.parent==c.parent,1/d.depth))(M(s));var r=[];function o(d,c){for(let t=0;t<d.length;t++)d[t].type!="sub"&&r.push(d[t]),o(d[t].children)}o(e);for(let d=0;d<r.length;d++)r[d].x=h.descendants()[d+1].x,r[d].y=h.descendants()[d+1].y;for(var f=0;f<r.length;f++)if(r[f].children=[],r[f].parent!=null&&r[f].parent!=0){var p=r[f].parent;for(let d=0;d<r.length;d++)r[d].id==p&&r[d].children.push(r[f])}let n=[];for(var f=0;f<r.length;f++)(r[f].parent==null||r[f].parent==0)&&n.push(r[f]);this.skill.children=n,this.drawChart(h)},drawChart(e){for(let p=0;p<e.links().length;p++){const n=new te;n.lineStyle(2,16777215,1);var i=Math.cos(e.links()[p].source.x)*e.links()[p].source.y,s=Math.sin(e.links()[p].source.x)*e.links()[p].source.y;n.moveTo(i,s);var a=Math.cos(e.links()[p].target.x)*e.links()[p].target.y,h=Math.sin(e.links()[p].target.x)*e.links()[p].target.y;n.lineTo(a,h),this.$pixiApp.stage.children[0].addChild(n),this.stageContents.push(n)}const r=this.skill.sprite;r.x=e.x,r.y=e.y,r.anchor.set(.5),this.isRecentered==!1?r.scale.set(.5):r.scale.set(1),this.$pixiApp.stage.children[0].addChild(r),this.stageContents.push(r);let o=new D(this.skill.name,{fontFamily:"Poppins900",fontSize:40,fill:0,align:"center"});o.anchor.set(.5),o.x=e.x,o.y=e.y,o.scale.x=.2,o.scale.y=.2,this.$pixiApp.stage.children[0].addChild(o),this.stageContents.push(o);function f(p,n,d,c){d++;for(let[m,l]of n.entries()){let g=new U;g.x=Math.cos(l.x)*l.y,g.y=Math.sin(l.x)*l.y;var t=new u;l.level=="grade_school"?l.is_mastered?t=u.from("images/skill-tree-nodes/grade-school-mastered.png"):l.is_accessible?t=u.from("images/skill-tree-nodes/grade-school-unlocked.png"):t=u.from("images/skill-tree-nodes/grade-school-locked.png"):l.level=="middle_school"?l.is_mastered?t=u.from("images/skill-tree-nodes/middle-school-mastered.png"):l.is_accessible?t=u.from("images/skill-tree-nodes/middle-school-unlocked.png"):t=u.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="high_school"?l.is_mastered?t=u.from("images/skill-tree-nodes/high-school-mastered.png"):l.is_accessible?t=u.from("images/skill-tree-nodes/middle-school-unlocked.png"):t=u.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="college"?l.is_mastered?t=u.from("images/skill-tree-nodes/college-mastered.png"):l.is_accessible?t=u.from("images/skill-tree-nodes/middle-school-unlocked.png"):t=u.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="phd"?l.is_mastered?t=u.from("images/skill-tree-nodes/phd-mastered.png"):l.is_accessible?t=u.from("images/skill-tree-nodes/middle-school-unlocked.png"):t=u.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="domain"&&(t=u.from("images/skill-tree-nodes/domain.png"));let v=0,x=0;for(let _=0;_<l.children.length;_++)l.children[_].type!="sub"?v++:x++;d==1?(t.width=c.firstLevelNodeSize,t.height=c.firstLevelNodeSize):(t.width=c.regularNodeSize,t.height=c.regularNodeSize),t.anchor.set(.5),g.addChild(t);let k=40;const A=l.skill_name.split(" ");for(let _=0;_<A.length;_++)A[_].length>9&&(k=30);l.skill_name=l.skill_name.replace(/(.*?\s)/g,`$1
`);let y=new D(l.skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:k,fill:16777215,align:"center"});y.anchor.set(.5),y.scale.x=.2,y.scale.y=.2,g.addChild(y),t.eventMode="static",y.eventMode="static",t.cursor="pointer",y.cursor="pointer",y.on("pointerdown",_=>{var w={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:g,name:l.skill_name,description:l.description,tagIDs:[],sprite:t};if(c.skill=w,!c.isSkillInfoPanelShown){let T=function(){c.recenterTree()};c.skill=w,c.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",T)}}),t.on("pointerdown",_=>{var w={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:g,name:l.skill_name,description:l.description,tagIDs:[],sprite:t};if(c.skill=w,!c.isSkillInfoPanelShown){let T=function(){c.recenterTree()};c.skill=w,c.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",T)}}),c.$pixiApp.stage.children[0].addChild(g),c.stageContents.push(g);for(let _=0;_<l.children.length;_++)if(l.children[_].type=="sub"){let w=new U,T=360/x,O=_-v,F=T*O*Math.PI/180,L,E;L=c.subSkillRadius*Math.cos(F),E=c.subSkillRadius*Math.sin(F),w.x=L,w.y=E;var t=new u;l.level=="grade_school"?l.is_mastered?t=u.from("images/skill-tree-nodes/grade-school-small-mastered.png"):l.is_accessible?t=u.from("images/skill-tree-nodes/grade-school-small-unlocked.png"):t=u.from("images/skill-tree-nodes/grade-school-small-locked.png"):l.level=="middle_school"?l.is_mastered?t=u.from("images/skill-tree-nodes/middle-school-small-mastered.png"):l.is_accessible?t=u.from("images/skill-tree-nodes/middle-school-small-unlocked.png"):t=u.from("images/skill-tree-nodes/middle-school-small-locked.png"):l.level=="high_school"?l.is_mastered?t=u.from("images/skill-tree-nodes/high-school-small-mastered.png"):l.is_accessible?t=u.from("images/skill-tree-nodes/high-school-small-unlocked.png"):t=u.from("images/skill-tree-nodes/high-school-small-locked.png"):l.level=="college"?l.is_mastered?t=u.from("images/skill-tree-nodes/college-smal-mastered.png"):l.is_accessible?t=u.from("images/skill-tree-nodes/college-small-unlocked.png"):t=u.from("images/skill-tree-nodes/college-small-locked.png"):l.level=="phd"&&(l.is_mastered?t=u.from("images/skill-tree-nodes/phd-small-mastered.png"):l.is_accessible?t=u.from("images/skill-tree-nodes/phd-small-unlocked.png"):t=u.from("images/skill-tree-nodes/phd-small-locked.png")),t.width=15,t.height=15,t.anchor.set(.5),w.addChild(t),g.addChild(w)}l.children&&Array.isArray(l.children)&&l.children.length>0&&f(p,l.children,d,c)}}f(e.children,this.skill.children,0,this)},recenterTree(){this.isRecentered=!0,this.radiusMultiplier=1;for(let e=0;e<this.stageContents.length;e++)this.stageContents[e].destroy();this.hideInfoPanel(),this.getAlgorithm()},resetTree(){this.isRecentered=!1,this.radiusMultiplier=4,this.$pixiApp.stage.children[0].removeChildren();const e=u.from("center-node.png");this.skill={name:"SKILLS",sprite:e,children:this.skillTreeStore.userSkills},this.getAlgorithm()},showInfoPanel(){this.isSkillInfoPanelShown||(screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",document.getElementById("sidepanel-backdrop").style.display="block",this.isSkillInfoPanelShown=!0,document.getElementById("skillDescription"),document.getElementById("skillLink"))},hideInfoPanel(){this.isSkillInfoPanelShown&&(screen.width>800?document.getElementById("skillInfoPanel").style.width="0px":document.getElementById("skillInfoPanel").style.height="0px",document.getElementById("sidepanel-backdrop").style.display="none",this.isSkillInfoPanelShown=!1)},async filterSkills(e){var i=[];function s(n,d){for(let c=0;c<n.length;c++)i.push(n[c]),s(n[c].children)}s(this.skill.children);var a=0;for(let n=0;n<i.length;n++){let d=i[n];h(d,d.parent,e),i[n].parent=a}function h(n,d,c,t){for(let m=0;m<i.length;m++)if(i[m].id==d){let l=i[m];l.level==c?(a=l.parent,h(n,a,c)):a=l.id}}let r=[];for(var o=0;o<i.length;o++)i[o].level!=e&&r.push(i[o]);for(var o=0;o<r.length;o++)if(r[o].children=[],r[o].parent!=null&&r[o].parent!=0){var f=r[o].parent;for(let d=0;d<r.length;d++)r[d].id==f&&r[d].children.push(r[o])}let p=[];for(var o=0;o<r.length;o++)(r[o].parent==null||r[o].parent==0)&&p.push(r[o]);this.skill.children=p;for(let n=0;n<this.stageContents.length;n++)this.stageContents[n].destroy();this.applyFilter()},applyFilter(){this.$pixiApp.stage.children[0].removeChildren();const e=u.from("center-node.png");this.skill={name:"SKILLS",sprite:e,children:this.skill.children},this.getAlgorithm()}}},Ke=e=>(X("data-v-5d1063ad"),e=e(),Y(),e),Oe={class:"flex-container skill-tree-container"},Je={id:"reset-button",class:"btn btn-info"},qe={id:"wrapper"},Ze={id:"skilltree"},Qe=Ke(()=>S("div",{id:"sidepanel-backdrop"},null,-1));function Ge(e,i,s,a,h,r){const o=R("SkillTreeFilter"),f=R("SkillPanel");return b(),I("div",Oe,[B(o,{id:"filter"}),W(S("button",Je,"Reset",512),[[le,h.isRecentered]]),S("div",qe,[S("div",Ze,[B(f,{skill:h.skill},null,8,["skill"])]),Qe])])}const ei=H(Ye,[["render",Ge],["__scopeId","data-v-5d1063ad"]]);const ii=S("div",{id:"purple-banner"},null,-1),ti=S("span",null,"Loading...",-1),ai={__name:"SkillTreeView",setup(e){return(i,s)=>(b(),I(V,null,[ii,(b(),se(ne,null,{default:j(()=>[B(ei)]),fallback:j(()=>[ti]),_:1}))],64))}};export{ai as default};
