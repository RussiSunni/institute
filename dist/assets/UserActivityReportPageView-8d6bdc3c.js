import{_ as g,s as $,r as w,o as i,c as l,b as o,F as v,n as x,t as c,B as k,q as d,a as h,d as _,g as p,f as S,i as Q,T as y}from"./main-bed2c947.js";import{u as D,a as C,b as N}from"./EssayQuestionsStore-aca59f7c.js";const j={props:["userId","deleteFlag"],setup(){const e=$(),n=D(),a=C(),u=N();return{skillsStore:e,resourcesStore:n,mcQuestionsStore:a,essayQuestionsStore:u}},data(){return{contentFlags:[],rows:[]}},components:{},async created(){},async mounted(){await this.getContentFlagLogs(),this.contentFlags.forEach(e=>{const n=JSON.parse(e.content_obj),a=new Date(e.create_date),u=a.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),r={date:a.toLocaleTimeString()+` (${u})`,action:e.action,questionName:n.question,skillName:n.name,id:e.id};switch(e.flag_type){case"mc_question":r.type="mc_question",r.questionId=n.question_id,r.skillId=n.skill_id;break;case"resource":r.type="resource",r.skillId=n.skill_id;break;case"skill":r.type="skill",r.skillId=n.skill_id;break;default:r.type="delete";break}this.rows.push(r)})},methods:{async getContentFlagLogs(){const e=await fetch(`/user-actions/${this.userId}/flag`);this.contentFlags=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},U={key:0,class:"container-md main-container"},L={class:"d-flex flex-column gap-3"},T={class:"d-flex"},A={class:"d-flex w-fit me-1"},R={key:0,class:"d-flex flex-wrap ml-1"},O={key:0},B={key:1,class:"d-flex flex-wrap ml-1"},E={key:2,class:"d-flex flex-wrap ml-1"},W={key:3,class:"d-flex flex-wrap ml-1"},z={key:1,class:"shake"};function V(e,n,a,u,s,r){const m=w("router-link");return s.rows.length?(i(),l("div",U,[o("div",L,[(i(!0),l(v,null,x(s.rows,t=>(i(),l("div",T,[o("div",A,c(t.date),1),t.type==="skill"?(i(),l("div",R,[o("span",{class:k(r.actionColor(t.action))}," - "+c(t.action),3),d("   "),t.action=="delete"?(i(),l("span",O," flag with id: "+c(t.id),1)):h("",!0),d("flag on skill:  "),_(m,{class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"])])):h("",!0),t.type==="resource"?(i(),l("div",B,[o("span",{class:k(r.actionColor(t.action))}," - "+c(t.action),3),d("  flag on resource of skill:  "),_(m,{class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"])])):h("",!0),t.type==="mc_question"?(i(),l("div",E,[o("span",{class:k(r.actionColor(t.action))}," - "+c(t.action),3),d("  flag on mc_question: "),_(m,{class:"question-link",target:"_blank",to:`/skills/${t.skillId}/question-bank`},{default:p(()=>[d(c(t.questionName),1)]),_:2},1032,["to"]),d(" on skill:  "),_(m,{class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"])])):h("",!0),t.type==="delete"?(i(),l("div",W,[o("span",{class:k(r.actionColor(t.action)+" me-1")}," - "+c(t.action),3),d(" flag with id "+c(t.id),1)])):h("",!0)]))),256))])])):(i(),l("div",z,"The user has no action on flags"))}const H=g(j,[["render",V]]),J={props:["userId","deleteResource"],data(){return{resourcesData:[],rows:[],showWarnModal:!1}},components:{},async created(){await this.getResourceLogs(),this.resourcesData.forEach(e=>{const n=JSON.parse(e.content_obj),a=new Date(e.create_date),u=a.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),s=a.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:u,time:s,id:e.id,is_deleted:n.is_deleted})})},methods:{async getResourceLogs(){const e=await fetch(`/user-actions/${this.userId}/resource`);this.resourcesData=await e.json(),console.log(this.resourcesData)},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},q={key:0,class:"container-md main-container"},P={class:"d-flex flex-column"},K=o("span",null," resource in forum of skill: ",-1),G={key:1,class:"shake"},X={key:2},Y={id:"myModal",class:"modal"},Z={class:"modal-content"},F=o("div",{class:"d-flex gap-4 justify-content-center mb-4"},[o("div",{class:"modal-label"},"This skill is deleted !!")],-1),ee={class:"d-flex justify-content-center"},se=o("div",null,"OK",-1),te=[se];function oe(e,n,a,u,s,r){const m=w("router-link");return i(),l(v,null,[s.rows.length?(i(),l("div",q,[o("div",P,[(i(!0),l(v,null,x(s.rows,t=>(i(),l("div",null,[d(c(t.time)+" ("+c(t.date)+") - ",1),o("span",{class:k(r.actionColor(t.action))},c(t.action),3),K,t.action==="delete"||t.is_deleted===1?(i(),l("span",{key:0,class:"skill-link",onClick:n[0]||(n[0]=b=>s.showWarnModal=!0)},c(t.skillName),1)):(i(),S(m,{key:1,class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"]))]))),256))])])):(i(),l("div",G,"The user has no action on resource")),s.showWarnModal?(i(),l("div",X,[o("div",Y,[o("div",Z,[F,o("div",ee,[o("button",{type:"button",class:"btn green-btn w-25",onClick:n[1]||(n[1]=t=>s.showWarnModal=!1)},te)])])])])):h("",!0)],64)}const ne=g(J,[["render",oe]]),ie={props:["userId","deleteMcQuestion"],data(){return{questionsData:[],rows:[]}},components:{},async created(){await this.getMcQuestionsLog(),this.questionsData.forEach(e=>{const n=JSON.parse(e.content_obj),a=new Date(e.create_date),u=a.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),s=a.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:u,time:s,id:e.id,studentName:n.student_name,studentId:n.student_id,type:e.content_type})})},methods:{async getMcQuestionsLog(){const e=await fetch(`/user-actions/${this.userId}/question`);this.questionsData=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";case"bulk-create":return"bulk-create-action";default:return"delete-action"}}}},le={key:0,class:"container-md main-container"},ce={class:"d-flex flex-column"},re={key:0},ae={key:1},de={key:1,class:"shake"};function ue(e,n,a,u,s,r){const m=w("router-link");return s.rows.length>0?(i(),l("div",le,[o("div",ce,[(i(!0),l(v,null,x(s.rows,t=>(i(),l("div",null,[d(c(t.time)+" ("+c(t.date)+") ",1),o("span",{class:k(r.actionColor(t.action))}," - "+c(t.action),3),t.type==="mc_question"?(i(),l("span",re," mc_question in question bank of skill: ")):h("",!0),t.type==="essay_question"?(i(),l("span",ae," essay question in question bank of skill: ")):h("",!0),_(m,{class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"])]))),256))])])):(i(),l("div",de," The user has no action on multiple-choice questions "))}const _e=g(ie,[["render",ue]]),he={props:["userId","deleteResource"],data(){return{skillsData:[],rows:[],showWarnModal:!1}},components:{},async created(){await this.getSkillLogs(),this.skillsData.forEach(e=>{console.log(e);const n=JSON.parse(e.content_obj),a=new Date(e.create_date),u=a.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),s=a.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:u,time:s,id:e.id,is_deleted:n.is_deleted})})},methods:{async getSkillLogs(){const e=await fetch(`/user-actions/${this.userId}/skill`);this.skillsData=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},me={key:0,class:"container-md main-container"},pe={class:"d-flex flex-column"},ke=o("span",null," skill: ",-1),we={key:1,class:"shake"},fe={key:2},ve={id:"myModal",class:"modal"},ge={class:"modal-content"},ye=o("div",{class:"d-flex gap-4 justify-content-center mb-4"},[o("div",{class:"modal-label"},"This skill is deleted !!")],-1),xe={class:"d-flex justify-content-center"},be=o("div",null,"OK",-1),Se=[be];function Me(e,n,a,u,s,r){const m=w("router-link");return i(),l(v,null,[s.rows.length?(i(),l("div",me,[o("div",pe,[(i(!0),l(v,null,x(s.rows,t=>(i(),l("div",null,[d(c(t.time)+" ("+c(t.date)+") - ",1),o("span",{class:k(r.actionColor(t.action))},c(t.action),3),ke,t.action==="delete"||t.is_deleted===1?(i(),l("span",{key:0,class:"skill-link",onClick:n[0]||(n[0]=b=>s.showWarnModal=!0)},c(t.skillName),1)):(i(),S(m,{key:1,class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"]))]))),256))])])):(i(),l("div",we,"The user has no action on skill")),s.showWarnModal?(i(),l("div",fe,[o("div",ve,[o("div",ge,[ye,o("div",xe,[o("button",{type:"button",class:"btn green-btn w-25",onClick:n[1]||(n[1]=t=>s.showWarnModal=!1)},Se)])])])])):h("",!0)],64)}const Ie=g(he,[["render",Me]]),$e={props:["userId","deleteMcQuestion"],data(){return{questionsData:[],rows:[]}},components:{},async created(){await this.getMcQuestionsLog(),this.questionsData.forEach(e=>{e.action==="update"&&console.log(e);const n=JSON.parse(e.content_obj),a=new Date(e.create_date),u=a.toLocaleString("en-gb",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),s=a.toLocaleTimeString();this.rows.push({skillName:n.skill_name,resourceId:e.content_id,skillId:n.skill_id,action:e.action,date:u,time:s,id:e.id,studentName:n.student_name,studentId:n.student_id})})},methods:{async getMcQuestionsLog(){const e=await fetch(`/user-actions/${this.userId}/student_mc_question`);this.questionsData=await e.json()},actionColor(e){switch(e){case"create":return"create-action";case"update":return"update-action";default:return"delete-action"}}}},Qe={key:0,class:"container-md main-container"},De={class:"d-flex flex-column"},Ce={key:0},Ne={key:1},je={key:2},Ue={key:1,class:"shake"};function Le(e,n,a,u,s,r){const m=w("router-link");return s.rows.length>0?(i(),l("div",Qe,[o("div",De,[(i(!0),l(v,null,x(s.rows,t=>(i(),l("div",null,[d(c(t.time)+" ("+c(t.date)+") ",1),o("span",{class:k(r.actionColor(t.action))}," - "+c(t.action),3),t.action==="delete"?(i(),l("span",Ce," student mc_question with id "+c(t.id),1)):t.action==="create"?(i(),l("span",Ne," student mc_question for skill: ")):(i(),l("span",je,[d(" mc question of student "),_(m,{class:"user-link",target:"_blank",to:"/users"},{default:p(()=>[d(c(t.studentName),1)]),_:2},1024),d(" on skill: ")])),_(m,{class:"skill-link",target:"_blank",to:`/skills/${t.skillId}`},{default:p(()=>[d(c(t.skillName),1)]),_:2},1032,["to"])]))),256))])])):(i(),l("div",Ue," The user has no action on multiple-choice questions "))}const Te=g($e,[["render",Le]]);const Ae={setup(){return{usersStore:Q()}},data(){return{user:{id:this.$route.params.id,firstName:null,lastName:null,username:null,role:null,avatar:null},showFlags:!1,showSources:!1,showMcQuestions:!1,showStudentMcQuestions:!1,showSkills:!1,mcQuestions:[],resources:[],flags:[],skillEdits:[]}},components:{UserFlagActions:H,UserResourceActions:ne,UserQuestionActions:_e,UserStudentMcQuestionActions:Te,UserSkillActions:Ie},async created(){await this.getUserDetails()},methods:{async getUserDetails(){this.usersStore.users.length<1&&await this.usersStore.getUsers();for(let e=0;e<this.usersStore.users.length;e++)this.usersStore.users[e].id==this.user.id&&(this.user.firstName=this.usersStore.users[e].first_name,this.user.lastName=this.usersStore.users[e].last_name,this.user.username=this.usersStore.users[e].username,this.user.role=this.usersStore.users[e].role,this.user.avatar=this.usersStore.users[e].avatar)}}},Re={class:"container"},Oe=o("div",{class:"mt-4 mb-4"},[o("h1",null,"User Activity Report")],-1),Be={class:"row"},Ee={class:"d-flex flex-column flex-md-row gap-3"},We=["src"],ze={class:"d-flex flex-column"},Ve={id:"user-name"},He={id:"role"},Je={class:"d-flex flex-column"},qe={class:"d-flex flex-row justify-content-between"},Pe=["title"],Ke=o("span",null," Flags ",-1),Ge=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),Xe=[Ge],Ye={key:0},Ze=o("hr",{class:"mt-5 mb-3"},null,-1),Fe={key:0,class:"d-flex flex-column"},es={class:"d-flex flex-row justify-content-between"},ss=["title"],ts=o("span",null,"Questions ",-1),os=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),ns=[os],is={key:0},ls={key:1,class:"mt-5 mb-3"},cs={class:"d-flex flex-column"},rs={class:"d-flex flex-row justify-content-between"},as=["title"],ds=o("span",null,"Student MC Questions ",-1),us=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),_s=[us],hs={key:0},ms=o("hr",{class:"mt-5 mb-3"},null,-1),ps={class:"d-flex flex-column"},ks={class:"d-flex flex-row justify-content-between"},ws=["title"],fs=o("span",null," Resources ",-1),vs=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),gs=[vs],ys={key:0},xs=o("hr",{class:"mt-5 mb-3"},null,-1),bs={class:"d-flex flex-column"},Ss={class:"d-flex flex-row justify-content-between"},Ms=["title"],Is=o("span",null," Skills ",-1),$s=o("path",{d:"M182.6 137.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-9.2 9.2-11.9 22.9-6.9 34.9s16.6 19.8 29.6 19.8H288c12.9 0 24.6-7.8 29.6-19.8s2.2-25.7-6.9-34.9l-128-128z"},null,-1),Qs=[$s],Ds={key:0},Cs=o("hr",{class:"mt-5 mb-3"},null,-1);function Ns(e,n,a,u,s,r){const m=w("UserFlagActions"),t=w("UserQuestionActions"),b=w("UserStudentMcQuestionActions"),M=w("UserResourceActions"),I=w("UserSkillActions");return i(),l("div",Re,[Oe,o("div",Be,[o("div",Ee,[o("img",{id:"activity-report-user-avatar",src:s.user.avatar},null,8,We),o("div",ze,[o("div",Ve,c(s.user.username),1),o("div",He,c(s.user.role),1)])])]),o("div",null,[o("div",Je,[o("div",qe,[o("div",{class:"log-type",onClick:n[0]||(n[0]=f=>s.showFlags=!s.showFlags),"b-on-hover":"",title:s.showFlags?"collapse":"expand"},[Ke,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:k([s.showFlags?"arrow-point-down mb-2":"arrow-point-up "])},Xe,2))],8,Pe)]),_(y,{name:"dropdown"},{default:p(()=>[s.showFlags?(i(),l("div",Ye,[_(m,{ref:"contentFlagsPerUser",userId:s.user.id,deleteFlag:e.deleteFlag,onCloseFlagDiv:n[1]||(n[1]=f=>s.showFlags=!1)},null,8,["userId","deleteFlag"])])):h("",!0)]),_:1})]),Ze,s.user.role==="admin"?(i(),l("div",Fe,[o("div",es,[o("div",{class:"log-type",onClick:n[2]||(n[2]=f=>s.showMcQuestions=!s.showMcQuestions),"b-on-hover":"",title:s.showMcQuestions?"collapse":"expand"},[ts,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:k([s.showMcQuestions?"arrow-point-down mb-2":"arrow-point-up"])},ns,2))],8,ss)]),_(y,{name:"dropdown"},{default:p(()=>[s.showMcQuestions?(i(),l("div",is,[_(t,{userId:s.user.id,deleteMcQuestion:e.deleteMcQuestion,onCloseMcQuestionDiv:n[3]||(n[3]=f=>s.showMcQuestions=!1)},null,8,["userId","deleteMcQuestion"])])):h("",!0)]),_:1})])):h("",!0),s.user.role==="admin"?(i(),l("hr",ls)):h("",!0),o("div",cs,[o("div",rs,[o("div",{class:"log-type",onClick:n[4]||(n[4]=f=>s.showStudentMcQuestions=!s.showStudentMcQuestions),"b-on-hover":"",title:s.showStudentMcQuestions?"collapse":"expand"},[ds,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:k([s.showStudentMcQuestions?"arrow-point-down mb-2":"arrow-point-up"])},_s,2))],8,as)]),_(y,{name:"dropdown"},{default:p(()=>[s.showStudentMcQuestions?(i(),l("div",hs,[_(b,{userId:s.user.id,deleteMcQuestion:e.deleteMcQuestion,onCloseMcQuestionDiv:n[5]||(n[5]=f=>s.showStudentMcQuestions=!1)},null,8,["userId","deleteMcQuestion"])])):h("",!0)]),_:1})]),ms,o("div",ps,[o("div",ks,[o("div",{class:"log-type",onClick:n[6]||(n[6]=f=>s.showSources=!s.showSources),"b-on-hover":"",title:s.showSources?"collapse":"expand"},[fs,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:k([s.showSources?"arrow-point-down mb-2":"arrow-point-up "])},gs,2))],8,ws)]),_(y,{name:"dropdown"},{default:p(()=>[s.showSources?(i(),l("div",ys,[_(M,{userId:s.user.id,deleteResource:e.deleteResource,onCloseResourceDiv:n[7]||(n[7]=f=>s.showSources=!1)},null,8,["userId","deleteResource"])])):h("",!0)]),_:1})]),xs,o("div",bs,[o("div",Ss,[o("div",{class:"log-type",onClick:n[8]||(n[8]=f=>s.showSkills=!s.showSkills),"b-on-hover":"",title:s.showSkills?"collapse":"expand"},[Is,(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 320 512",width:"22",height:"22",fill:"#667085",class:k([s.showSkills?"arrow-point-down mb-2":"arrow-point-up "])},Qs,2))],8,Ms)]),_(y,{name:"dropdown"},{default:p(()=>[s.showSkills?(i(),l("div",Ds,[_(I,{userId:s.user.id,onCloseResourceDiv:n[9]||(n[9]=f=>s.showSkills=!1)},null,8,["userId"])])):h("",!0)]),_:1})]),Cs])])}const Ls=g(Ae,[["render",Ns]]);export{Ls as default};
