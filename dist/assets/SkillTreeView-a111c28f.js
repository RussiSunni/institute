import{d as we,_ as de,o as b,c as B,a as d,w as re,v as ne,F as ce,r as Ie,t as xe,p as ke,b as fe,u as Me,e as ae,f as q,g as Te,h as oe,S as De}from"./main-d668635f.js";import{u as Ce}from"./SkillTreeStore-bcf0daeb.js";import{u as be}from"./TagsStore-472c2aba.js";import{S as Pe,F as Fe,A as Ne,h as Be,G as C,a as $e,T as O,C as he}from"./fontfaceobserver.standalone-494a4bf2.js";const Ee=we("skillTags",{state:()=>({skillTagsList:[]}),actions:{async getSkillTagsList(){const l=await(await fetch("/skill-tags/list")).json();this.skillTagsList=l}}});const He={setup(){return{tagsStore:be()}},data(){return{filters:[],checkedFilters:[]}},async created(){},async mounted(){await this.tagsStore.getTagsList()},methods:{applyFilter:function(){this.$parent.applyFilter(this.checkedFilters)}}},ve=e=>(ke("data-v-b0180a46"),e=e(),fe(),e),Ue={id:"filters"},je=ve(()=>d("h1",{id:"filterMainHeader",class:"mb-2"},"My Skills Tree",-1)),We={class:"form-check"},Ve=ve(()=>d("label",{class:"form-check-label",for:"flexCheckDefault"}," Mastered and available skills ",-1)),Re={class:"form-check"},Ge=["value"],ze={class:"form-check-label",for:"flexCheckDefault"};function Oe(e,l,i,t,c,v){return b(),B("div",Ue,[je,d("div",We,[re(d("input",{class:"form-check-input",type:"checkbox",value:0,id:"flexCheckDefault","onUpdate:modelValue":l[0]||(l[0]=a=>c.checkedFilters=a),onChange:l[1]||(l[1]=a=>v.applyFilter())},null,544),[[ne,c.checkedFilters]]),Ve]),(b(!0),B(ce,null,Ie(this.tagsStore.tagsList,a=>(b(),B("div",null,[d("div",Re,[re(d("input",{class:"form-check-input",type:"checkbox",value:a.id,id:"flexCheckDefault","onUpdate:modelValue":l[2]||(l[2]=k=>c.checkedFilters=k),onChange:l[3]||(l[3]=k=>v.applyFilter())},null,40,Ge),[[ne,c.checkedFilters]]),d("label",ze,xe(a.name),1)])]))),256))])}const qe=de(He,[["render",Oe],["__scopeId","data-v-b0180a46"]]);const Ke={setup(){const e=Me(),l=Ce(),i=Ee();return{userDetailsStore:e,skillTreeStore:l,skillTagsStore:i}},data(){return{userId:this.userDetailsStore.userId,firstLevelNodeRadius:36,otherLevelNodeRadius:17,firstLevelCircleRadius:300,nodeDistance:300,subSkillDistance:75,firstLevelSkillsArray:[],firstLevelSkillsConnectingLinesArray:[],secondLevelSkillsArray:[],secondLevelSkillsConnectingLinesArray:[],thirdLevelSkillsArray:[],thirdLevelSkillsConnectingLinesArray:[],fourthLevelSkillsArray:[],fourthLevelSkillsConnectingLinesArray:[],isSkillInfoPanelShown:!1}},components:{SkillTreeFilter:qe,SkillPanel:Pe},async mounted(){await this.skillTreeStore.getUserSkills(),await this.skillTagsStore.getSkillTagsList(),new Fe("Poppins900",{}).load().then(()=>{const l=document.getElementById("skilltree"),i=new Ne({resizeTo:l,antialias:!0,useContextAlpha:!1});var t=window.getComputedStyle(document.getElementById("skilltree"),null),c=t.getPropertyValue("width"),v=t.getPropertyValue("height");const a=new Be({screenWidth:window.innerWidth,screenHeight:window.innerHeight,worldWidth:c,worldHeight:v,events:i.renderer.events});a.sortableChildren=!0,i.stage.addChild(a),a.drag().pinch().wheel().clampZoom({minScale:.2,maxScale:4}),l.appendChild(i.view);let k=new C;k.lineStyle(3,13162458,1),k.beginFill(16777215,1),k.drawCircle(window.innerWidth/2,window.innerHeight/2,65),k.endFill(),a.addChild(k);const P=$e.from("center-node.png");P.x=window.innerWidth/2,P.y=window.innerHeight/2,P.anchor.set(.5),P.scale.set(.15),a.addChild(P);let x=new O("SKILLS",{fontFamily:"Poppins900",fontSize:90,fill:0,align:"center"});x.anchor.set(.5),x.x=window.innerWidth/2,x.y=window.innerHeight/2,x.scale.x=.2,x.scale.y=.2,a.addChild(x);var K=this.skillTreeStore.userSkills.length;for(let $=0;$<K;$++){let Y=function(s,W,Ae,E,H,N,m){N++;let ee={depth:N,skills:[]};E=E+W.x,H=H+W.y;let le=300,ie=75,me=17;for(let[g,f]of s.entries()){let r=new he,T=0,V=0;for(let o=0;o<s.length;o++)s[o].type!="sub"?T++:V++;let _=0;if(f.type!="sub"){let o=0;N==1?o=135/T:o=90/T;let R=g-V;_=Ae+o*R,N==1?_=_-67.5+67.5/T:_=_-45+45/T;let G=_*Math.PI/180,j=r.x+le*Math.cos(G),z=r.y+le*Math.sin(G);r.x=r.x+j,r.y=r.y+z,ee.skills.push(r)}else{let o=360/V,R=g-T,j=o*R*Math.PI/180,z=r.x+ie*Math.cos(j),_e=r.y+ie*Math.sin(j);r.x=r.x+z,r.y=r.y+_e}let w=new C;var M;s[g].is_mastered==1?M="0x"+n.mastered_color:s[g].is_accessible==1?(w.lineStyle(1,"0x"+n.mastered_color,1),M="0x"+n.unlocked_color):M="0xD9D9D9",w.beginFill(M),w.drawCircle(0,0,me),r.addChild(w);let te=40;const se=s[g].skill_name.split(" ");for(let o=0;o<se.length;o++)se[o].length>9&&(te=37);s[g].skill_name=s[g].skill_name.replace(/(.*?\s)/g,`$1
`);let I=new O(s[g].skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:te,fill:16777215,align:"center"});I.anchor.set(.5),I.scale.x=.1,I.scale.y=.1,r.addChild(I);let U={id:f.id,isMastered:f.is_mastered,isUnlocked:f.is_accessible,color:M,container:r,name:f.skill_name,description:f.description,tagIDs:[]};w.eventMode="static",I.eventMode="static",w.cursor="pointer",I.cursor="pointer",I.on("pointerdown",o=>{m.isSkillInfoPanelShown?m.updateInfoPanel(U):m.showInfoPanel(U)}),w.on("pointerdown",o=>{m.isSkillInfoPanelShown?m.updateInfoPanel(U):m.showInfoPanel(U)}),W.addChild(r);const D=new C;D.lineStyle(2,M,1),D.position.x=E,D.position.y=H,D.lineTo(r.x,r.y),D.zIndex=-1,a.addChild(D),X.push(ee),f.children&&Array.isArray(f.children)&&f.children.length>0&&Y(f.children,r,_,E,H,N,m)}},n=this.skillTreeStore.userSkills[$],S=new C;var L;n.is_mastered==1?L="0x"+n.mastered_color:n.is_accessible==1?(S.lineStyle(1,"0x"+n.mastered_color,1),L="0x"+n.unlocked_color):L="0xD9D9D9";var ye=Math.PI*2/K,F=ye*$,Se=65*Math.cos(F),pe=65*Math.sin(F);let y=new C;y.x=window.innerWidth/2+Se,y.y=window.innerHeight/2+pe,y.beginFill(L),y.drawCircle(0,0,7.5),a.addChild(y);var ge=this.firstLevelCircleRadius*Math.cos(F),Le=this.firstLevelCircleRadius*Math.sin(F),h=new he;h.x=window.innerWidth/2+ge,h.y=window.innerHeight/2+Le,S.beginFill(L),S.drawCircle(0,0,this.firstLevelNodeRadius),S.endFill();const p=new C;p.lineStyle(2,L,1),p.position.x=h.x,p.position.y=h.y,p.lineTo(y.x-h.x,y.y-h.y),a.addChild(p);var Z={graphic:p,x:p.position.x,y:p.position.y,lineToX:y.x-h.x,lineToY:y.y-h.y,tagIDs:[]},J=60;const Q=n.skill_name.split(" ");for(let s=0;s<Q.length;s++)Q[s].length>8&&(J=45);n.skill_name=n.skill_name.replace(/(.*?\s)/g,`$1
`);let u=new O(n.skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:J,fill:16777215,align:"center"});u.anchor.set(.5),u.scale.x=.2,u.scale.y=.2,h.addChild(S),h.addChild(u),a.addChild(h);let A={id:n.id,isMastered:n.is_mastered,isUnlocked:n.is_accessible,color:L,container:h,tagIDs:[],name:n.skill_name,description:n.description};S.eventMode="static",u.eventMode="static",S.cursor="pointer",u.cursor="pointer",S.on("pointerdown",s=>{this.isSkillInfoPanelShown?this.updateInfoPanel(A):this.showInfoPanel(A)}),u.on("pointerdown",s=>{this.isSkillInfoPanelShown?this.updateInfoPanel(A):this.showInfoPanel(A)});for(let s=0;s<this.skillTagsStore.skillTagsList.length;s++)A.id==this.skillTagsStore.skillTagsList[s].skill_id&&(A.tagIDs.push(this.skillTagsStore.skillTagsList[s].tag_id),Z.tagIDs.push(this.skillTagsStore.skillTagsList[s].tag_id));this.firstLevelSkillsArray.push(A),this.firstLevelSkillsConnectingLinesArray.push(Z);let X=[],ue={domain:n.skill_name,skillNodeLevels:X};Y(n.children,h,F*60,0,0,0,this),console.log(ue)}},()=>{console.log("Unable to load required font!")})},methods:{clearFilter(){for(let e=0;e<this.firstLevelSkillsArray.length;e++)this.firstLevelSkillsArray[e].container.children[0].alpha=1,this.firstLevelSkillsArray[e].container.children[0].eventMode="static",this.firstLevelSkillsArray[e].container.children[1].alpha=1,this.firstLevelSkillsArray[e].container.children[1].eventMode="static",this.firstLevelSkillsConnectingLinesArray[e].graphic.alpha=1;for(let e=0;e<this.secondLevelSkillsArray.length;e++)this.secondLevelSkillsArray[e].container.children[0].alpha=1,this.secondLevelSkillsArray[e].container.children[0].eventMode="static",this.secondLevelSkillsArray[e].container.children[1].alpha=1,this.secondLevelSkillsArray[e].container.children[1].eventMode="static",this.secondLevelSkillsConnectingLinesArray[e].alpha=1;for(let e=0;e<this.thirdLevelSkillsArray.length;e++)this.thirdLevelSkillsArray[e].container.children[0].alpha=1,this.thirdLevelSkillsArray[e].container.children[0].eventMode="static",this.thirdLevelSkillsArray[e].container.children[1].alpha=1,this.thirdLevelSkillsArray[e].container.children[1].eventMode="static",this.thirdLevelSkillsConnectingLinesArray[e].alpha=1;for(let e=0;e<this.fourthLevelSkillsArray.length;e++)this.fourthLevelSkillsArray[e].container.children[0].alpha=1,this.fourthLevelSkillsArray[e].container.children[0].eventMode="static",this.fourthLevelSkillsArray[e].container.children[1].alpha=1,this.fourthLevelSkillsArray[e].container.children[1].eventMode="static",this.fourthLevelSkillsConnectingLinesArray[e].alpha=1},totalFilter(){for(let e=0;e<this.firstLevelSkillsArray.length;e++)this.firstLevelSkillsArray[e].container.children[0].alpha=0,this.firstLevelSkillsArray[e].container.children[0].eventMode="none",this.firstLevelSkillsArray[e].container.children[1].alpha=0,this.firstLevelSkillsArray[e].container.children[1].eventMode="none",this.firstLevelSkillsConnectingLinesArray[e].graphic.alpha=0;for(let e=0;e<this.secondLevelSkillsArray.length;e++)this.secondLevelSkillsArray[e].container.children[0].alpha=0,this.secondLevelSkillsArray[e].container.children[0].eventMode="none",this.secondLevelSkillsArray[e].container.children[1].alpha=0,this.secondLevelSkillsArray[e].container.children[1].eventMode="none",this.secondLevelSkillsConnectingLinesArray[e].alpha=0;for(let e=0;e<this.thirdLevelSkillsArray.length;e++)this.thirdLevelSkillsArray[e].container.children[0].alpha=0,this.thirdLevelSkillsArray[e].container.children[0].eventMode="none",this.thirdLevelSkillsArray[e].container.children[1].alpha=0,this.thirdLevelSkillsArray[e].container.children[1].eventMode="none",this.thirdLevelSkillsConnectingLinesArray[e].alpha=0;for(let e=0;e<this.fourthLevelSkillsArray.length;e++)this.fourthLevelSkillsArray[e].container.children[0].alpha=0,this.fourthLevelSkillsArray[e].container.children[0].eventMode="none",this.fourthLevelSkillsArray[e].container.children[1].alpha=0,this.fourthLevelSkillsArray[e].container.children[1].eventMode="none",this.fourthLevelSkillsConnectingLinesArray[e].alpha=0},applyFilter(e){if(this.totalFilter(),e.length==0)this.clearFilter();else{for(let l=0;l<e.length;l++)if(e[l]==0){for(let i=0;i<this.firstLevelSkillsArray.length;i++)(this.firstLevelSkillsArray[i].isMastered=="1"||this.firstLevelSkillsArray[i].isUnlocked=="1")&&(this.firstLevelSkillsArray[i].container.children[0].alpha=1,this.firstLevelSkillsArray[i].container.children[0].eventMode="static",this.firstLevelSkillsArray[i].container.children[1].alpha=1,this.firstLevelSkillsArray[i].container.children[1].eventMode="static",this.firstLevelSkillsConnectingLinesArray[i].graphic.alpha=1);for(let i=0;i<this.secondLevelSkillsArray.length;i++)(this.secondLevelSkillsArray[i].isMastered=="1"||this.secondLevelSkillsArray[i].isUnlocked=="1")&&(this.secondLevelSkillsArray[i].container.children[0].alpha=1,this.secondLevelSkillsArray[i].container.children[0].eventMode="static",this.secondLevelSkillsArray[i].container.children[1].alpha=1,this.secondLevelSkillsArray[i].container.children[1].eventMode="static",this.secondLevelSkillsConnectingLinesArray[i].alpha=1);for(let i=0;i<this.thirdLevelSkillsArray.length;i++)(this.thirdLevelSkillsArray[i].isMastered=="1"||this.thirdLevelSkillsArray[i].isUnlocked=="1")&&(this.thirdLevelSkillsArray[i].container.children[0].alpha=1,this.thirdLevelSkillsArray[i].container.children[0].eventMode="static",this.thirdLevelSkillsArray[i].container.children[1].alpha=1,this.thirdLevelSkillsArray[i].container.children[1].eventMode="static",this.thirdLevelSkillsConnectingLinesArray[i].alpha=1);for(let i=0;i<this.fourthLevelSkillsArray.length;i++)(this.fourthLevelSkillsArray[i].isMastered=="1"||this.fourthLevelSkillsArray[i].isUnlocked=="1")&&(this.fourthLevelSkillsArray[i].container.children[0].alpha=1,this.fourthLevelSkillsArray[i].container.children[0].eventMode="static",this.fourthLevelSkillsArray[i].container.children[1].alpha=1,this.fourthLevelSkillsArray[i].container.children[1].eventMode="static",this.fourthLevelSkillsConnectingLinesArray[i].alpha=1)}for(let l=0;l<this.firstLevelSkillsArray.length;l++)if(this.firstLevelSkillsArray[l].tagIDs.length>0)for(let i=0;i<this.firstLevelSkillsArray[l].tagIDs.length;i++)for(let t=0;t<e.length;t++)this.firstLevelSkillsArray[l].tagIDs[i]==e[t]&&(this.firstLevelSkillsArray[l].container.children[0].alpha=1,this.firstLevelSkillsArray[l].container.children[0].eventMode="static",this.firstLevelSkillsArray[l].container.children[1].alpha=1,this.firstLevelSkillsArray[l].container.children[1].eventMode="static",this.firstLevelSkillsConnectingLinesArray[l].graphic.alpha=1);for(let l=0;l<this.secondLevelSkillsArray.length;l++){if(this.secondLevelSkillsArray[l].tagIDs.length>0)for(let i=0;i<this.secondLevelSkillsArray[l].tagIDs.length;i++)for(let t=0;t<e.length;t++)this.secondLevelSkillsArray[l].tagIDs[i]==e[t]&&(this.secondLevelSkillsArray[l].container.children[0].alpha=1,this.secondLevelSkillsArray[l].container.children[0].eventMode="static",this.secondLevelSkillsArray[l].container.children[1].alpha=1,this.secondLevelSkillsArray[l].container.children[1].eventMode="static");if(this.secondLevelSkillsArray[l].parentTagIDs.length>0)for(let i=0;i<this.secondLevelSkillsArray[l].parentTagIDs.length;i++)for(let t=0;t<e.length;t++)this.secondLevelSkillsArray[l].parentTagIDs[i]==e[t]&&this.secondLevelSkillsArray[l].container.children[0].alpha==1&&(this.secondLevelSkillsConnectingLinesArray[l].alpha=1)}for(let l=0;l<this.thirdLevelSkillsArray.length;l++){if(this.thirdLevelSkillsArray[l].tagIDs.length>0)for(let i=0;i<this.thirdLevelSkillsArray[l].tagIDs.length;i++)for(let t=0;t<e.length;t++)this.thirdLevelSkillsArray[l].tagIDs[i]==e[t]&&(this.thirdLevelSkillsArray[l].container.children[0].alpha=1,this.thirdLevelSkillsArray[l].container.children[0].eventMode="static",this.thirdLevelSkillsArray[l].container.children[1].alpha=1,this.thirdLevelSkillsArray[l].container.children[1].eventMode="static");if(this.thirdLevelSkillsArray[l].parentTagIDs.length>0)for(let i=0;i<this.thirdLevelSkillsArray[l].parentTagIDs.length;i++)for(let t=0;t<e.length;t++)this.thirdLevelSkillsArray[l].parentTagIDs[i]==e[t]&&this.thirdLevelSkillsArray[l].container.children[0].alpha==1&&(this.thirdLevelSkillsConnectingLinesArray[l].alpha=1)}for(let l=0;l<this.fourthLevelSkillsArray.length;l++){if(this.fourthLevelSkillsArray[l].tagIDs.length>0)for(let i=0;i<this.fourthLevelSkillsArray[l].tagIDs.length;i++)for(let t=0;t<e.length;t++)this.fourthLevelSkillsArray[l].tagIDs[i]==e[t]&&(this.fourthLevelSkillsArray[l].container.children[0].alpha=1,this.fourthLevelSkillsArray[l].container.children[0].eventMode="static",this.fourthLevelSkillsArray[l].container.children[1].alpha=1,this.fourthLevelSkillsArray[l].container.children[1].eventMode="static");if(this.fourthLevelSkillsArray[l].parentTagIDs.length>0)for(let i=0;i<this.fourthLevelSkillsArray[l].parentTagIDs.length;i++)for(let t=0;t<e.length;t++)this.fourthLevelSkillsArray[l].parentTagIDs[i]==e[t]&&this.fourthLevelSkillsArray[l].container.children[0].alpha==1&&(this.fourthLevelSkillsConnectingLinesArray[l].alpha=1)}}},showInfoPanel(e){if(!this.isSkillInfoPanelShown){screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",document.getElementById("sidepanel-backdrop").style.display="block",this.isSkillInfoPanelShown=!0;var l=document.getElementById("skillHeading"),i=document.createTextNode(e.name);l.appendChild(i);var t=document.getElementById("skillDescription"),c=document.createTextNode(e.description);t.appendChild(c),e.isMastered=="1"&&(document.getElementById("skillIsMastered").checked=!0);var v=document.getElementById("skillLink");v.setAttribute("href","/skills/"+e.id)}},updateInfoPanel(e){if(this.isSkillInfoPanelShown){var l=document.getElementById("skillHeading");l.innerHTML="";var i=document.createTextNode(e.name);l.appendChild(i);var t=document.getElementById("skillDescription");t.innerHTML="";var c=document.createTextNode(e.description);t.appendChild(c),e.isMastered=="1"?document.getElementById("skillIsMastered").checked=!0:document.getElementById("skillIsMastered").checked=!1;var v=document.getElementById("skillLink");v.setAttribute("href","/skills/"+e.id)}}}},Ze=e=>(ke("data-v-fa4a2f3e"),e=e(),fe(),e),Je={class:"flex-container skill-tree-container"},Qe={id:"wrapper"},Xe={id:"skilltree"},Ye=Ze(()=>d("div",{id:"sidepanel-backdrop"},null,-1));function el(e,l,i,t,c,v){const a=ae("SkillTreeFilter"),k=ae("SkillPanel");return b(),B("div",Je,[q(a,{id:"filter"}),d("div",Qe,[d("div",Xe,[q(k)]),Ye])])}const ll=de(Ke,[["render",el],["__scopeId","data-v-fa4a2f3e"]]);const il=d("div",{id:"purple-banner"},null,-1),tl=d("span",null,"Loading...",-1),ol={__name:"SkillTreeView",setup(e){return(l,i)=>(b(),B(ce,null,[il,(b(),Te(De,null,{default:oe(()=>[q(ll)]),fallback:oe(()=>[tl]),_:1}))],64))}};export{ol as default};
