import{d as Z,_ as V,o as b,c as A,a as _,w as $,v as E,F as W,r as Q,t as G,p as X,b as Y,u as ee,e as L,f as F,g as se,h as U,S as te}from"./main-9e027c7c.js";import{u as le}from"./SkillTreeStore-46959074.js";import{S as ie,A as ne,h as re,P as ae,a as h,G as oe,T as R,C as H}from"./fontfaceobserver.standalone-013ed06c.js";const ce=Z("skillTags",{state:()=>({skillTagsList:[]}),actions:{async getSkillTagsList(){const s=await(await fetch("/skill-tags/list")).json();this.skillTagsList=s}}});const de={setup(){},data(){return{levels:[{id:"grade_school",name:"Grade school"},{id:"middle_school",name:"Middle school"},{id:"high_school",name:"High school"},{id:"college",name:"College"},{id:"phd",name:"PhD"}],checkedFilters:[]}},async created(){},async mounted(){},methods:{applyFilter:function(){}}},j=e=>(X("data-v-ab8954c3"),e=e(),Y(),e),he={id:"filters"},ue=j(()=>_("h1",{id:"filterMainHeader",class:"mb-2"},"My Skill Tree",-1)),fe={class:"form-check"},me=j(()=>_("label",{class:"form-check-label",for:"flexCheckDefault"}," Mastered and available skills ",-1)),ge={class:"form-check"},pe=["value"],ke={class:"form-check-label",for:"flexCheckDefault"};function _e(e,s,t,r,o,d){return b(),A("div",he,[ue,_("div",fe,[$(_("input",{class:"form-check-input",type:"checkbox",value:0,id:"flexCheckDefault","onUpdate:modelValue":s[0]||(s[0]=a=>o.checkedFilters=a),onChange:s[1]||(s[1]=a=>d.applyFilter())},null,544),[[E,o.checkedFilters]]),me]),(b(!0),A(W,null,Q(o.levels,a=>(b(),A("div",null,[_("div",ge,[$(_("input",{class:"form-check-input",type:"checkbox",value:a.id,id:"flexCheckDefault","onUpdate:modelValue":s[2]||(s[2]=c=>o.checkedFilters=c),onChange:s[3]||(s[3]=c=>d.applyFilter())},null,40,pe),[[E,o.checkedFilters]]),_("label",ke,G(a.name),1)])]))),256))])}const ye=V(de,[["render",_e],["__scopeId","data-v-ab8954c3"]]);function Se(e){var s=0,t=e.children,r=t&&t.length;if(!r)s=1;else for(;--r>=0;)s+=t[r].value;e.value=s}function we(){return this.eachAfter(Se)}function xe(e,s){let t=-1;for(const r of this)e.call(s,r,++t,this);return this}function ve(e,s){for(var t=this,r=[t],o,d,a=-1;t=r.pop();)if(e.call(s,t,++a,this),o=t.children)for(d=o.length-1;d>=0;--d)r.push(o[d]);return this}function be(e,s){for(var t=this,r=[t],o=[],d,a,c,S=-1;t=r.pop();)if(o.push(t),d=t.children)for(a=0,c=d.length;a<c;++a)r.push(d[a]);for(;t=o.pop();)e.call(s,t,++S,this);return this}function Ie(e,s){let t=-1;for(const r of this)if(e.call(s,r,++t,this))return r}function Te(e){return this.eachAfter(function(s){for(var t=+e(s.data)||0,r=s.children,o=r&&r.length;--o>=0;)t+=r[o].value;s.value=t})}function Ce(e){return this.eachBefore(function(s){s.children&&s.children.sort(e)})}function Ae(e){for(var s=this,t=Me(s,e),r=[s];s!==t;)s=s.parent,r.push(s);for(var o=r.length;e!==t;)r.splice(o,0,e),e=e.parent;return r}function Me(e,s){if(e===s)return e;var t=e.ancestors(),r=s.ancestors(),o=null;for(e=t.pop(),s=r.pop();e===s;)o=e,e=t.pop(),s=r.pop();return o}function Pe(){for(var e=this,s=[e];e=e.parent;)s.push(e);return s}function Be(){return Array.from(this)}function ze(){var e=[];return this.eachBefore(function(s){s.children||e.push(s)}),e}function Fe(){var e=this,s=[];return e.each(function(t){t!==e&&s.push({source:t.parent,target:t})}),s}function*Ne(){var e=this,s,t=[e],r,o,d;do for(s=t.reverse(),t=[];e=s.pop();)if(yield e,r=e.children)for(o=0,d=r.length;o<d;++o)t.push(r[o]);while(t.length)}function N(e,s){e instanceof Map?(e=[void 0,e],s===void 0&&(s=Ee)):s===void 0&&(s=$e);for(var t=new M(e),r,o=[t],d,a,c,S;r=o.pop();)if((a=s(r.data))&&(S=(a=Array.from(a)).length))for(r.children=a,c=S-1;c>=0;--c)o.push(d=a[c]=new M(a[c])),d.parent=r,d.depth=r.depth+1;return t.eachBefore(Ue)}function De(){return N(this).eachBefore(Le)}function $e(e){return e.children}function Ee(e){return Array.isArray(e)?e[1]:null}function Le(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Ue(e){var s=0;do e.height=s;while((e=e.parent)&&e.height<++s)}function M(e){this.data=e,this.depth=this.height=0,this.parent=null}M.prototype=N.prototype={constructor:M,count:we,each:xe,eachAfter:be,eachBefore:ve,find:Ie,sum:Te,sort:Ce,path:Ae,ancestors:Pe,descendants:Be,leaves:ze,links:Fe,copy:De,[Symbol.iterator]:Ne};function Re(e,s){return e.parent===s.parent?1:2}function B(e){var s=e.children;return s?s[0]:e.t}function z(e){var s=e.children;return s?s[s.length-1]:e.t}function He(e,s,t){var r=t/(s.i-e.i);s.c-=r,s.s+=t,e.c+=r,s.z+=t,s.m+=t}function Ve(e){for(var s=0,t=0,r=e.children,o=r.length,d;--o>=0;)d=r[o],d.z+=s,d.m+=s,s+=d.s+(t+=d.c)}function We(e,s,t){return e.a.parent===s.parent?e.a:t}function P(e,s){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=s}P.prototype=Object.create(M.prototype);function Xe(e){for(var s=new P(e,0),t,r=[s],o,d,a,c;t=r.pop();)if(d=t._.children)for(t.children=new Array(c=d.length),a=c-1;a>=0;--a)r.push(o=t.children[a]=new P(d[a],a)),o.parent=t;return(s.parent=new P(null,0)).children=[s],s}function Ye(){var e=Re,s=1,t=1,r=null;function o(n){var m=Xe(n);if(m.eachAfter(d),m.parent.m=-m.z,m.eachBefore(a),r)n.eachBefore(S);else{var u=n,i=n,k=n;n.eachBefore(function(f){f.x<u.x&&(u=f),f.x>i.x&&(i=f),f.depth>k.depth&&(k=f)});var l=u===i?1:e(u,i)/2,g=l-u.x,w=s/(i.x+l+g),x=t/(k.depth||1);n.eachBefore(function(f){f.x=(f.x+g)*w,f.y=f.depth*x})}return n}function d(n){var m=n.children,u=n.parent.children,i=n.i?u[n.i-1]:null;if(m){Ve(n);var k=(m[0].z+m[m.length-1].z)/2;i?(n.z=i.z+e(n._,i._),n.m=n.z-k):n.z=k}else i&&(n.z=i.z+e(n._,i._));n.parent.A=c(n,i,n.parent.A||u[0])}function a(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function c(n,m,u){if(m){for(var i=n,k=n,l=m,g=i.parent.children[0],w=i.m,x=k.m,f=l.m,I=g.m,v;l=z(l),i=B(i),l&&i;)g=B(g),k=z(k),k.a=n,v=l.z+f-i.z-w+e(l._,i._),v>0&&(He(We(l,n,u),n,v),w+=v,x+=v),f+=l.m,w+=i.m,I+=g.m,x+=k.m;l&&!z(k)&&(k.t=l,k.m+=f-x),i&&!B(g)&&(g.t=i,g.m+=w-I,u=n)}return u}function S(n){n.x*=s,n.y=n.depth*t}return o.separation=function(n){return arguments.length?(e=n,o):e},o.size=function(n){return arguments.length?(r=!1,s=+n[0],t=+n[1],o):r?null:[s,t]},o.nodeSize=function(n){return arguments.length?(r=!0,s=+n[0],t=+n[1],o):r?[s,t]:null},o}function C(e,s,t){this.k=e,this.x=s,this.y=t}C.prototype={constructor:C,scale:function(e){return e===1?this:new C(this.k*e,this.x,this.y)},translate:function(e,s){return e===0&s===0?this:new C(this.k,this.x+this.k*e,this.y+this.k*s)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};C.prototype;const je={setup(){const e=ee(),s=le(),t=ce();return{userDetailsStore:e,skillTreeStore:s,skillTagsStore:t}},data(){return{stageContents:[],isSkillInfoPanelShown:!1,regularLockedUnmasteredNodeSprite:null,radius:0,width:null,height:null,radiusMultiplier:4,skill:{id:null,children:[],isMastered:null,isUnlocked:null,container:null,name:null,description:null,tagIDs:[],sprite:null},isRecentered:!1}},components:{SkillTreeFilter:ye,SkillPanel:ie},async mounted(){this.skillTreeStore.userSkills.length==0&&await this.skillTreeStore.getUserSkills(),this.width=window.innerWidth,this.height=window.innerHeight;var e=this.width,s=this.height;this.radius=Math.min(e,s)/2;var t=new ne({width:e,height:s,resolution:2,transparent:!0,antialias:!0,autoDensity:!0,autoStart:!0});document.querySelector("#skilltree").appendChild(t.view);const r=new re({screenWidth:e,screenHeight:s,worldWidth:e,worldHeight:s,events:t.renderer.events});t.stage.addChild(r),r.center=new ae(0,0),r.drag().pinch().wheel().decelerate().clampZoom({minScale:.2,maxScale:5});const o=h.from("center-node.png");this.skill={name:"SKILLS",sprite:o,children:this.skillTreeStore.userSkills},this.getAlgorithm(t),document.getElementById("reset-button").addEventListener("click",()=>{this.resetTree(t)})},methods:{getAlgorithm(e){var s=[];s=JSON.parse(JSON.stringify(this.skill.children));function t(a){for(var c=a.length;c--;)a[c].type=="sub"&&a.splice(c,1),typeof a[c]<"u"&&a[c].children&&Array.isArray(a[c].children)&&a[c].children.length>0&&t(a[c].children)}t(s);var r={name:null,children:s};const d=Ye().size([2*Math.PI,this.radius*this.radiusMultiplier]).separation((a,c)=>(a.parent==c.parent?1:2)/a.depth)(N(r));this.drawChart(d,e)},drawChart(e,s){for(let n=0;n<e.links().length;n++){const m=new oe;m.lineStyle(2,16777215,1);var t=Math.cos(e.links()[n].source.x)*e.links()[n].source.y,r=Math.sin(e.links()[n].source.x)*e.links()[n].source.y;m.moveTo(t,r);var o=Math.cos(e.links()[n].target.x)*e.links()[n].target.y,d=Math.sin(e.links()[n].target.x)*e.links()[n].target.y;m.lineTo(o,d),s.stage.children[0].addChild(m),this.stageContents.push(m)}const a=this.skill.sprite;a.x=e.x,a.y=e.y,a.anchor.set(.5),this.isRecentered==!1?a.scale.set(.1):a.scale.set(.25),s.stage.children[0].addChild(a),this.stageContents.push(a);let c=new R(this.skill.name,{fontFamily:"Poppins900",fontSize:40,fill:0,align:"center"});c.anchor.set(.5),c.x=e.x,c.y=e.y,c.scale.x=.1,c.scale.y=.1,s.stage.children[0].addChild(c),this.stageContents.push(c);function S(n,m,u){m++;for(let[k,l]of n.entries()){for(let p=0;p<e.descendants().length;p++)e.descendants()[p].data.id==l.id&&(l.x=e.descendants()[p].x,l.y=e.descendants()[p].y);let g=new H;g.x=Math.cos(l.x)*l.y,g.y=Math.sin(l.x)*l.y;var i=new h;l.level=="grade_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/grade-school-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/grade-school-unlocked.png"):i=h.from("images/skill-tree-nodes/grade-school-locked.png"):l.level=="middle_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/middle-school-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="high_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/high-school-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="college"?l.is_mastered?i=h.from("images/skill-tree-nodes/college-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="phd"?l.is_mastered?i=h.from("images/skill-tree-nodes/phd-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-locked.png"):l.level=="domain"&&(i=h.from("images/skill-tree-nodes/domain.png")),i.width=30,i.height=30,i.anchor.set(.5),g.addChild(i);let w=40;const x=l.skill_name.split(" ");for(let p=0;p<x.length;p++)x[p].length>9&&(w=37);l.skill_name=l.skill_name.replace(/(.*?\s)/g,`$1
`);let f=new R(l.skill_name.toUpperCase(),{fontFamily:"Poppins900",fontSize:w,fill:16777215,align:"center"});f.anchor.set(.5),f.scale.x=.1,f.scale.y=.1,g.addChild(f),i.eventMode="static",f.eventMode="static",i.cursor="pointer",f.cursor="pointer",f.on("pointerdown",p=>{var y={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:g,name:l.skill_name,description:l.description,tagIDs:[],sprite:i};if(u.skill=y,!u.isSkillInfoPanelShown){let T=function(){u.recenterTree(s)};u.skill=y,u.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",T)}}),i.on("pointerdown",p=>{var y={id:l.id,children:l.children,isMastered:l.is_mastered,isUnlocked:l.is_accessible,container:g,name:l.skill_name,description:l.description,tagIDs:[],sprite:i};if(u.skill=y,!u.isSkillInfoPanelShown){let T=function(){u.recenterTree(s)};u.skill=y,u.showInfoPanel(),document.getElementById("recenterTree").addEventListener("click",T)}}),s.stage.children[0].addChild(g),u.stageContents.push(g);let I=0,v=0;for(let p=0;p<l.children.length;p++)l.children[p].type!="sub"?I++:v++;for(let p=0;p<l.children.length;p++)if(l.children[p].type=="sub"){let y=new H,T=360/v,J=p-I,D=T*J*Math.PI/180,K=25*Math.cos(D),q=25*Math.sin(D);y.x=K,y.y=q;var i=new h;l.level=="grade_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/grade-school-small-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/grade-school-small-unlocked.png"):i=h.from("images/skill-tree-nodes/grade-school-small-locked.png"):l.level=="middle_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/middle-school-small-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/middle-school-small-unlocked.png"):i=h.from("images/skill-tree-nodes/middle-school-small-locked.png"):l.level=="high_school"?l.is_mastered?i=h.from("images/skill-tree-nodes/high-school-small-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/high-school-small-unlocked.png"):i=h.from("images/skill-tree-nodes/high-school-small-locked.png"):l.level=="college"?l.is_mastered?i=h.from("images/skill-tree-nodes/college-smal-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/college-small-unlocked.png"):i=h.from("images/skill-tree-nodes/college-small-locked.png"):l.level=="phd"&&(l.is_mastered?i=h.from("images/skill-tree-nodes/phd-small-mastered.png"):l.is_accessible?i=h.from("images/skill-tree-nodes/phd-small-unlocked.png"):i=h.from("images/skill-tree-nodes/phd-small-locked.png")),i.width=10,i.height=10,i.anchor.set(.5),y.addChild(i),g.addChild(y)}l.children&&Array.isArray(l.children)&&l.children.length>0&&S(l.children,m,u)}}S(this.skill.children,0,this)},recenterTree(e){this.isRecentered=!0,this.radiusMultiplier=1;for(let s=0;s<this.stageContents.length;s++)this.stageContents[s].destroy();this.hideInfoPanel(),this.getAlgorithm(e)},resetTree(e){this.isRecentered=!1,this.radiusMultiplier=2,e.stage.children[0].removeChildren();const s=h.from("center-node.png");this.skill={name:"SKILLS",sprite:s,children:this.skillTreeStore.userSkills},this.getAlgorithm(e)},showInfoPanel(){this.isSkillInfoPanelShown||(screen.width>800?document.getElementById("skillInfoPanel").style.width="474px":document.getElementById("skillInfoPanel").style.height="474px",document.getElementById("sidepanel-backdrop").style.display="block",this.isSkillInfoPanelShown=!0,document.getElementById("skillDescription"),document.getElementById("skillLink"))},hideInfoPanel(){this.isSkillInfoPanelShown&&(screen.width>800?document.getElementById("skillInfoPanel").style.width="0px":document.getElementById("skillInfoPanel").style.height="0px",document.getElementById("sidepanel-backdrop").style.display="none",this.isSkillInfoPanelShown=!1)}}},O=e=>(X("data-v-b08053a0"),e=e(),Y(),e),Oe={class:"flex-container skill-tree-container"},Je=O(()=>_("button",{id:"reset-button",class:"btn btn-info"},"Reset",-1)),Ke={id:"wrapper"},qe={id:"skilltree"},Ze=O(()=>_("div",{id:"sidepanel-backdrop"},null,-1));function Qe(e,s,t,r,o,d){const a=L("SkillTreeFilter"),c=L("SkillPanel");return b(),A("div",Oe,[F(a,{id:"filter"}),Je,_("div",Ke,[_("div",qe,[F(c,{skill:o.skill},null,8,["skill"])]),Ze])])}const Ge=V(je,[["render",Qe],["__scopeId","data-v-b08053a0"]]);const es=_("div",{id:"purple-banner"},null,-1),ss=_("span",null,"Loading...",-1),rs={__name:"SkillTreeView",setup(e){return(s,t)=>(b(),A(W,null,[es,(b(),se(te,null,{default:U(()=>[F(Ge)]),fallback:U(()=>[ss]),_:1}))],64))}};export{rs as default};
